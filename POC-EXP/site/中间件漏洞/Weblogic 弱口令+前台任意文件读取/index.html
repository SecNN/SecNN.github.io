<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%BC%8F%E6%B4%9E/Weblogic%20%E5%BC%B1%E5%8F%A3%E4%BB%A4%2B%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/">
    <link rel="shortcut icon" href="../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Weblogic 弱口令+前台任意文件读取 - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Weblogic \u5f31\u53e3\u4ee4+\u524d\u53f0\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6", url: "#_top", children: [
              {title: "\u73af\u5883\u642d\u5efa", url: "#_1" },
              {title: "\u5f31\u53e3\u4ee4", url: "#_2" },
              {title: "\u540e\u53f0\u4e0a\u4f20webshell", url: "#webshell" },
              {title: "\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6", url: "#_3" },
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script>
      <script src="../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Weblogic%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2023-21839/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Weblogic%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2023-21839/" class="btn btn-xs btn-link">
        Weblogic 未授权远程代码执行漏洞 CVE-2023-21839
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../Weblogic%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%20CVE-2018-2894/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../Weblogic%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%20CVE-2018-2894/" class="btn btn-xs btn-link">
        Weblogic 任意文件上传漏洞 CVE-2018-2894
      </a>
    </div>
    
  </div>

    

    <h1 id="weblogic">Weblogic 弱口令+前台任意文件读取<a class="headerlink" href="#weblogic" title="Permanent link">&para;</a></h1>
<h2 id="_1">环境搭建<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>本环境模拟了一个真实的weblogic环境，其后台存在一个弱口令，并且前台存在任意文件读取漏洞。分别通过这两种漏洞，模拟对weblogic场景的渗透。</p>
<p>Weblogic版本：10.3.6(11g)</p>
<p>Java版本：1.6</p>
<p>启动本环境：</p>
<div class="highlight"><pre><span></span><code>docker-compose up -d
</code></pre></div>
<h2 id="_2">弱口令<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>环境启动后，访问<code>http://your-ip:7001/console</code>，即为weblogic后台。</p>
<p>本环境存在弱口令：</p>
<ul>
<li>weblogic</li>
<li>Oracle@123</li>
</ul>
<p>weblogic常用弱口令： <a href="http://cirt.net/passwords?criteria=weblogic">http://cirt.net/passwords?criteria=weblogic</a></p>
<h2 id="webshell">后台上传webshell<a class="headerlink" href="#webshell" title="Permanent link">&para;</a></h2>
<p>获取到管理员密码后，登录后台。点击左侧的部署，可见一个应用列表：</p>
<p><img alt="" src="images/Weblogic%20弱口令+前台任意文件读取/image-20240327153205946.png" /></p>
<p>点击安装，选择“上载文件”：</p>
<p><img alt="" src="images/Weblogic%20弱口令+前台任意文件读取/image-20240327153229033.png" /></p>
<p>Welogic 的应用目录在 war 包中 <code>WEB-INF/weblogic.xm</code>l 里指定（若 <code>/hello</code> 已经被使用，要在当前环境下部署 shell，需要修改这个目录，比如修改成`/test）：</p>
<div class="highlight"><pre><span></span><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;weblogic-web-app xmlns=&quot;http://www.bea.com/ns/weblogic/weblogic-web-app&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://www.bea.com/ns/weblogic/weblogic-web-app http://www.bea.com/ns/weblogic/weblogic-web-app/1.0/weblogic-web-app.xsd&quot;&gt;
&lt;context-root&gt;/test&lt;/context-root&gt;
&lt;/weblogic-web-app&gt;
</code></pre></div>
<p>我们还是以 <code>/hello</code> 为例，制作 war 包，将以下文件打包为 <code>hello.zip</code>，再重命名为 <code>hello.war</code>。</p>
<p>war 包结构如下：</p>
<div class="highlight"><pre><span></span><code>D:.
│   file.jsp
│   index.jsp
│   ueditor.jsp //your webshell
│
├───META-INF
│       MANIFEST.MF
│
└───WEB-INF
    │   web.xml
    │   weblogic.xml
    │
    └───classes
</code></pre></div>
<p>上传war包，成功后点下一步，填写应用名称：</p>
<p><img alt="" src="images/Weblogic%20弱口令+前台任意文件读取/image-20240327153324801.png" /></p>
<p>继续一直下一步，部署完成后，即可获取webshell：</p>
<div class="highlight"><pre><span></span><code>http://&lt;YOUR_IP&gt;/hello/ueditor.jsp
</code></pre></div>
<p><img alt="" src="images/Weblogic%20弱口令+前台任意文件读取/image-20240327153637353.png" /></p>
<h2 id="_3">任意文件读取<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<p>在刚才部署的 <code>/hello</code> 中，模拟了一个任意文件下载漏洞，访问 <code>http://your-ip:7001/hello/file.jsp?path=/etc/passwd</code> 可以成功读取passwd文件。那么，该漏洞如何利用？</p>
<h3 id="_4">读取后台用户密文与密钥文件<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p>weblogic 密码使用 AES（老版本 3DES）加密，对称加密可解密，只需要找到用户的密文与加密时的密钥即可。这两个文件均位于 base_domain 下，名为<code>SerializedSystemIni.dat</code>和<code>config.xml</code>，在本环境中为<code>./security/SerializedSystemIni.dat</code>和<code>./config/config.xml</code>（基于当前目录<code>/root/Oracle/Middleware/user_projects/domains/base_domain</code>）。</p>
<p><code>SerializedSystemIni.dat</code>是一个二进制文件，所以一定要用 burpsuite 来读取，用浏览器直接下载可能引入一些干扰字符。在burp里选中读取到的那一串乱码，右键 copy to file 就可以保存成一个文件：</p>
<div class="highlight"><pre><span></span><code>GET /hello/file.jsp?path=security/SerializedSystemIni.dat HTTP/1.1
</code></pre></div>
<p><img alt="" src="images/Weblogic%20弱口令+前台任意文件读取/image-20240327154105568.png" /></p>
<p><code>config.xml</code>是base_domain的全局配置文件，所以乱七八糟的内容比较多，找到其中的<code>&lt;node-manager-password-encrypted&gt;</code>的值，即为加密后的管理员密码，不要找错了：</p>
<div class="highlight"><pre><span></span><code>GET /hello/file.jsp?path=./config/config.xml HTTP/1.1
</code></pre></div>
<div class="highlight"><pre><span></span><code>&lt;node-manager-password-encrypted&gt;{AES}yvGnizbUS0lga6iPA5LkrQdImFiS/DJ8Lw/yeE7Dt0k=&lt;/node-manager-password-encrypted&gt;
</code></pre></div>
<p><img alt="" src="images/Weblogic%20弱口令+前台任意文件读取/image-20240327154329532.png" /></p>
<h3 id="_5">解密密文<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<p>然后使用本环境的decrypt目录下的weblogic_decrypt.jar，解密密文（或者参考这篇文章：<a href="http://cb.drops.wiki/drops/tips-349.html">http://cb.drops.wiki/drops/tips-349.html</a> ，自己编译一个解密的工具）：</p>
<p><img alt="" src="images/Weblogic%20弱口令+前台任意文件读取/image-20240327154826127.png" /></p>
<p>可见，解密后和预设的密码一致，说明成功。</p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Weblogic%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2023-21839/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Weblogic%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2023-21839/" class="btn btn-xs btn-link">
        Weblogic 未授权远程代码执行漏洞 CVE-2023-21839
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../Weblogic%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%20CVE-2018-2894/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../Weblogic%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%20CVE-2018-2894/" class="btn btn-xs btn-link">
        Weblogic 任意文件上传漏洞 CVE-2018-2894
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>