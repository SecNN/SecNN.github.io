<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/opensmtpd/CVE-2020-7247/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>OpenSMTPD Remote Code Execution Vulnerability (CVE-2020-7247) - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "OpenSMTPD Remote Code Execution Vulnerability (CVE-2020-7247)", url: "#_top", children: [
              {title: "Start Vulnerability Application", url: "#start-vulnerability-application" },
              {title: "Vulnerability Reproduce", url: "#vulnerability-reproduce" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        OpenSMTPD 远程命令执行漏洞 (CVE-2020-7247)
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../omfyUI/omfyUI-follow_symlinks%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../omfyUI/omfyUI-follow_symlinks%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        omfyUI follow symlinks文件读取漏洞
      </a>
    </div>
    
  </div>

    

    <h1 id="opensmtpd-remote-code-execution-vulnerability-cve-2020-7247">OpenSMTPD Remote Code Execution Vulnerability (CVE-2020-7247)<a class="headerlink" href="#opensmtpd-remote-code-execution-vulnerability-cve-2020-7247" title="Permanent link">&para;</a></h1>
<p><a href="README.zh-cn/">中文版本(Chinese version)</a></p>
<p>OpenSMTPD is an smtp service program for unix operating systems (BSD, MacOS, GNU/Linux), following the RFC 5321 SMTP protocol. OpenSMTPD was originally developed for the OpenBSD operating system and is part of the OpenBSD project. Due to its open source properties, Distributed to other unix platforms. According to the ISC license, the software is free for everyone to use and reuse.</p>
<p><code>CVE-2020-7247</code> is caused by OpenSMTPD's lax verification of the sender/recipient in the process of implementing RFC 5321.</p>
<p>On January 29, 2020, OpenSMTPD group officially submitted a fix for the <code>CVE-2020-7247</code> in the GitHub repository. After the repair, the corresponding version is <code>OpenSMTPD 6.6.2p1</code>.</p>
<p><strong>Reference：</strong></p>
<ul>
<li><a href="https://www.qualys.com/2020/01/28/cve-2020-7247/lpe-rce-opensmtpd.txt">https://www.qualys.com/2020/01/28/cve-2020-7247/lpe-rce-opensmtpd.txt</a></li>
<li><a href="https://www.exploit-db.com/exploits/47984">https://www.exploit-db.com/exploits/47984</a></li>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-7247">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-7247</a></li>
<li><a href="https://www.anquanke.com/post/id/197689">https://www.anquanke.com/post/id/197689</a></li>
</ul>
<h2 id="start-vulnerability-application">Start Vulnerability Application<a class="headerlink" href="#start-vulnerability-application" title="Permanent link">&para;</a></h2>
<p>Start a vulnerable OpenSMTPD through following command:</p>
<div class="highlight"><pre><span></span><code>docker compose up -d
</code></pre></div>
<p>After SMTPD server is started, connect to the 8825 port and get the result (<code>44dadcc5a6eb</code> is the container ID):</p>
<div class="highlight"><pre><span></span><code>$ nc &lt;your-ip&gt; 8825 -v
220 44dadcc5a6eb ESMTP OpenSMTPD
</code></pre></div>
<h2 id="vulnerability-reproduce">Vulnerability Reproduce<a class="headerlink" href="#vulnerability-reproduce" title="Permanent link">&para;</a></h2>
<p>Use <a href="https://www.exploit-db.com/exploits/47984">Exploit-DB</a> to gain a reverse shell:</p>
<div class="highlight"><pre><span></span><code>python3 poc.py your-ip 8825 &lt;command&gt; 
</code></pre></div>
<p><img alt="image" src="https://github.com/CatAndCoffee/vulhub/blob/CVE-2020-7247/OpenSMTPD/CVE-2020-7247/image-20210415233036042.png" /></p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        OpenSMTPD 远程命令执行漏洞 (CVE-2020-7247)
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../omfyUI/omfyUI-follow_symlinks%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../omfyUI/omfyUI-follow_symlinks%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        omfyUI follow symlinks文件读取漏洞
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>