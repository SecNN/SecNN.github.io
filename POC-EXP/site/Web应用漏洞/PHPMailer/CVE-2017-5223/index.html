<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/PHPMailer/CVE-2017-5223/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>PHPMailer Arbitrary File Read (CVE-2017-5223) - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "PHPMailer Arbitrary File Read (CVE-2017-5223)", url: "#_top", children: [
              {title: "Environment Setup", url: "#environment-setup" },
              {title: "Vulnerability Reproduction", url: "#vulnerability-reproduction" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        PHPMailer 任意文件读取漏洞（CVE-2017-5223）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../%EF%BC%88CVE-2017-5223%EF%BC%89PHPMailer%20_%3D%205.2.21%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../%EF%BC%88CVE-2017-5223%EF%BC%89PHPMailer%20_%3D%205.2.21%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        （CVE-2017-5223）PHPMailer \&lt;= 5.2.21 任意文件读取漏洞
      </a>
    </div>
    
  </div>

    

    <h1 id="phpmailer-arbitrary-file-read-cve-2017-5223">PHPMailer Arbitrary File Read (CVE-2017-5223)<a class="headerlink" href="#phpmailer-arbitrary-file-read-cve-2017-5223" title="Permanent link">&para;</a></h1>
<p><a href="README.zh-cn/">中文版本(Chinese version)</a></p>
<p>PHPMailer is a popular PHP library for sending emails.</p>
<p>Before the PHPMailer 5.2.18, during the email sending process, PHPMailer searches for image tags (<code>&lt;img src="..."&gt;</code>) in the email content and extracts their src attribute values as attachments. Therefore, if we can control part of the email content, we can use <code>&lt;img src="/etc/passwd"&gt;</code> to read the file <code>/etc/passwd</code> as an attachment, resulting in an arbitrary file read vulnerability.</p>
<p>References:</p>
<ul>
<li><a href="http://www.freebuf.com/vuls/124820.html">http://www.freebuf.com/vuls/124820.html</a></li>
<li><a href="https://www.exploit-db.com/exploits/43056/">https://www.exploit-db.com/exploits/43056/</a></li>
</ul>
<h2 id="environment-setup">Environment Setup<a class="headerlink" href="#environment-setup" title="Permanent link">&para;</a></h2>
<p>First, create a <code>.env</code> file in the current directory with the following content (modify the configuration values to your SMTP server, account, and password):</p>
<div class="highlight"><pre><span></span><code>SMTP_SERVER=smtp.example.com
SMTP_PORT=587
SMTP_EMAIL=your_email@example.com
SMTP_PASSWORD=secret
SMTP_SECURE=tls
</code></pre></div>
<p>Here, <code>SMTP_SECURE</code> is the SMTP encryption method, which can be set to none, ssl, or tls.</p>
<p>Then compile and run the test environment:</p>
<div class="highlight"><pre><span></span><code>docker compose build
docker compose up -d
</code></pre></div>
<p>After the server starts, visit <code>http://your-ip:8080/</code> to see a "Feedback" page.</p>
<h2 id="vulnerability-reproduction">Vulnerability Reproduction<a class="headerlink" href="#vulnerability-reproduction" title="Permanent link">&para;</a></h2>
<p>On the "Feedback" page, normal users fill in their nickname, email, and feedback for submission. This information will be stored by the backend, and the backend will send an email to notify users that their feedback has been submitted:</p>
<p><img alt="" src="1.png" /></p>
<blockquote>
<p>This scenario is common in real-world applications. For example, when users successfully register on a website, they usually receive a notification email containing their nickname. Therefore, if we insert malicious code <code>&lt;img src="/etc/passwd"&gt;</code> in the nickname field, files on the target server will be read as attachments.</p>
</blockquote>
<p>Similarly, we can place the malicious code in the "Feedback" field:</p>
<p><img alt="" src="2.png" /></p>
<p>When receiving the email, it contains attachments <code>/etc/passwd</code> and <code>/etc/hosts</code>:</p>
<p><img alt="" src="3.png" /></p>
<p>Download and read the files.</p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        PHPMailer 任意文件读取漏洞（CVE-2017-5223）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../%EF%BC%88CVE-2017-5223%EF%BC%89PHPMailer%20_%3D%205.2.21%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../%EF%BC%88CVE-2017-5223%EF%BC%89PHPMailer%20_%3D%205.2.21%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        （CVE-2017-5223）PHPMailer \&lt;= 5.2.21 任意文件读取漏洞
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>