<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Tomcat/CVE-2020-1938/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Aapache Tomcat AJP Arbitrary File Read / Include Vulnerability（CVE-2020-1938） - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Aapache Tomcat AJP Arbitrary File Read / Include Vulnerability\uff08CVE-2020-1938\uff09", url: "#_top", children: [
              {title: "Environment Setup", url: "#environment-setup" },
              {title: "Proof Of Concept", url: "#proof-of-concept" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        Aapache Tomcat AJP 文件包含漏洞（CVE-2020-1938）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../CVE-2017-12615/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../CVE-2017-12615/README.zh-cn/" class="btn btn-xs btn-link">
        Tomcat PUT方法任意写文件漏洞（CVE-2017-12615）
      </a>
    </div>
    
  </div>

    

    <h1 id="aapache-tomcat-ajp-arbitrary-file-read-include-vulnerabilitycve-2020-1938">Aapache Tomcat AJP Arbitrary File Read / Include Vulnerability（CVE-2020-1938）<a class="headerlink" href="#aapache-tomcat-ajp-arbitrary-file-read-include-vulnerabilitycve-2020-1938" title="Permanent link">&para;</a></h1>
<p><a href="README.zh-cn/">中文版本(Chinese version)</a></p>
<p>Java is currently the most popular programming language in Web development, and Tomcat is one of the most popular Java middleware servers. It has been used for more than 20 years since its initial release.</p>
<p><a href="https://www.chaitin.cn/en/ghostcat">Ghostcat</a> is a serious vulnerability in Tomcat discovered by security researcher of Chaitin Tech. Due to a flaw in the Tomcat AJP protocol, an attacker can read or include any files in the webapp directories of Tomcat. For example, An attacker can read the webapp configuration files or source code. In addition, if the target web application has a file upload function, the attacker may execute malicious code on the target host by exploiting file inclusion through Ghostcat vulnerability.</p>
<p>References:</p>
<ul>
<li><a href="https://www.chaitin.cn/en/ghostcat">https://www.chaitin.cn/en/ghostcat</a></li>
<li><a href="https://www.cnvd.org.cn/webinfo/show/5415">https://www.cnvd.org.cn/webinfo/show/5415</a></li>
<li><a href="https://mp.weixin.qq.com/s/D1hiKJpah3NhEBLwtTodsg">https://mp.weixin.qq.com/s/D1hiKJpah3NhEBLwtTodsg</a></li>
<li><a href="https://mp.weixin.qq.com/s/GzqLkwlIQi_i3AVIXn59FQ">https://mp.weixin.qq.com/s/GzqLkwlIQi_i3AVIXn59FQ</a></li>
</ul>
<h2 id="environment-setup">Environment Setup<a class="headerlink" href="#environment-setup" title="Permanent link">&para;</a></h2>
<p>Start a local Apache Tomcat 9.0.30:</p>
<div class="highlight"><pre><span></span><code>docker compose up -d
</code></pre></div>
<p>After successfully running the commands above, you will see the example page of Tomcat through visiting the site <code>http://your-ip:8080</code>, there is also a AJP port 8009 is listening.</p>
<h2 id="proof-of-concept">Proof Of Concept<a class="headerlink" href="#proof-of-concept" title="Permanent link">&para;</a></h2>
<p>Test it online at <a href="https://www.chaitin.cn/en/ghostcat">https://www.chaitin.cn/en/ghostcat</a>:</p>
<p><img alt="" src="2.png" /></p>
<p>Here are some tools to test this vulnerability:</p>
<ul>
<li><a href="https://github.com/chaitin/xray">https://github.com/chaitin/xray</a></li>
<li><a href="https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi">https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi</a></li>
</ul>
<p><img alt="" src="1.png" /></p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        Aapache Tomcat AJP 文件包含漏洞（CVE-2020-1938）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../CVE-2017-12615/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../CVE-2017-12615/README.zh-cn/" class="btn btn-xs btn-link">
        Tomcat PUT方法任意写文件漏洞（CVE-2017-12615）
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>