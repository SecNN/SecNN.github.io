<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Drupal/CVE-2019-6341/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Drupal Cross-Site Scripting by File Upload (CVE-2019-6341) - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Drupal Cross-Site Scripting by File Upload (CVE-2019-6341)", url: "#_top", children: [
              {title: "Environment Setup", url: "#environment-setup" },
              {title: "Vulnerability Reproduction", url: "#vulnerability-reproduction" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        Drupal文件上传导致跨站脚本执行（CVE-2019-6341）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../CVE-2019-6339/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../CVE-2019-6339/README.zh-cn/" class="btn btn-xs btn-link">
        Drupal远程代码执行漏洞（CVE-2019-6339）
      </a>
    </div>
    
  </div>

    

    <h1 id="drupal-cross-site-scripting-by-file-upload-cve-2019-6341">Drupal Cross-Site Scripting by File Upload (CVE-2019-6341)<a class="headerlink" href="#drupal-cross-site-scripting-by-file-upload-cve-2019-6341" title="Permanent link">&para;</a></h1>
<p><a href="README.zh-cn/">中文版本(Chinese version)</a></p>
<p>Drupal is a free and open-source web content management framework written in PHP.</p>
<p>A cross-site scripting (XSS) vulnerability exists in Drupal 7.x before 7.65, Drupal 8.x before 8.5.14 and 8.6.x before 8.6.13. The vulnerability is caused by improper handling of file uploads in the file module or subsystem, which can lead to stored XSS attacks.</p>
<p>References:</p>
<ul>
<li><a href="https://www.drupal.org/sa-core-2019-004">https://www.drupal.org/sa-core-2019-004</a></li>
<li><a href="https://www.zerodayinitiative.com/blog/2019/4/11/a-series-of-unfortunate-images-drupal-1-click-to-rce-exploit-chain-detailed">https://www.zerodayinitiative.com/blog/2019/4/11/a-series-of-unfortunate-images-drupal-1-click-to-rce-exploit-chain-detailed</a></li>
<li><a href="https://paper.seebug.org/897/">https://paper.seebug.org/897/</a></li>
</ul>
<h2 id="environment-setup">Environment Setup<a class="headerlink" href="#environment-setup" title="Permanent link">&para;</a></h2>
<p>Execute the following command to start a vulnerable Drupal 8.5.0 server:</p>
<div class="highlight"><pre><span></span><code>docker compose up -d
</code></pre></div>
<p>After the server is started, visit <code>http://your-ip:8080/</code> to access the Drupal installation page. Follow the default configuration steps to complete the installation. Since there is no MySQL environment, you can choose SQLite as the database.</p>
<h2 id="vulnerability-reproduction">Vulnerability Reproduction<a class="headerlink" href="#vulnerability-reproduction" title="Permanent link">&para;</a></h2>
<p>This vulnerability exploits a flaw in Drupal's file module that allows uploading a specially crafted file without extension. The file appears to be an image but actually contains HTML code with embedded JavaScript. When other users visit the link to this file, the XSS payload will be executed.</p>
<p>By default, Drupal stores uploaded images in the <code>/sites/default/files/pictures/&lt;YYYY-MM&gt;/</code> directory.</p>
<p>To exploit the vulnerability, use the PoC script from <a href="https://github.com/thezdi/PoC/tree/master/Drupal">thezdi/PoC</a> to create and upload a malicious GIF file. Execute the following command, where the first argument is the target IP and the second is the target port:</p>
<div class="highlight"><pre><span></span><code>php cve-2019-6341-exp.php 192.168.11.1 8080
</code></pre></div>
<p><img alt="1" src="1.png" /></p>
<p>After successful upload, visiting the image location will trigger the XSS vulnerability:</p>
<p><img alt="2" src="2.png" /></p>
<p>Note:</p>
<ol>
<li>Chrome and Firefox browsers have built-in XSS filters, so it's recommended to use Edge or IE browsers for testing.</li>
<li>The uploaded image name ends with "_0" due to Drupal's rule mechanism. For more details, see <a href="https://paper.seebug.org/897/">Drupal 1-click to RCE Analysis</a></li>
<li>The chain of this bug and <a href="../CVE-2019-6339/">CVE-2019-6339</a>, which can lead to remote code execution by 1 click</li>
</ol>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        Drupal文件上传导致跨站脚本执行（CVE-2019-6341）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../CVE-2019-6339/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../CVE-2019-6339/README.zh-cn/" class="btn btn-xs btn-link">
        Drupal远程代码执行漏洞（CVE-2019-6339）
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>