<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2018-2894/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Weblogic Arbitrary File Upload Vulnerability (CVE-2018-2894) - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Weblogic Arbitrary File Upload Vulnerability (CVE-2018-2894)", url: "#_top", children: [
              {title: "Environment Setup", url: "#environment-setup" },
              {title: "Vulnerability Reproduce", url: "#vulnerability-reproduce" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        Weblogic 任意文件上传漏洞（CVE-2018-2894）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../CVE-2018-2628/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../CVE-2018-2628/README.zh-cn/" class="btn btn-xs btn-link">
        Weblogic WLS Core Components 反序列化命令执行漏洞（CVE-2018-2628）
      </a>
    </div>
    
  </div>

    

    <h1 id="weblogic-arbitrary-file-upload-vulnerability-cve-2018-2894">Weblogic Arbitrary File Upload Vulnerability (CVE-2018-2894)<a class="headerlink" href="#weblogic-arbitrary-file-upload-vulnerability-cve-2018-2894" title="Permanent link">&para;</a></h1>
<p><a href="README.zh-cn/">中文版本(Chinese version)</a></p>
<p>Oracle Weblogic Server is a popular enterprise application server that provides a wide range of features for building and deploying enterprise applications.</p>
<p>In Oracle's July 2018 update, a vulnerability in the Weblogic Web Service Test Page was fixed that allowed arbitrary file upload. The Web Service Test Page is disabled by default in "Production Mode", so this vulnerability has certain limitations.</p>
<p>By exploiting this vulnerability, attackers can upload arbitrary JSP files and gain server access.</p>
<p>Reference links:</p>
<ul>
<li><a href="http://www.oracle.com/technetwork/security-advisory/cpujul2018-4258247.html">http://www.oracle.com/technetwork/security-advisory/cpujul2018-4258247.html</a></li>
<li><a href="https://mp.weixin.qq.com/s/y5JGmM-aNaHcs_6P9a-gRQ">https://mp.weixin.qq.com/s/y5JGmM-aNaHcs_6P9a-gRQ</a></li>
<li><a href="https://xz.aliyun.com/t/2458">https://xz.aliyun.com/t/2458</a></li>
</ul>
<h2 id="environment-setup">Environment Setup<a class="headerlink" href="#environment-setup" title="Permanent link">&para;</a></h2>
<p>Execute the following command to start Weblogic 12.2.1.3:</p>
<div class="highlight"><pre><span></span><code>docker compose up -d
</code></pre></div>
<p>After the environment starts, visit <code>http://your-ip:7001/console</code> to see the backend login page.</p>
<p>Execute <code>docker compose logs | grep password</code> to view the administrator password. The administrator username is <code>weblogic</code>.</p>
<p>After logging into the backend, click on the <code>base_domain</code> configuration, and in "Advanced" enable the "Enable Web Service Test Page" option:</p>
<p><img alt="" src="img/1.png" /></p>
<h2 id="vulnerability-reproduce">Vulnerability Reproduce<a class="headerlink" href="#vulnerability-reproduce" title="Permanent link">&para;</a></h2>
<p>As a attacker, visit <code>http://your-ip:7001/ws_utc/config.do</code> and set the Work Home Dir to <code>/u01/oracle/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_internal/com.oracle.webservices.wls.ws-testclient-app-wls/4mcj4y/war/css</code>. We set the directory to the static file CSS directory of the <code>ws_utc</code> application because this directory can be accessed without permissions, which is crucial.</p>
<p><img alt="" src="img/2.png" /></p>
<p>Then click on Security -&gt; Add, and upload a webshell:</p>
<p><img alt="" src="img/3.png" /></p>
<p>After uploading, check the returned data packet which contains a timestamp:</p>
<p><img alt="" src="img/4.png" /></p>
<p>Then visit <code>http://your-ip:7001/ws_utc/css/config/keystore/[timestamp]_[filename]</code> to execute the webshell:</p>
<p><img alt="" src="img/5.png" /></p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        Weblogic 任意文件上传漏洞（CVE-2018-2894）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../CVE-2018-2628/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../CVE-2018-2628/README.zh-cn/" class="btn btn-xs btn-link">
        Weblogic WLS Core Components 反序列化命令执行漏洞（CVE-2018-2628）
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>